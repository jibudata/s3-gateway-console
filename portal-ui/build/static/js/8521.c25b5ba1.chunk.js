(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[8521],{98521:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return $}});var o=t(29439),i=t(1413),r=t(72791),l=t(95087),s=t(29945),a=t(11135),c=t(25787),d=t(78687),u=t(76098),h=t(61889),g=t(68096),x=t(58406),f=t(77865),p=t(81207),j=t(81551),m=t(26824),y=t(23814),v=t(59114),b=t(35527),Z=t(79836),w=t(53382),C=t(87462),S=t(63366),T=t(28182),k=t(94419),A=t(31402),F=t(66934),L=t(75878),O=t(21217);function N(e){return(0,O.Z)("MuiTableContainer",e)}(0,L.Z)("MuiTableContainer",["root"]);var M=t(80184),R=["className","component"],_=(0,F.ZP)("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:function(e,n){return n.root}})({width:"100%",overflowX:"auto"}),z=r.forwardRef((function(e,n){var t=(0,A.Z)({props:e,name:"MuiTableContainer"}),o=t.className,i=t.component,r=void 0===i?"div":i,l=(0,S.Z)(t,R),s=(0,C.Z)({},t,{component:r}),a=function(e){var n=e.classes;return(0,k.Z)({root:["root"]},N,n)}(s);return(0,M.jsx)(_,(0,C.Z)({ref:n,as:r,className:(0,T.Z)(a.root,o),ownerState:s},l))})),I=t(99779),E=t(35855),P=t(53994),H=t(56125),U=t(64554),B=t(20890),D=t(26181),W=t.n(D),X="HH:mm:ss ZZZZ MM/dd/yyyy",q=function(e){var n=e.log,t=(0,r.useState)(!1),i=(0,o.Z)(t,2),l=i[0],a=i[1],c=function(e){return W()(n,e,"")},d="",u=c("ConsoleMsg"),h=c("error.message");""!==u?d=u:""!==h&&(d=h);var g=(d||"").replace(/\u2501|\u250f|\u2513|\u2503|\u2517|\u251b/g,"");g=g.replace(/([^\x20-\x7F])/g,"");var x=(0,M.jsx)(r.Fragment,{});""!==u?x=function(e){var n=e.ConsoleMsg;return n=(n=n.replace(/\x1B/g," ")).replace(/((\[[0-9;]+m))/g,""),(0,M.jsx)("div",{style:{display:"table",tableLayout:"fixed",width:"100%",paddingLeft:10,paddingRight:10},children:(0,M.jsx)("div",{style:{display:"table-cell",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"auto"},children:(0,M.jsx)("pre",{children:n})})})}(n):""!==h&&(x=function(e){var n={color:"#C83B51",fontWeight:400,fontFamily:"monospace",fontSize:"12px"},t={fontFamily:"monospace",fontSize:"12px"},o=function(n){return W()(e,n,"")},i=I.ou.fromFormat(e.time.toString(),"HH:mm:ss z MM/dd/yyyy",{zone:"UTC"});return(0,M.jsxs)(r.Fragment,{children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{style:t,children:"API:\xa0"}),(0,M.jsx)("span",{style:n,children:o("api.name")})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{style:t,children:"Time:\xa0"}),(0,M.jsx)("span",{style:n,children:i.toFormat(X)})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{style:t,children:"DeploymentID:\xa0"}),(0,M.jsx)("span",{style:n,children:o("deploymentid")})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{style:t,children:"RequestID:\xa0"}),(0,M.jsx)("span",{style:n,children:o("requestID")})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{style:t,children:"RemoteHost:\xa0"}),(0,M.jsx)("span",{style:n,children:o("remotehost")})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{style:t,children:"UserAgent:\xa0"}),(0,M.jsx)("span",{style:n,children:o("userAgent")})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)("b",{style:t,children:"Error:\xa0"}),(0,M.jsx)("span",{style:n,children:o("error.message")})]}),(0,M.jsx)("br",{}),(0,M.jsx)("div",{children:(0,M.jsx)("b",{style:t,children:"Backtrace:\xa0"})}),(e.error.source||[]).map((function(e,o){return(0,M.jsxs)("div",{children:[(0,M.jsxs)("b",{style:t,children:[o,":\xa0"]}),(0,M.jsx)("span",{style:n,children:e})]})}))]})}(n)),g=(g||"").replace(/((\[[0-9;]+m))/g,"");var f=I.ou.fromFormat(n.time.toString(),"HH:mm:ss z MM/dd/yyyy",{zone:"UTC"}),p=f.toJSDate(),j=(0,M.jsx)(r.Fragment,{children:f.toFormat(X)});return 1===p.getFullYear()&&(j=(0,M.jsx)(r.Fragment,{children:"n/a"})),(0,M.jsxs)(r.Fragment,{children:[(0,M.jsxs)(E.Z,{sx:{"& > *":{borderBottom:"unset"},cursor:"pointer",borderLeft:"0",borderRight:"0"},style:{backgroundColor:"#FDFDFD"},children:[(0,M.jsx)(P.Z,{onClick:function(){return a(!l)},style:{width:280,color:"#989898",fontSize:12},children:(0,M.jsxs)(U.Z,{sx:{display:"flex",gap:1,alignItems:"center","& .min-icon":{width:12,marginRight:1},fontWeight:"bold",lineHeight:1},children:[(0,M.jsx)(s.AeX,{}),(0,M.jsx)("div",{children:j})]})}),(0,M.jsx)(P.Z,{onClick:function(){return a(!l)},style:{width:200,color:"#989898",fontSize:12},children:(0,M.jsx)(U.Z,{sx:{"& .min-icon":{width:12,marginRight:1},fontWeight:"bold",lineHeight:1},children:n.errKind})}),(0,M.jsx)(P.Z,{onClick:function(){return a(!l)},children:(0,M.jsx)("div",{style:{display:"table",tableLayout:"fixed",width:"100%",paddingLeft:10,paddingRight:10},children:(0,M.jsx)("div",{style:{display:"table-cell",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:g})})}),(0,M.jsx)(P.Z,{onClick:function(){return a(!l)},style:{width:40},children:(0,M.jsx)(U.Z,{sx:{"& .min-icon":{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"2px"},"&:hover .min-icon":{fill:"#eaeaea"}},children:l?(0,M.jsx)(s.Ekf,{}):(0,M.jsx)(s._f_,{})})})]}),l?(0,M.jsxs)(E.Z,{children:[(0,M.jsx)(P.Z,{style:{paddingBottom:0,paddingTop:0,width:200,textTransform:"uppercase",verticalAlign:"top",textAlign:"right",color:"#8399AB",fontWeight:"bold"},children:(0,M.jsx)(H.Z,{in:l,timeout:"auto",unmountOnExit:!0,children:(0,M.jsx)("div",{style:{marginTop:10},children:"Log Details"})})}),(0,M.jsx)(P.Z,{colSpan:2,style:{paddingBottom:0,paddingTop:0},children:(0,M.jsx)(H.Z,{in:l,timeout:"auto",unmountOnExit:!0,children:(0,M.jsx)(U.Z,{sx:{margin:1},children:(0,M.jsx)(B.Z,{style:{background:"#efefef",border:"1px solid #dedede",padding:4,fontSize:14,color:"#666666"},children:x})})})}),(0,M.jsx)(P.Z,{style:{paddingBottom:0,paddingTop:0,width:40}})]}):null]},f.toString())},G=t(69129),J=t(72455),K=t(47974),Q=(0,J.Z)((function(e){return(0,a.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({logList:{background:"#fff",minHeight:400,height:"calc(100vh - 200px)",overflow:"auto",fontSize:13,borderRadius:4},logerror_tab:{color:"#A52A2A",paddingLeft:25},nodeField:{width:"100%"}},y.OR),{},{actionsTray:(0,i.Z)((0,i.Z)({},y.OR.actionsTray),{},{marginBottom:0})},y.qg),y.IX),y.Bz))})),V=(0,c.Z)((function(e){return(0,a.Z)({root:{lineHeight:"50px","label + &":{marginTop:e.spacing(3)},"& .MuiSelect-select:focus":{backgroundColor:"transparent"}}})}))(u.ZP),Y=null,$=function(){var e=(0,j.TL)(),n=Q(),t=(0,d.v9)((function(e){return e.logs.logMessages})),i=(0,d.v9)((function(e){return e.logs.logsStarted})),a=(0,r.useState)(""),c=(0,o.Z)(a,2),u=c[0],y=c[1],C=(0,r.useState)([""]),S=(0,o.Z)(C,2),T=S[0],k=S[1],A=(0,r.useState)("all"),F=(0,o.Z)(A,2),L=F[0],O=F[1],N=(0,r.useState)("Select user agent"),R=(0,o.Z)(N,2),_=R[0],I=R[1],E=(0,r.useState)(["All User Agents"]),P=(0,o.Z)(E,2),H=P[0],U=P[1],B=(0,r.useState)("all"),D=(0,o.Z)(B,2),W=D[0],X=D[1],J=(0,r.useState)(!1),$=(0,o.Z)(J,2),ee=$[0],ne=$[1],te=u.toLowerCase(),oe=t.filter((function(e){return(e.userAgent===_||"All User Agents"===_||"Select user agent"===_)&&(""===u||(e.ConsoleMsg.toLowerCase().indexOf(te)>=0||(!!(e.error&&e.error.source&&e.error.source.filter((function(e){return e.toLowerCase().indexOf(te)>=0})).length>0)||(!!(e.error&&e.error.message.toLowerCase().indexOf(te)>=0)||!!(e.api&&e.api.name.toLowerCase().indexOf(te)>=0)))))}));return(0,r.useEffect)((function(){ne(!0),p.Z.invoke("GET","/api/v1/nodes").then((function(e){k(e),ne(!1)})).catch((function(e){ne(!1)}))}),[]),(0,M.jsxs)(r.Fragment,{children:[(0,M.jsx)(K.Z,{label:"Logs"}),(0,M.jsx)(s.Xgh,{children:(0,M.jsxs)(h.ZP,{container:!0,spacing:1,children:[(0,M.jsx)(h.ZP,{item:!0,xs:4,children:ee?(0,M.jsx)("h3",{children:" Loading nodes"}):(0,M.jsx)(g.Z,{variant:"outlined",className:n.nodeField,children:(0,M.jsxs)(x.Z,{id:"node",name:"node","data-test-id":"node-selector",value:L,onChange:function(e){O(e.target.value)},className:n.searchField,disabled:ee||i,input:(0,M.jsx)(V,{}),placeholder:"Select Node",children:[(0,M.jsx)(f.Z,{value:"all",children:"All Nodes"},"select-node-all"),T.map((function(e){return(0,M.jsx)(f.Z,{value:e,children:e},"select-node-name-".concat(e))}))]})})}),(0,M.jsx)(h.ZP,{item:!0,xs:3,children:(0,M.jsx)(g.Z,{variant:"outlined",className:n.nodeField,children:(0,M.jsxs)(x.Z,{id:"logType",name:"logType","data-test-id":"log-type",value:W,onChange:function(e){X(e.target.value)},className:n.searchField,disabled:ee||i,input:(0,M.jsx)(V,{}),placeholder:"Select Log Type",children:[(0,M.jsx)(f.Z,{value:"all",children:"All Log Types"},"all-log-types"),(0,M.jsx)(f.Z,{value:"minio",children:"MinIO"},"minio-log-type"),(0,M.jsx)(f.Z,{value:"application",children:"Application"},"app-log-type")]})})}),(0,M.jsx)(h.ZP,{item:!0,xs:3,children:H.length>1&&(0,M.jsx)(g.Z,{variant:"outlined",className:n.nodeField,children:(0,M.jsxs)(x.Z,{id:"userAgent",name:"userAgent","data-test-id":"user-agent",value:_,onChange:function(e){I(e.target.value)},className:n.searchField,disabled:H.length<1||i,input:(0,M.jsx)(V,{}),children:[(0,M.jsx)(f.Z,{value:_,disabled:!0,children:"Select User Agent"},"select-user-agent-default"),H.map((function(e){return(0,M.jsx)(f.Z,{value:e,children:e},"select-user-agent-".concat(e))}))]})})}),(0,M.jsxs)(h.ZP,{item:!0,xs:2,sx:{display:"flex",justifyContent:"flex-end"},children:[!i&&(0,M.jsx)(s.zxk,{id:"start-logs",type:"submit",variant:"callAction",disabled:!1,onClick:function(){e((0,G.i1)());var n=new URL(window.location.toString()),t=n.port,o=(0,m.x2)(n.protocol),i=new URL(document.baseURI).pathname;Y=new l.w3cwebsocket("".concat(o,"://").concat(n.hostname,":").concat(t).concat(i,"ws/console/?logType=").concat(W,"&node=").concat("Select node"===L?"":L));var r=null;if(null!==Y)return Y.onopen=function(){console.log("WebSocket Client Connected"),e((0,G.v0)(!0)),Y.send("ok"),r=setInterval((function(){Y.send("ok")}),1e4)},Y.onmessage=function(n){var t=JSON.parse(n.data.toString()),o=!0;""===t.level&&""===t.errKind&&"00:00:00 UTC 01/01/0001"===t.time&&""===t.ConsoleMsg&&""===t.node&&(o=!1),t.key=Math.random(),H.indexOf(t.userAgent)<0&&void 0!==t.userAgent&&(H.push(t.userAgent),U(H)),o&&e((0,G.Qo)(t))},Y.onclose=function(){clearInterval(r),console.log("connection closed by server"),e((0,G.v0)(!1))},function(){Y.close(1e3),clearInterval(r),console.log("closing websockets"),e((0,G.v0)(!1))}},label:"Start Logs"}),i&&(0,M.jsx)(s.zxk,{id:"stop-logs",type:"button",variant:"callAction",onClick:function(){null!==Y&&void 0!==Y&&(Y.close(1e3),e((0,G.v0)(!1)))},label:"Stop Logs"})]}),(0,M.jsx)(h.ZP,{item:!0,xs:12,className:n.actionsTray,children:(0,M.jsx)(v.Z,{placeholder:"Filter",onChange:function(e){y(e)},value:u})}),(0,M.jsx)(h.ZP,{item:!0,xs:12,children:(0,M.jsx)("div",{id:"logs-container",className:n.logList,"data-test-id":"logs-list-container",children:(0,M.jsxs)(z,{component:b.Z,children:[(0,M.jsx)(Z.Z,{"aria-label":"collapsible table",children:(0,M.jsx)(w.Z,{children:oe.map((function(e){return(0,M.jsx)(q,{log:e})}))})}),0===oe.length&&(0,M.jsx)("div",{style:{padding:20,textAlign:"center"},children:"No logs to display"})]})})})]})})]})}},26824:function(e,n,t){"use strict";t.d(n,{HE:function(){return r},V9:function(){return o},ci:function(){return i},x2:function(){return l}});var o=1006,i=1008,r=1011,l=function(e){var n="ws";return"https:"===e&&(n="wss"),n}},94210:function(e){var n=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}()},95087:function(e,n,t){var o;if("object"===typeof globalThis)o=globalThis;else try{o=t(94210)}catch(s){}finally{if(o||"undefined"===typeof window||(o=window),!o)throw new Error("Could not determine global this")}var i=o.WebSocket||o.MozWebSocket,r=t(51496);function l(e,n){return n?new i(e,n):new i(e)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(l,e,{get:function(){return i[e]}})})),e.exports={w3cwebsocket:i?l:null,version:r}},51496:function(e,n,t){e.exports=t(19794).version},19794:function(e){"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=8521.c25b5ba1.chunk.js.map
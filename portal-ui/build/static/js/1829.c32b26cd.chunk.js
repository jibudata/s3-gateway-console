(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[1829],{47986:function(e,t,n){"use strict";var a=n(4942),o=(n(72791),n(29945)),r=n(80184);t.Z=function(e){var t=e.iconComponent,n=e.entity;return(0,r.jsx)(o.rjZ,{container:!0,children:(0,r.jsx)(o.rjZ,{item:!0,xs:12,children:(0,r.jsx)(o.KfX,{title:"".concat(n," not available"),iconComponent:t,help:(0,r.jsxs)(o.xuv,{sx:(0,a.Z)({fontSize:"14px"},"@media (max-width: ".concat(o.Egj.sm,"px)"),{display:"flex",flexFlow:"column"}),children:[(0,r.jsx)("span",{children:"This feature is not available for a single-disk setup.\xa0"}),(0,r.jsxs)("span",{children:["Please deploy a server in"," ",(0,r.jsx)("a",{href:"https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-multi-node-multi-drive.html?ref=con",target:"_blank",rel:"noopener",children:"Distributed Mode"})," ","to use this feature."]})]})})})})}},61829:function(e,t,n){"use strict";n.r(t);var a=n(29439),o=n(72791),r=n(78687),s=n(95087),i=n(29945),c=n(20601),l=n(38725),u=n(82839),f=n(90466),d=n(12891),h=n(35667),x=n(83672),b=n(57702),p=n(31776),j=n(82342),m=n(26824),v=n(45248),g=n(23814),w=n(56087),y=n(87995),S=n(38442),k=n(81551),C=n(47986),Z=n(47974),H=n(99670),B=n(80184);t.default=function(){var e=(0,r.v9)(y.N5),t=(0,o.useState)(!1),n=(0,a.Z)(t,2),D=n[0],E=n[1],T=(0,o.useState)(""),_=(0,a.Z)(T,2),A=_[0],G=_[1],N=(0,o.useState)([]),O=(0,a.Z)(N,2),z=O[0],R=O[1],I=(0,o.useState)(""),L=(0,a.Z)(I,2),F=L[0],K=L[1],P=(0,o.useState)(!1),M=(0,a.Z)(P,2),X=M[0],J=M[1],U=(0,o.useState)(!1),W=(0,a.Z)(U,2),Y=W[0],$=W[1],q=(0,o.useState)(!1),V=(0,a.Z)(q,2),Q=V[0],ee=V[1],te=(0,o.useState)({beforeHeal:[0,0,0,0],afterHeal:[0,0,0,0],objectsHealed:0,objectsScanned:0,healDuration:0,sizeScanned:""}),ne=(0,a.Z)(te,2),ae=ne[0],oe=ne[1];(0,o.useEffect)((function(){p.h.buckets.listBuckets().then((function(e){var t=[];e.data.buckets&&(t=e.data.buckets),R(t)})).catch((function(e){console.error((0,j.g)(e.error))}))}),[]),(0,o.useEffect)((function(){Y&&ee(!1)}),[Y]),(0,o.useEffect)((function(){Q&&$(!1)}),[Q]);var re=function(e){return[e.Green,e.Yellow,e.Red,e.Grey]};(0,o.useEffect)((function(){if(D){var e={Green:0,Yellow:0,Red:0,Grey:0},t={Green:0,Yellow:0,Red:0,Grey:0},n=new URL(window.location.toString()),o=n.port,r=new URL(document.baseURI).pathname,i=(0,m.x2)(n.protocol),c=new s.w3cwebsocket("".concat(i,"://").concat(n.hostname,":").concat(o).concat(r,"ws/heal/").concat(A,"?prefix=").concat(F,"&recursive=").concat(X,"&force-start=").concat(Y,"&force-stop=").concat(Q));if(null!==c)return c.onopen=function(){console.log("WebSocket Client Connected"),c.send("ok")},c.onmessage=function(n){for(var o=JSON.parse(n.data.toString()),r=0,s=Object.entries(o.healthAfterCols);r<s.length;r++){var i=(0,a.Z)(s[r],2),c=i[0],l=i[1];t[c]=100*l/o.itemsScanned}for(var u=0,f=Object.entries(o.healthBeforeCols);u<f.length;u++){var d=(0,a.Z)(f[u],2),h=d[0],x=d[1];e[h]=100*x/o.itemsScanned}oe({beforeHeal:re(e),afterHeal:re(t),objectsHealed:o.objectsHealed,objectsScanned:o.objectsScanned,healDuration:o.healDuration,sizeScanned:(0,v.ae)(o.bytesScanned.toString())})},c.onclose=function(){E(!1),console.log("connection closed by server")},function(){c.close(1e3),console.log("closing websockets")}}}),[D,A,Y,Q,F,X]);var se=[{name:"Green",ah:ae.afterHeal[0],bh:ae.beforeHeal[0],amt:100},{name:"Yellow",ah:ae.afterHeal[1],bh:ae.beforeHeal[1],amt:100},{name:"Red",ah:ae.afterHeal[2],bh:ae.beforeHeal[2],amt:100},{name:"Grey",ah:ae.afterHeal[3],bh:ae.beforeHeal[3],amt:100}],ie=z.map((function(e){return{label:e.name,value:e.name}})),ce=(0,k.TL)();return(0,o.useEffect)((function(){ce((0,y.Sc)("heal"))}),[]),(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)(Z.Z,{label:"Drives",actions:(0,B.jsx)(H.Z,{})}),(0,B.jsx)(i.Xgh,{children:e?(0,B.jsxs)(S.s,{scopes:[w.Ft.ADMIN_HEAL],resource:w.C3,children:[(0,B.jsxs)(i.xuv,{withBorders:!0,children:[(0,B.jsxs)(i.xuv,{sx:{display:"flex",alignItems:"center",marginBottom:15,gap:15},children:[(0,B.jsxs)(i.xuv,{sx:{flexGrow:1,width:"100%"},children:[(0,B.jsx)(i.AZs,{children:"Bucket"}),(0,B.jsx)(i.PhF,{id:"bucket-name",name:"bucket-name",value:A,onChange:function(e){G(e)},options:ie,placeholder:"Select Bucket"})]}),(0,B.jsxs)(i.xuv,{sx:{flexGrow:1,width:"100%"},children:[(0,B.jsx)(i.AZs,{children:"Prefix"}),(0,B.jsx)(i.Wzg,{id:"prefix-resource",disabled:!1,onChange:function(e){K(e.target.value)}})]})]}),(0,B.jsxs)(i.xuv,{sx:{display:"flex",gap:20},children:[(0,B.jsx)(i.xuv,{children:(0,B.jsx)(i.XZJ,{name:"recursive",id:"recursive",value:"recursive",checked:X,onChange:function(){J(!X)},disabled:!1,label:"Recursive"})}),(0,B.jsx)(i.xuv,{children:(0,B.jsx)(i.XZJ,{name:"forceStart",id:"forceStart",value:"forceStart",checked:Y,onChange:function(){$(!Y)},disabled:!1,label:"Force Start"})}),(0,B.jsx)(i.xuv,{children:(0,B.jsx)(i.XZJ,{name:"forceStop",id:"forceStop",value:"forceStop",checked:Q,onChange:function(){ee(!Q)},disabled:!1,label:"Force Stop"})})]}),(0,B.jsx)(i.xuv,{sx:g.ID.modalButtonBar,children:(0,B.jsx)(i.zxk,{id:"start-heal",type:"submit",variant:"callAction",color:"primary",disabled:D,onClick:function(){return E(!0)},label:"Start"})})]}),(0,B.jsxs)(i.xuv,{withBorders:!0,sx:{marginTop:15,'& ul li:not([class*="Mui"])::before':{listStyle:"none",content:"' '"}},children:[(0,B.jsx)(c.h,{width:"90%",height:400,children:(0,B.jsxs)(l.v,{width:600,height:400,data:se,margin:{top:5,right:30,left:20,bottom:5},children:[(0,B.jsx)(u.q,{strokeDasharray:"3 3"}),(0,B.jsx)(f.K,{dataKey:"name"}),(0,B.jsx)(d.B,{}),(0,B.jsx)(h.u,{}),(0,B.jsx)(x.D,{verticalAlign:"top",layout:"horizontal",className:"noLi"}),(0,B.jsx)(b.$,{dataKey:"ah",name:"After Healing",fill:"#2781B060",stroke:"#2781B0"}),(0,B.jsx)(b.$,{dataKey:"bh",name:"Before Healing",fill:"#C83B5160",stroke:"#C83B51"})]})}),(0,B.jsxs)(i.rjZ,{item:!0,xs:12,sx:{marginTop:20,display:"flex",flexDirection:"row",justifyContent:"space-between","& .scanData":{}},children:[(0,B.jsxs)(i.xuv,{className:"scanData",children:[(0,B.jsx)("strong",{children:"Size scanned:"})," ",ae.sizeScanned]}),(0,B.jsxs)(i.xuv,{className:"scanData",children:[(0,B.jsx)("strong",{children:"Objects healed:"})," ",ae.objectsHealed," /"," ",ae.objectsScanned]}),(0,B.jsxs)(i.xuv,{className:"scanData",children:[(0,B.jsx)("strong",{children:"Healing time:"})," ",ae.healDuration,"s"]})]})]})]}):(0,B.jsx)(C.Z,{entity:"Heal",iconComponent:(0,B.jsx)(i.lnI,{})})})]})}},26824:function(e,t,n){"use strict";n.d(t,{HE:function(){return r},V9:function(){return a},ci:function(){return o},x2:function(){return s}});var a=1006,o=1008,r=1011,s=function(e){var t="ws";return"https:"===e&&(t="wss"),t}},94210:function(e){var t=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},38725:function(e,t,n){"use strict";n.d(t,{v:function(){return c}});var a=n(625),o=n(57702),r=n(90466),s=n(12891),i=n(93137),c=(0,a.z)({chartName:"BarChart",GraphicalChild:o.$,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:r.K},{axisType:"yAxis",AxisComp:s.B}],formatAxisMap:i.t9})},95087:function(e,t,n){var a;if("object"===typeof globalThis)a=globalThis;else try{a=n(94210)}catch(i){}finally{if(a||"undefined"===typeof window||(a=window),!a)throw new Error("Could not determine global this")}var o=a.WebSocket||a.MozWebSocket,r=n(51496);function s(e,t){return t?new o(e,t):new o(e)}o&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(s,e,{get:function(){return o[e]}})})),e.exports={w3cwebsocket:o?s:null,version:r}},51496:function(e,t,n){e.exports=n(19794).version},19794:function(e){"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=1829.c32b26cd.chunk.js.map
(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[1829],{47986:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});a(72791);var n=a(29945),s=a(80184);const o=e=>{let{iconComponent:t,entity:a}=e;return(0,s.jsx)(n.rjZ,{container:!0,children:(0,s.jsx)(n.rjZ,{item:!0,xs:12,children:(0,s.jsx)(n.KfX,{title:"".concat(a," not available"),iconComponent:t,help:(0,s.jsxs)(n.xuv,{sx:{fontSize:"14px",["@media (max-width: ".concat(n.Egj.sm,"px)")]:{display:"flex",flexFlow:"column"}},children:[(0,s.jsx)("span",{children:"This feature is not available for a single-disk setup.\xa0"}),(0,s.jsxs)("span",{children:["Please deploy a server in"," ",(0,s.jsx)("a",{href:"https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-multi-node-multi-drive.html?ref=con",target:"_blank",rel:"noopener",children:"Distributed Mode"})," ","to use this feature."]})]})})})})}},61829:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D});var n=a(72791),s=a(78687),o=a(95087),r=a(29945),l=a(20601),i=a(38725),c=a(82839),d=a(90466),h=a(12891),x=a(35667),u=a(27281),f=a(23782),b=a(31776),p=a(82342),j=a(26824),m=a(45248),g=a(23814),v=a(56087),w=a(87995),y=a(38442),S=a(44690),k=a(47986),C=a(79844),H=a(99670),B=a(80184);const D=()=>{const e=(0,s.v9)(w.N5),[t,a]=(0,n.useState)(!1),[D,T]=(0,n.useState)(""),[_,E]=(0,n.useState)([]),[A,G]=(0,n.useState)(""),[N,O]=(0,n.useState)(!1),[Z,z]=(0,n.useState)(!1),[R,I]=(0,n.useState)(!1),[L,F]=(0,n.useState)({beforeHeal:[0,0,0,0],afterHeal:[0,0,0,0],objectsHealed:0,objectsScanned:0,healDuration:0,sizeScanned:""});(0,n.useEffect)((()=>{b.h.buckets.listBuckets().then((e=>{let t=[];e.data.buckets&&(t=e.data.buckets),E(t)})).catch((e=>{console.error((0,p.g)(e.error))}))}),[]),(0,n.useEffect)((()=>{Z&&I(!1)}),[Z]),(0,n.useEffect)((()=>{R&&z(!1)}),[R]);const K=e=>[e.Green,e.Yellow,e.Red,e.Grey];(0,n.useEffect)((()=>{if(t){const e={Green:0,Yellow:0,Red:0,Grey:0},t={Green:0,Yellow:0,Red:0,Grey:0},n=new URL(window.location.toString()),s=!1?"9090":n.port,r=new URL(document.baseURI).pathname,l=(0,j.x2)(n.protocol),i=new o.w3cwebsocket("".concat(l,"://").concat(n.hostname,":").concat(s).concat(r,"ws/heal/").concat(D,"?prefix=").concat(A,"&recursive=").concat(N,"&force-start=").concat(Z,"&force-stop=").concat(R));if(null!==i)return i.onopen=()=>{console.log("WebSocket Client Connected"),i.send("ok")},i.onmessage=a=>{let n=JSON.parse(a.data.toString());for(const[e,s]of Object.entries(n.healthAfterCols))t[e]=100*s/n.itemsScanned;for(const[t,s]of Object.entries(n.healthBeforeCols))e[t]=100*s/n.itemsScanned;F({beforeHeal:K(e),afterHeal:K(t),objectsHealed:n.objectsHealed,objectsScanned:n.objectsScanned,healDuration:n.healDuration,sizeScanned:(0,m.ae)(n.bytesScanned.toString())})},i.onclose=()=>{a(!1),console.log("connection closed by server")},()=>{i.close(1e3),console.log("closing websockets")}}}),[t,D,Z,R,A,N]);let P=[{name:"Green",ah:L.afterHeal[0],bh:L.beforeHeal[0],amt:100},{name:"Yellow",ah:L.afterHeal[1],bh:L.beforeHeal[1],amt:100},{name:"Red",ah:L.afterHeal[2],bh:L.beforeHeal[2],amt:100},{name:"Grey",ah:L.afterHeal[3],bh:L.beforeHeal[3],amt:100}];const M=_.map((e=>({label:e.name,value:e.name}))),X=(0,S.TL)();return(0,n.useEffect)((()=>{X((0,w.Sc)("heal"))}),[]),(0,B.jsxs)(n.Fragment,{children:[(0,B.jsx)(C.Z,{label:"Drives",actions:(0,B.jsx)(H.Z,{})}),(0,B.jsx)(r.Xgh,{children:e?(0,B.jsxs)(y.s,{scopes:[v.Ft.ADMIN_HEAL],resource:v.C3,children:[(0,B.jsxs)(r.xuv,{withBorders:!0,children:[(0,B.jsxs)(r.xuv,{sx:{display:"flex",alignItems:"center",marginBottom:15,gap:15},children:[(0,B.jsxs)(r.xuv,{sx:{flexGrow:1,width:"100%"},children:[(0,B.jsx)(r.AZs,{children:"Bucket"}),(0,B.jsx)(r.PhF,{id:"bucket-name",name:"bucket-name",value:D,onChange:e=>{T(e)},options:M,placeholder:"Select Bucket"})]}),(0,B.jsxs)(r.xuv,{sx:{flexGrow:1,width:"100%"},children:[(0,B.jsx)(r.AZs,{children:"Prefix"}),(0,B.jsx)(r.Wzg,{id:"prefix-resource",disabled:!1,onChange:e=>{G(e.target.value)}})]})]}),(0,B.jsxs)(r.xuv,{sx:{display:"flex",gap:20},children:[(0,B.jsx)(r.xuv,{children:(0,B.jsx)(r.XZJ,{name:"recursive",id:"recursive",value:"recursive",checked:N,onChange:()=>{O(!N)},disabled:!1,label:"Recursive"})}),(0,B.jsx)(r.xuv,{children:(0,B.jsx)(r.XZJ,{name:"forceStart",id:"forceStart",value:"forceStart",checked:Z,onChange:()=>{z(!Z)},disabled:!1,label:"Force Start"})}),(0,B.jsx)(r.xuv,{children:(0,B.jsx)(r.XZJ,{name:"forceStop",id:"forceStop",value:"forceStop",checked:R,onChange:()=>{I(!R)},disabled:!1,label:"Force Stop"})})]}),(0,B.jsx)(r.xuv,{sx:g.ID.modalButtonBar,children:(0,B.jsx)(r.zxk,{id:"start-heal",type:"submit",variant:"callAction",color:"primary",disabled:t,onClick:()=>a(!0),label:"Start"})})]}),(0,B.jsxs)(r.xuv,{withBorders:!0,sx:{marginTop:15,'& ul li:not([class*="Mui"])::before':{listStyle:"none",content:"' '"}},children:[(0,B.jsx)(l.h,{width:"90%",height:400,children:(0,B.jsxs)(i.v,{width:600,height:400,data:P,margin:{top:5,right:30,left:20,bottom:5},children:[(0,B.jsx)(c.q,{strokeDasharray:"3 3"}),(0,B.jsx)(d.K,{dataKey:"name"}),(0,B.jsx)(h.B,{}),(0,B.jsx)(x.u,{}),(0,B.jsx)(u.D,{verticalAlign:"top",layout:"horizontal",className:"noLi"}),(0,B.jsx)(f.$,{dataKey:"ah",name:"After Healing",fill:"#2781B060",stroke:"#2781B0"}),(0,B.jsx)(f.$,{dataKey:"bh",name:"Before Healing",fill:"#C83B5160",stroke:"#C83B51"})]})}),(0,B.jsxs)(r.rjZ,{item:!0,xs:12,sx:{marginTop:20,display:"flex",flexDirection:"row",justifyContent:"space-between","& .scanData":{}},children:[(0,B.jsxs)(r.xuv,{className:"scanData",children:[(0,B.jsx)("strong",{children:"Size scanned:"})," ",L.sizeScanned]}),(0,B.jsxs)(r.xuv,{className:"scanData",children:[(0,B.jsx)("strong",{children:"Objects healed:"})," ",L.objectsHealed," /"," ",L.objectsScanned]}),(0,B.jsxs)(r.xuv,{className:"scanData",children:[(0,B.jsx)("strong",{children:"Healing time:"})," ",L.healDuration,"s"]})]})]})]}):(0,B.jsx)(k.Z,{entity:"Heal",iconComponent:(0,B.jsx)(r.lnI,{})})})]})}},94210:e=>{var t=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},38725:(e,t,a)=>{"use strict";a.d(t,{v:()=>i});var n=a(23612),s=a(23782),o=a(90466),r=a(12891),l=a(93137),i=(0,n.z)({chartName:"BarChart",GraphicalChild:s.$,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:o.K},{axisType:"yAxis",AxisComp:r.B}],formatAxisMap:l.t9})},95087:(e,t,a)=>{var n;if("object"===typeof globalThis)n=globalThis;else try{n=a(94210)}catch(l){}finally{if(n||"undefined"===typeof window||(n=window),!n)throw new Error("Could not determine global this")}var s=n.WebSocket||n.MozWebSocket,o=a(51496);function r(e,t){return t?new s(e,t):new s(e)}s&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(r,e,{get:function(){return s[e]}})})),e.exports={w3cwebsocket:s?r:null,version:o}},51496:(e,t,a)=>{e.exports=a(19794).version},19794:e=>{"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=1829.2aaefda6.chunk.js.map
(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[5088],{75088:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return E}});var s=t(29439),r=t(1413),o=t(72791),i=t(95087),a=t(81551),l=t(78687),c=t(57689),d=t(75952),u="error",x="success",g="inProgress",f=t(11135),h=t(25787),p=t(26824),m=t(23814),j=t(61889),v=t(93385),b=t(81207),w=t(80184),y=(0,h.Z)((function(e){return(0,f.Z)({titleBar:{borderBottom:"#E5E5E5 1px solid",padding:"30px 25px",fontSize:20,color:"#07193E",fontWeight:"bold",borderRadius:"10px 10px 0px 0px",paddingTop:0},divisorContainer:{padding:25},serversData:{color:"#07193E",fontSize:18,display:"flex",alignItems:"center","& svg":{marginRight:10}},minioVersionContainer:{fontSize:12,color:"#07193E",justifyContent:"center",alignSelf:"center",alignItems:"center",display:"flex"},versionIcon:{color:"#07193E",marginRight:20},loaderAlign:{textAlign:"center"},advancedContainer:{justifyContent:"flex-end",display:"flex"},optionsContainer:{padding:0,marginBottom:25},advancedConfiguration:{color:"#2781B0",fontSize:10,textDecoration:"underline",border:"none",backgroundColor:"transparent",cursor:"pointer",alignItems:"center",display:"flex","&:hover":{color:"#07193E"},"& svg":{width:10,alignSelf:"center",marginLeft:5}},advancedOpen:{transform:"rotateZ(-90deg) translateX(-4px) translateY(2px)"},advancedClosed:{transform:"rotateZ(90deg)"},advancedContent:{backgroundColor:"#F5F7F9",maxHeight:0,transitionDuration:"0.3s",overflow:"hidden",padding:"0 15px","&.open":{maxHeight:400,padding:15}}})}))((function(e){var n=e.title,t=e.children,r=e.classes,i=e.advancedVisible,a=e.advancedContent,l=(0,o.useState)("N/A"),c=(0,s.Z)(l,2),u=c[0],x=c[1],g=(0,o.useState)(0),f=(0,s.Z)(g,2),h=f[0],p=f[1],m=(0,o.useState)(0),y=(0,s.Z)(m,2),Z=y[0],C=y[1],S=(0,o.useState)(!0),N=(0,s.Z)(S,2),D=N[0],I=N[1],E=(0,o.useState)(!1),k=(0,s.Z)(E,2),R=k[0],P=k[1];return(0,o.useEffect)((function(){D&&b.Z.invoke("GET","/api/v1/admin/info?defaultOnly=true").then((function(e){var n,t=null===(n=e.servers)||void 0===n?void 0:n.length;if(p(t),e.servers.length>0){x(e.servers[0].version);var s=e.servers.reduce((function(e,n){return e+n.drives.length}),0);C(s)}I(!1)})).catch((function(e){I(!1)}))}),[D]),(0,w.jsxs)(j.ZP,{item:!0,xs:12,children:[(0,w.jsx)(j.ZP,{item:!0,xs:12,className:r.titleBar,children:n}),(0,w.jsxs)(j.ZP,{item:!0,xs:12,children:[(0,w.jsxs)(j.ZP,{item:!0,xs:12,className:r.optionsContainer,children:[(0,w.jsx)(j.ZP,{container:!0,className:r.divisorContainer,children:D?(0,w.jsx)(o.Fragment,{children:(0,w.jsx)(j.ZP,{item:!0,xs:12,className:r.loaderAlign,children:(0,w.jsx)(d.aNw,{style:{width:25,height:25}})})}):(0,w.jsxs)(o.Fragment,{children:[(0,w.jsxs)(j.ZP,{item:!0,xs:12,md:4,className:r.serversData,children:[(0,w.jsx)(d.FU8,{})," ",(0,w.jsx)("strong",{children:h}),"\xa0nodes,\xa0",(0,w.jsx)("strong",{children:Z}),"\xa0 drives"]}),(0,w.jsxs)(j.ZP,{item:!0,xs:12,md:4,className:r.minioVersionContainer,children:[(0,w.jsx)("span",{className:r.versionIcon,children:(0,w.jsx)(d.Dbk,{})})," ","MinIO VERSION\xa0",(0,w.jsx)("strong",{children:u})]}),(0,w.jsx)(j.ZP,{item:!0,xs:12,md:4,className:r.advancedContainer,children:i&&(0,w.jsxs)("button",{onClick:function(){P(!R)},className:r.advancedConfiguration,children:["Advanced configurations"," ",(0,w.jsx)("span",{className:R?r.advancedOpen:r.advancedClosed,children:(0,w.jsx)(v.Z,{})})]})})]})}),a&&(0,w.jsx)(j.ZP,{xs:12,className:"".concat(r.advancedContent," ").concat(R?"open":""),children:a})]}),t]})]})})),Z=t(74794),C=t(87995),S=t(12808),N=t(31460),D=t(47974),I=t(9478),E=(0,h.Z)((function(e){return(0,f.Z)((0,r.Z)((0,r.Z)({loading:{paddingTop:8,paddingLeft:40},buttons:{justifyContent:"flex-start",gap:20},localMessage:{fontSize:24,color:"#07193E",fontWeight:"bold",textAlign:"center",marginBottom:20},progressResult:{textAlign:"center",marginBottom:25},startDiagnostic:{display:"flex",justifyContent:"flex-end",margin:25,marginBottom:0},startDiagnosticCenter:{textAlign:"center",marginTop:0}},m.OR),m.Bz))}))((function(e){var n=e.classes,t=(0,a.TL)(),r=(0,c.s0)(),f=(0,l.v9)((function(e){return e.healthInfo.message})),h=(0,l.v9)((function(e){return e.system.serverDiagnosticStatus})),m=(0,o.useState)(!1),j=(0,s.Z)(m,2),v=j[0],b=j[1],E=(0,o.useState)(!0),k=(0,s.Z)(E,2),R=k[0],P=k[1],F=(0,o.useState)(""),A=(0,s.Z)(F,2),O=A[0],z=A[1],_=(0,o.useState)("Start Diagnostic"),H=(0,s.Z)(_,2),B=H[0],L=H[1],T=(0,o.useState)("New Diagnostic"),M=(0,s.Z)(T,2),V=M[0],K=M[1],U=(0,o.useState)(""),W=(0,s.Z)(U,2),Y=W[0],G=W[1],X=(0,o.useState)(""),J=(0,s.Z)(X,2),q=J[0],Q=J[1],$=(0,I.Yc)();(0,o.useEffect)((function(){return h===g?(K("Diagnostic in progress..."),void z("Diagnostic started. Please do not refresh page during diagnosis.")):h===x?(K("Diagnostic complete"),z("Diagnostic file is ready to be downloaded."),void L("Start New Diagnostic")):h===u?(K("Error"),z("An error occurred while getting the Diagnostic file."),void L("Retry Diagnostic")):void 0}),[h,v]),(0,o.useEffect)((function(){h===x&&f!=={}&&P(!1),h===g&&P(!0),b(!1)}),[h,f]),(0,o.useEffect)((function(){if(v){t((0,S.Xp)()),G("");var e=new URL(window.location.toString()),n=e.port,s=(0,p.x2)(e.protocol),r=new URL(document.baseURI).pathname,o=new i.w3cwebsocket("".concat(s,"://").concat(e.hostname,":").concat(n).concat(r,"ws/health-info?deadline=1h")),a=null;null!==o&&(o.onopen=function(){console.log("WebSocket Client Connected"),o.send("ok"),a=setInterval((function(){o.send("ok")}),1e4),z("Diagnostic started. Please do not refresh page during diagnosis."),t((0,C.KY)(g))},o.onmessage=function(e){var n=JSON.parse(e.data.toString());n.serverHealthInfo&&(n.serverHealthInfo.timestamp=new Date(n.serverHealthInfo.timestamp.toString()),t((0,S.ec)(n.serverHealthInfo))),""!==n.encoded&&G(n.encoded),n.subnetResponse&&Q(n.subnetResponse)},o.onerror=function(e){console.log("error closing websocket:",e.message),o.close(1e3),clearInterval(a),t((0,C.KY)(u))},o.onclose=function(e){clearInterval(a),e.code===p.HE||e.code===p.ci||e.code===p.V9?(console.log("connection closed by server with code:",e.code),z("An error occurred while getting the Diagnostic file."),t((0,C.KY)(u))):(console.log("connection closed by server"),z("Diagnostic file is ready to be downloaded."),t((0,C.KY)(x)))})}else b(!1)}),[v,t]);return(0,w.jsxs)(o.Fragment,{children:[(0,w.jsx)(D.Z,{label:"Health"}),(0,w.jsxs)(Z.Z,{children:[!$&&(0,w.jsx)(N.Z,{compactMode:!0}),(0,w.jsx)(d.rjZ,{item:!0,xs:12,className:n.boxy,children:(0,w.jsx)(y,{title:V,advancedVisible:!1,children:(0,w.jsx)(d.rjZ,{container:!0,className:n.buttons,children:(0,w.jsxs)(d.rjZ,{item:!0,xs:12,className:n.progressResult,children:[(0,w.jsx)("div",{className:n.localMessage,children:O}),(0,w.jsxs)("div",{className:n.progressResult,children:[" ",""!==q&&!q.toLowerCase().includes("error")&&(0,w.jsxs)(d.rjZ,{item:!0,xs:12,className:n.serversData,children:[(0,w.jsx)("strong",{children:"Health report uploaded to Subnet successfully!"}),"\xa0"," ",(0,w.jsxs)("strong",{children:["See the results on your"," ",(0,w.jsx)("a",{href:q,children:"Subnet Dashboard"})," "]})]}),(""===q||q.toLowerCase().includes("error"))&&h===x&&(0,w.jsxs)(d.rjZ,{item:!0,xs:12,className:n.serversData,children:[(0,w.jsx)("strong",{children:"Something went wrong uploading your Health report to Subnet."}),"\xa0"," ",(0,w.jsxs)("strong",{children:["Log into your"," ",(0,w.jsx)("a",{href:"https://subnet.min.io",children:"Subnet Account"})," to manually upload your Health report."]})]})]}),h===g?(0,w.jsx)("div",{className:n.loading,children:(0,w.jsx)(d.aNw,{style:{width:25,height:25}})}):(0,w.jsx)(o.Fragment,{children:(0,w.jsxs)(d.xuv,{sx:{display:"flex",gap:10,alignItems:"center",justifyContent:"center"},children:[(0,w.jsx)(d.xuv,{children:h!==u&&!R&&(0,w.jsx)(d.zxk,{id:"download",type:"submit",variant:"callAction",onClick:function(){return function(){var e=document.createElement("a");e.setAttribute("href","data:application/gzip;base64,".concat(Y)),e.setAttribute("download","diagnostic.json.gz"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}()},disabled:R,label:"Download"})}),(0,w.jsx)(d.xuv,{children:(0,w.jsx)(d.zxk,{id:"start-new-diagnostic",type:"submit",variant:$?"callAction":"regular",disabled:v,onClick:function(){$?b(!0):r("/support/register")},label:B})})]})})]},"start-download")})})}),!v&&$&&(0,w.jsxs)(o.Fragment,{children:[(0,w.jsx)("br",{}),(0,w.jsx)(d.KfX,{title:"During the health diagnostics run, all production traffic will be suspended.",iconComponent:(0,w.jsx)(d.e6P,{}),help:(0,w.jsx)(o.Fragment,{children:"Cluster Health Report will be uploaded to Subnet, and is viewable from your Subnet Diagnostics dashboard."})})]})]})]})}))},31460:function(e,n,t){"use strict";var s=t(72791),r=t(36151),o=t(64554),i=t(57689),a=t(75952),l=t(80184);n.Z=function(e){var n=e.compactMode,t=void 0!==n&&n,c=(0,i.s0)(),d=(0,l.jsx)(r.Z,{type:"submit",variant:"contained",color:"primary",onClick:function(){return c("/support/register")},children:"Register your Cluster"}),u="Use your MinIO Subscription Network login credentials to register this cluster.";return t?(0,l.jsxs)(s.Fragment,{children:[(0,l.jsx)(a.rjZ,{sx:{"& div.leftItems":{marginBottom:0}},children:(0,l.jsx)(a.KfX,{title:(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexGrow:1},children:[(0,l.jsx)("span",{children:u})," ",d]}),iconComponent:(0,l.jsx)(a.e6P,{}),help:(0,l.jsx)(s.Fragment,{})})}),(0,l.jsx)("br",{})]}):(0,l.jsx)(o.Z,{sx:{padding:"25px",border:"1px solid #eaeaea",display:"flex",alignItems:"center",justifyContent:"center",flexFlow:{sm:"row",xs:"column"},marginBottom:"15px"},children:(0,l.jsxs)(a.rjZ,{container:!0,children:[(0,l.jsx)(a.rjZ,{item:!0,xs:12,children:(0,l.jsx)(o.Z,{sx:{marginRight:"8px",fontSize:"16px",fontWeight:600,display:"flex",alignItems:"center","& .min-icon":{width:"83px",height:"14px",marginLeft:"5px",marginRight:"5px"}},children:"Register your cluster"})}),(0,l.jsx)(a.rjZ,{item:!0,xs:12,children:(0,l.jsx)(o.Z,{sx:{display:"flex",flexFlow:{xs:"column",md:"row"}},children:(0,l.jsxs)(o.Z,{sx:{display:"flex",flexFlow:"column",flex:"2"},children:[(0,l.jsx)(o.Z,{sx:{fontSize:"16px",display:"flex",flexFlow:"column",marginTop:"15px",marginBottom:"15px"},children:u}),(0,l.jsx)(o.Z,{sx:{flex:"1"},children:(0,l.jsx)(o.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:d})})]})})})]})})}},26824:function(e,n,t){"use strict";t.d(n,{HE:function(){return o},V9:function(){return s},ci:function(){return r},x2:function(){return i}});var s=1006,r=1008,o=1011,i=function(e){var n="ws";return"https:"===e&&(n="wss"),n}},93385:function(e,n,t){"use strict";var s=t(64836);n.Z=void 0;var r=s(t(45649)),o=t(80184),i=(0,r.default)((0,o.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos");n.Z=i},94210:function(e){var n=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}()},95087:function(e,n,t){var s;if("object"===typeof globalThis)s=globalThis;else try{s=t(94210)}catch(a){}finally{if(s||"undefined"===typeof window||(s=window),!s)throw new Error("Could not determine global this")}var r=s.WebSocket||s.MozWebSocket,o=t(51496);function i(e,n){return n?new r(e,n):new r(e)}r&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(i,e,{get:function(){return r[e]}})})),e.exports={w3cwebsocket:r?i:null,version:o}},51496:function(e,n,t){e.exports=t(19794).version},19794:function(e){"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=5088.00beec7c.chunk.js.map
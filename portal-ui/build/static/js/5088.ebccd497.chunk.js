(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[5088],{23804:function(e,t,n){"use strict";n(72791);var o=n(11135),i=n(25787),s=n(61889),r=n(80184);t.Z=(0,i.Z)((function(e){return(0,o.Z)({root:{border:"1px solid #E2E2E2",borderRadius:2,backgroundColor:"#FBFAFA",paddingLeft:25,paddingTop:31,paddingBottom:21,paddingRight:30},leftItems:{fontSize:16,fontWeight:"bold",marginBottom:15,display:"flex",alignItems:"center","& .min-icon":{marginRight:15,height:28,width:38}},helpText:{fontSize:16,paddingLeft:5}})}))((function(e){var t=e.classes,n=e.iconComponent,o=e.title,i=e.help;return(0,r.jsx)("div",{className:t.root,children:(0,r.jsxs)(s.ZP,{container:!0,children:[(0,r.jsxs)(s.ZP,{item:!0,xs:12,className:t.leftItems,children:[n,o]}),(0,r.jsx)(s.ZP,{item:!0,xs:12,className:t.helpText,children:i})]})})}))},75088:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var o=n(29439),i=n(1413),s=n(72791),r=n(95087),a=n(60364),c=n(91431),l="error",d="success",u="inProgress",g=n(11135),f=n(25787),h=n(26824),m=n(23814),p=n(61889),x=n(36151),v=n(32291),b=n(42649),j=n(93385),Z=n(62410),w=n(81207),y=n(72401),S=n(80184),C=(0,f.Z)((function(e){return(0,g.Z)({titleBar:{borderBottom:"#E5E5E5 1px solid",padding:"30px 25px",fontSize:20,color:"#07193E",fontWeight:"bold",borderRadius:"10px 10px 0px 0px",paddingTop:0},divisorContainer:{padding:25},serversData:{color:"#07193E",fontSize:18,display:"flex",alignItems:"center","& svg":{marginRight:10}},minioVersionContainer:{fontSize:12,color:"#07193E",justifyContent:"center",alignSelf:"center",alignItems:"center",display:"flex"},versionIcon:{color:"#07193E",marginRight:20},loaderAlign:{textAlign:"center"},advancedContainer:{justifyContent:"flex-end",display:"flex"},optionsContainer:{padding:0,marginBottom:25},advancedConfiguration:{color:"#2781B0",fontSize:10,textDecoration:"underline",border:"none",backgroundColor:"transparent",cursor:"pointer",alignItems:"center",display:"flex","&:hover":{color:"#07193E"},"& svg":{width:10,alignSelf:"center",marginLeft:5}},advancedOpen:{transform:"rotateZ(-90deg) translateX(-4px) translateY(2px)"},advancedClosed:{transform:"rotateZ(90deg)"},advancedContent:{backgroundColor:"#F5F7F9",maxHeight:0,transitionDuration:"0.3s",overflow:"hidden",padding:"0 15px","&.open":{maxHeight:400,padding:15}}})}))((function(e){var t=e.title,n=e.children,i=e.classes,r=e.advancedVisible,a=e.advancedContent,c=(0,s.useState)("N/A"),l=(0,o.Z)(c,2),d=l[0],u=l[1],g=(0,s.useState)(0),f=(0,o.Z)(g,2),h=f[0],m=f[1],x=(0,s.useState)(0),v=(0,o.Z)(x,2),b=v[0],C=v[1],N=(0,s.useState)(!0),E=(0,o.Z)(N,2),I=E[0],k=E[1],D=(0,s.useState)(!1),P=(0,o.Z)(D,2),R=P[0],A=P[1];return(0,s.useEffect)((function(){I&&w.Z.invoke("GET","/api/v1/admin/info?defaultOnly=true").then((function(e){var t,n=null===(t=e.servers)||void 0===t?void 0:t.length;if(m(n),e.servers.length>0){u(e.servers[0].version);var o=e.servers.reduce((function(e,t){return e+t.drives.length}),0);C(o)}k(!1)})).catch((function(e){k(!1)}))}),[I]),(0,S.jsxs)(p.ZP,{item:!0,xs:12,children:[(0,S.jsx)(p.ZP,{item:!0,xs:12,className:i.titleBar,children:t}),(0,S.jsxs)(p.ZP,{item:!0,xs:12,children:[(0,S.jsxs)(p.ZP,{item:!0,xs:12,className:i.optionsContainer,children:[(0,S.jsx)(p.ZP,{container:!0,className:i.divisorContainer,children:I?(0,S.jsx)(s.Fragment,{children:(0,S.jsx)(p.ZP,{item:!0,xs:12,className:i.loaderAlign,children:(0,S.jsx)(y.Z,{style:{width:25,height:25}})})}):(0,S.jsxs)(s.Fragment,{children:[(0,S.jsxs)(p.ZP,{item:!0,xs:12,md:4,className:i.serversData,children:[(0,S.jsx)(Z.FU8,{})," ",(0,S.jsx)("strong",{children:h}),"\xa0nodes,\xa0",(0,S.jsx)("strong",{children:b}),"\xa0 drives"]}),(0,S.jsxs)(p.ZP,{item:!0,xs:12,md:4,className:i.minioVersionContainer,children:[(0,S.jsx)("span",{className:i.versionIcon,children:(0,S.jsx)(Z.Dbk,{})})," ","MinIO VERSION\xa0",(0,S.jsx)("strong",{children:d})]}),(0,S.jsx)(p.ZP,{item:!0,xs:12,md:4,className:i.advancedContainer,children:r&&(0,S.jsxs)("button",{onClick:function(){A(!R)},className:i.advancedConfiguration,children:["Advanced configurations"," ",(0,S.jsx)("span",{className:R?i.advancedOpen:i.advancedClosed,children:(0,S.jsx)(j.Z,{})})]})})]})}),a&&(0,S.jsx)(p.ZP,{xs:12,className:"".concat(i.advancedContent," ").concat(R?"open":""),children:a})]}),n]})]})})),N=n(74794),E=n(23804),I=n(89357),k=(0,a.$j)((function(e){return{message:e.healthInfo.message,serverDiagnosticStatus:e.system.serverDiagnosticStatus}}),{healthInfoMessageReceived:c.ec,healthInfoResetMessage:c.Xp,setSnackBarMessage:b.y1,setServerDiagStat:b.KY})((0,f.Z)((function(e){return(0,g.Z)((0,i.Z)((0,i.Z)({loading:{paddingTop:8,paddingLeft:40},buttons:{justifyContent:"flex-start",gap:20},localMessage:{fontSize:24,color:"#07193E",fontWeight:"bold",textAlign:"center",marginBottom:10},startDiagnostic:{textAlign:"center",marginBottom:25},progressResult:{textAlign:"center",marginBottom:25},diagNew:{textAlign:"right",margin:25,marginBottom:0}},m.OR),(0,m.Bz)(e.spacing(4))))}))((function(e){var t=e.classes,n=e.healthInfoMessageReceived,i=e.healthInfoResetMessage,a=e.message,c=e.setSnackBarMessage,g=e.setServerDiagStat,f=e.serverDiagnosticStatus,m=(0,s.useState)(!1),b=(0,o.Z)(m,2),j=b[0],Z=b[1],w=(0,s.useState)(!1),k=(0,o.Z)(w,2),D=k[0],P=k[1],R=(0,s.useState)(!0),A=(0,o.Z)(R,2),B=A[0],O=A[1],F=(0,s.useState)(""),_=(0,o.Z)(F,2),z=_[0],T=_[1],M=(0,s.useState)("New Diagnostic"),H=(0,o.Z)(M,2),L=H[0],V=H[1],W=(0,s.useState)(""),U=(0,o.Z)(W,2),G=U[0],X=U[1];return(0,s.useEffect)((function(){f!==u?f===d&&D?V("Diagnostic complete"):f!==l||V("Error"):V("Diagnostic in progress...")}),[f,j,D]),(0,s.useEffect)((function(){f===d&&a!=={}&&O(!1),f===u&&O(!0),Z(!1)}),[f,a]),(0,s.useEffect)((function(){if(j){i(),X("");var e=new URL(window.location.toString()),t=e.port,o=(0,h.x2)(e.protocol),s=new URL(document.baseURI).pathname,a=new r.w3cwebsocket("".concat(o,"://").concat(e.hostname,":").concat(t).concat(s,"ws/health-info?deadline=1h")),c=null;null!==a&&(a.onopen=function(){console.log("WebSocket Client Connected"),a.send("ok"),c=setInterval((function(){a.send("ok")}),1e4),P(!0),T("Diagnostic started. Please do not refresh page during diagnosis."),g(u)},a.onmessage=function(e){var t=JSON.parse(e.data.toString());t.serverHealthInfo&&(t.serverHealthInfo.timestamp=new Date(t.serverHealthInfo.timestamp.toString()),n(t.serverHealthInfo)),""!==t.encoded&&X(t.encoded)},a.onerror=function(e){console.log("error closing websocket:",e.message),a.close(1e3),clearInterval(c),g(l)},a.onclose=function(e){clearInterval(c),e.code===h.HE||e.code===h.ci||e.code===h.V9?(console.log("connection closed by server with code:",e.code),T("An error occurred while getting Diagnostic file."),g(l)):(console.log("connection closed by server"),T("Diagnostic file is ready to be downloaded."),g(d))})}else Z(!1)}),[n,i,j,c,g]),(0,S.jsxs)(s.Fragment,{children:[(0,S.jsx)(v.Z,{label:"Health"}),(0,S.jsxs)(N.Z,{children:[(0,S.jsx)(p.ZP,{item:!0,xs:12,className:t.boxy,children:(0,S.jsx)(C,{title:L,advancedVisible:!1,children:(0,S.jsxs)(p.ZP,{container:!0,className:t.buttons,children:[!D&&(0,S.jsx)(p.ZP,{item:!0,xs:12,className:t.startDiagnostic,children:(0,S.jsx)(x.Z,{type:"submit",variant:"contained",color:"primary",disabled:j,onClick:function(){return Z(!0)},children:"Start Diagnostic"})},"start-diag"),D&&(0,S.jsxs)(p.ZP,{item:!0,xs:12,className:t.progressResult,children:[(0,S.jsx)("div",{className:t.localMessage,children:z}),f===u?(0,S.jsx)("div",{className:t.loading,children:(0,S.jsx)(y.Z,{style:{width:25,height:25}})}):(0,S.jsxs)(s.Fragment,{children:[f!==l&&(0,S.jsx)(x.Z,{type:"submit",variant:"contained",color:"primary",onClick:function(){return function(){var e=document.createElement("a");e.setAttribute("href","data:application/gzip;base64,".concat(G)),e.setAttribute("download","diagnostic.json.gz"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}()},disabled:B,children:"Download"}),(0,S.jsx)(p.ZP,{item:!0,xs:12,className:t.diagNew,children:(0,S.jsx)(x.Z,{id:"start-new-diagnostic",type:"submit",variant:"contained",color:"primary",disabled:j,onClick:function(){return Z(!0)},children:"Start New Diagnostic"})})]})]},"start-download")]})})}),!D&&(0,S.jsxs)(s.Fragment,{children:[(0,S.jsx)("br",{}),(0,S.jsx)(E.Z,{title:"During the health diagnostics run all production traffic will be suspended.",iconComponent:(0,S.jsx)(I.Z,{}),help:(0,S.jsx)(s.Fragment,{})})]})]})]})})))},26824:function(e,t,n){"use strict";n.d(t,{HE:function(){return s},V9:function(){return o},ci:function(){return i},x2:function(){return r}});var o=1006,i=1008,s=1011,r=function(e){var t="ws";return"https:"===e&&(t="wss"),t}},93385:function(e,t,n){"use strict";var o=n(95318);t.Z=void 0;var i=o(n(45649)),s=n(80184),r=(0,i.default)((0,s.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos");t.Z=r},94210:function(e){var t=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},95087:function(e,t,n){var o;if("object"===typeof globalThis)o=globalThis;else try{o=n(94210)}catch(a){}finally{if(o||"undefined"===typeof window||(o=window),!o)throw new Error("Could not determine global this")}var i=o.WebSocket||o.MozWebSocket,s=n(51496);function r(e,t){return t?new i(e,t):new i(e)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(r,e,{get:function(){return i[e]}})})),e.exports={w3cwebsocket:i?r:null,version:s}},51496:function(e,t,n){e.exports=n(19794).version},19794:function(e){"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=5088.ebccd497.chunk.js.map
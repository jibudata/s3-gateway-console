"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[5367],{13871:function(e,t,n){var a,i=n(30168),r=(0,n(26088).Z)("hr")(a||(a=(0,i.Z)(["\n  border-top: 0;\n  border-left: 0;\n  border-right: 0;\n  border-color: #999999;\n  background-color: transparent;\n"])));t.Z=r},15367:function(e,t,n){n.r(t);var a=n(29439),i=n(1413),r=n(72791),o=n(75952),s=n(11135),l=n(25787),c=n(23814),u=n(78687),d=n(25469),m=n(81207),g=n(57689),v=n(37516),h=n(61889),p=n(21435),x=n(51691),f=n(23508),Z=n(87995),y=n(32509),C=n(56578),j=n(25693),b=n(84741),N=n(18158),A=n(1078),S=n(13871),R=n(80184);t.default=(0,l.Z)((function(e){return(0,s.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},c.oZ),c.bK),c.Bz),c.QV),c.DF),c.oO),c.AK))}))((function(e){var t=e.classes,n=(0,d.TL)(),i=(0,g.UO)(),s=i.tenantName,l=i.tenantNamespace,c=(0,u.v9)((function(e){return e.editTenantMonitoring.prometheusEnabled})),k=(0,u.v9)((function(e){return e.editTenantMonitoring.image})),G=(0,u.v9)((function(e){return e.editTenantMonitoring.sidecarImage})),P=(0,u.v9)((function(e){return e.editTenantMonitoring.initImage})),I=(0,u.v9)((function(e){return e.editTenantMonitoring.diskCapacityGB})),M=(0,u.v9)((function(e){return e.editTenantMonitoring.monitoringCPURequest})),q=(0,u.v9)((function(e){return e.editTenantMonitoring.monitoringMemRequest})),T=(0,u.v9)((function(e){return e.editTenantMonitoring.serviceAccountName})),w=(0,u.v9)((function(e){return e.editTenantMonitoring.storageClassName})),B=(0,r.useState)({}),U=(0,a.Z)(B,2),F=U[0],_=U[1],z=(0,r.useState)(!1),E=(0,a.Z)(z,2),L=E[0],V=E[1],O=(0,r.useState)([{key:"",value:""}]),D=(0,a.Z)(O,2),X=D[0],K=D[1],$=(0,r.useState)([{key:"",value:""}]),H=(0,a.Z)($,2),Q=H[0],J=H[1],W=(0,r.useState)([{key:"",value:""}]),Y=(0,a.Z)(W,2),ee=Y[0],te=Y[1],ne=(0,r.useState)(!0),ae=(0,a.Z)(ne,2),ie=ae[0],re=ae[1],oe=(0,r.useState)({}),se=(0,a.Z)(oe,2),le=se[0],ce=se[1],ue=(0,r.useState)({}),de=(0,a.Z)(ue,2),me=de[0],ge=de[1],ve=(0,r.useState)({}),he=(0,a.Z)(ve,2),pe=he[0],xe=he[1],fe=(0,u.v9)((function(e){return e.editTenantMonitoring.runAsGroup})),Ze=(0,u.v9)((function(e){return e.editTenantMonitoring.runAsUser})),ye=(0,u.v9)((function(e){return e.editTenantMonitoring.fsGroup})),Ce=(0,u.v9)((function(e){return e.editTenantMonitoring.runAsNonRoot})),je=(0,u.v9)((function(e){return e.editTenantSecurityContext.fsGroupChangePolicy})),be=function(e){_((0,b.he)(F,e))},Ne=function(e){for(var t=[],n=0;n<e.length;n++)""!==e[n].key&&t.push(e[n]);return t},Ae=function(){if(0!==Object.keys(F).length||0!==Object.keys(le).length||0!==Object.keys(me).length||0!==Object.keys(pe).length){return n((0,Z.Ih)({errorMessage:"Invalid entry",detailedError:""})),!1}return!0};(0,r.useEffect)((function(){ie&&m.Z.invoke("GET","/api/v1/namespaces/".concat(l||"","/tenants/").concat(s||"","/monitoring")).then((function(e){n((0,j.bX)(e.prometheusEnabled)),function(e){n((0,j.QL)(e.image)),n((0,j.Ct)(e.sidecarImage)),n((0,j.Xz)(e.initImage)),n((0,j.cj)(e.storageClassName)),n((0,j.Tg)(e.diskCapacityGB)),n((0,j.qX)(e.serviceAccountName)),n((0,j.AC)(e.monitoringCPURequest)),e.monitoringMemRequest?n((0,j.bZ)(Math.floor(parseInt(e.monitoringMemRequest,10)/1e9).toString())):n((0,j.bZ)("0")),null!=e.labels?K(e.labels):K([{key:"",value:""}]),null!=e.annotations?J(e.annotations):J([{key:"",value:""}]),null!=e.nodeSelector?te(e.nodeSelector):te([{key:"",value:""}]),n((0,j.Be)(e.securityContext.runAsGroup)),n((0,j.wT)(e.securityContext.runAsUser)),n((0,j.vM)(e.securityContext.runAsNonRoot)),n((0,j.FP)(e.securityContext.fsGroup))}(e),re(!1)})).catch((function(e){n((0,Z.Ih)(e)),re(!1)}))}),[ie]);return(0,R.jsxs)(r.Fragment,{children:[L&&(0,R.jsx)(f.Z,{isOpen:L,title:c?"Disable Prometheus monitoring for this tenant?":"Enable Prometheus monitoring for this tenant?",confirmText:c?"Disable":"Enable",cancelText:"Cancel",onClose:function(){return V(!1)},onConfirm:function(){var e={prometheusEnabled:c,toggle:!0};m.Z.invoke("PUT","/api/v1/namespaces/".concat(l,"/tenants/").concat(s,"/monitoring"),e).then((function(){n((0,j.bX)(!c)),re(!0),V(!1),re(!0)})).catch((function(e){n((0,Z.Ih)(e))}))},confirmationContent:(0,R.jsx)(x.Z,{children:c?" Current configuration will be lost, and defaults reset if reenabled.":"A small Prometheus server will be started per the configuration provided, which will collect the Prometheus metrics for your tenant."})}),(0,R.jsxs)(h.ZP,{container:!0,spacing:1,children:[(0,R.jsx)(h.ZP,{item:!0,xs:!0,children:(0,R.jsx)("h1",{className:t.sectionTitle,children:"Prometheus Monitoring "})}),(0,R.jsx)(h.ZP,{item:!0,xs:7,justifyContent:"end",textAlign:"right",children:(0,R.jsx)(v.Z,{label:"",indicatorLabels:["Enabled","Disabled"],checked:c,value:"tenant_monitoring",id:"tenant-monitoring",name:"tenant-monitoring",onChange:function(){V(!0)},description:""})}),(0,R.jsx)(h.ZP,{item:!0,xs:12,children:(0,R.jsx)(S.Z,{})})]}),c&&(0,R.jsxs)(r.Fragment,{children:[(0,R.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,R.jsx)(p.Z,{id:"prometheus_image",label:"Image",placeholder:"quay.io/prometheus/prometheus:latest",name:"image",value:k,onChange:function(e){e.target.validity.valid&&n((0,j.QL)(e.target.value)),be("image")},pattern:b.lN,error:F.image||""},"image")}),(0,R.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,R.jsx)(p.Z,{id:"sidecarImage",label:"Sidecar Image",placeholder:"library/alpine:latest",name:"sidecarImage",value:G,onChange:function(e){e.target.validity.valid&&n((0,j.Ct)(e.target.value)),be("sidecarImage")},pattern:b.lN,error:F.sidecarImage||""},"sidecarImage")}),(0,R.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,R.jsx)(p.Z,{id:"initImage",label:"Init Image",placeholder:"library/busybox:1.33.1",name:"initImage",value:P,onChange:function(e){e.target.validity.valid&&n((0,j.Xz)(e.target.value)),be("initImage")},pattern:b.lN,error:F.initImage||""},"initImage")}),(0,R.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,R.jsx)(p.Z,{id:"diskCapacityGB",label:"Disk Capacity",placeholder:"Disk Capacity",name:"diskCapacityGB",value:I,onChange:function(e){e.target.validity.valid&&n((0,j.Tg)(e.target.value)),be("diskCapacityGB")},pattern:b.ux,error:F.diskCapacityGB||"",overlayObject:(0,R.jsx)(C.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"diskCapacityGB")}),(0,R.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,R.jsx)(p.Z,{id:"cpuRequest",label:"CPU Request",placeholder:"CPU Request",name:"cpuRequest",value:M,pattern:b.ux,onChange:function(e){e.target.validity.valid&&n((0,j.AC)(e.target.value)),be("cpuRequest")},error:F.cpuRequest||""},"cpuRequest")}),(0,R.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,R.jsx)(p.Z,{id:"memRequest",label:"Memory Request",placeholder:"Memory request",name:"memRequest",value:q,onChange:function(e){e.target.validity.valid&&n((0,j.bZ)(e.target.value)),be("memRequest")},pattern:b.ux,error:F.memRequest||"",overlayObject:(0,R.jsx)(C.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"memRequest")}),(0,R.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,R.jsx)(p.Z,{id:"serviceAccountName",label:"Service Account",placeholder:"Service Account Name",name:"serviceAccountName",value:T,onChange:function(e){e.target.validity.valid&&n((0,j.qX)(e.target.value)),be("serviceAccountName")},pattern:"^[a-zA-Z0-9-.]{1,253}$",error:F.serviceAccountName||""},"serviceAccountName")}),(0,R.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,R.jsx)(p.Z,{id:"storageClassName",label:"Storage Class",placeholder:"Storage Class Name",name:"storageClassName",value:w,onChange:function(e){e.target.validity.valid&&n((0,j.cj)(e.target.value)),be("storageClassName")},pattern:"^[a-zA-Z0-9-.]{1,253}$",error:F.storageClassName||""},"storageClassName")}),null!==X&&(0,R.jsxs)(h.ZP,{item:!0,xs:12,className:t.formFieldRow,children:[(0,R.jsx)("span",{className:t.inputLabel,children:"Labels"}),(0,R.jsx)(y.Z,{newValues:X,setNewValues:K,paramName:"Labels",error:le,setError:ce})]}),null!==Q&&(0,R.jsxs)(h.ZP,{item:!0,xs:12,className:t.formFieldRow,children:[(0,R.jsx)("span",{className:t.inputLabel,children:"Annotations"}),(0,R.jsx)(y.Z,{newValues:Q,setNewValues:J,paramName:"Annotations",error:me,setError:ge})]}),null!==ee&&(0,R.jsxs)(h.ZP,{item:!0,xs:12,className:t.formFieldRow,children:[(0,R.jsx)("span",{className:t.inputLabel,children:"Node Selector"}),(0,R.jsx)(y.Z,{newValues:ee,setNewValues:te,paramName:"Node Selector",error:pe,setError:xe})]}),(0,R.jsx)(h.ZP,{item:!0,xs:12,className:t.formFieldRow,children:(0,R.jsx)(N.Z,{classes:t,runAsGroup:fe,runAsUser:Ze,fsGroup:ye,runAsNonRoot:Ce,fsGroupChangePolicy:je,setFSGroup:function(e){return n((0,j.FP)(e))},setRunAsUser:function(e){return n((0,j.wT)(e))},setRunAsGroup:function(e){return n((0,j.Be)(e))},setRunAsNonRoot:function(e){return n((0,j.vM)(e))},setFSGroupChangePolicy:function(e){return n((0,A.rR)(e))}})}),(0,R.jsx)(h.ZP,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end"},children:(0,R.jsx)(o.zxk,{type:"submit",id:"submit_button",variant:"callAction",disabled:!Ae(),onClick:function(){return function(){if(Ae()){var e={runAsGroup:null!=fe?fe:"0",runAsUser:null!=Ze?Ze:"0",fsGroup:null!=ye?ye:"0",runAsNonRoot:null==Ce||Ce};m.Z.invoke("PUT","/api/v1/namespaces/".concat(l,"/tenants/").concat(s,"/monitoring"),{labels:Ne(X),annotations:Ne(Q),nodeSelector:Ne(ee),image:k,sidecarImage:G,initImage:P,diskCapacityGB:I,serviceAccountName:T,storageClassName:w,monitoringCPURequest:M,monitoringMemRequest:q+"Gi",securityContext:e}).then((function(){re(!0),n((0,Z.y1)("Prometheus configuration updated."))})).catch((function(e){(0,Z.Ih)(e)}))}}()},label:"Save"})})]})]})}))},32509:function(e,t,n){var a=n(93433),i=n(1413),r=n(72791),o=n(11135),s=n(25787),l=n(23814),c=n(21435),u=n(20068),d=n(13400),m=n(42419),g=n(27247),v=n(40968),h=n(84741),p=n(61889),x=n(80184);t.Z=(0,s.Z)((function(e){return(0,o.Z)((0,i.Z)({shortened:{gridTemplateColumns:"auto auto 20px 20px",display:"grid",gridGap:20,paddingRight:20}},l.oO))}))((function(e){var t=e.classes,n=e.paramName,i=e.newValues,o=e.setNewValues,s=e.error,l=e.setError,f=function(e){l((0,h.he)(s,e))};(0,r.useEffect)((function(){for(var e=[],t=0;t<i.length;t++)e.push({fieldKey:"key-".concat(t.toString()),required:!1,value:i[t].key,pattern:/^[a-zA-Z0-9-_.]{1,63}$/,customPatternMessage:"Invalid key"}),e.push({fieldKey:"val-".concat(t.toString()),required:!1,value:i[t].value,pattern:/^[a-zA-Z0-9-_.]{1,63}$/,customPatternMessage:"Invalid value"});var n=(0,v.R)(e);l(n)}),[i,l]);var Z=i.map((function(e,l){return(0,x.jsx)(r.Fragment,{children:(0,x.jsx)(p.ZP,{paddingBottom:1,children:(0,x.jsxs)("div",{className:t.shortened,children:[(0,x.jsx)(c.Z,{id:"key-".concat(n.replace(/ /g,""),"-").concat(l.toString()),label:"",placeholder:"Key",name:"key-".concat(l.toString()),value:i[l].key,onChange:function(e){var t=(0,a.Z)(i);t[l].key=e.target.value,o(t),f("key-".concat(l.toString()))},index:l,error:s["key-".concat(l.toString())]||""},"csv-key-".concat(l.toString())),(0,x.jsx)(c.Z,{id:"val-".concat(n.replace(/ /g,""),"-").concat(l.toString()),label:"",placeholder:"Value",name:"val-".concat(l.toString()),value:i[l].value,onChange:function(e){var t=(0,a.Z)(i);t[l].value=e.target.value,o(t),f("val-".concat(l.toString()))},index:l,error:s["val-".concat(l.toString())]||""},"csv-val-".concat(l.toString())),(0,x.jsx)(u.Z,{title:"Add ".concat(n),"aria-label":"addlabel",children:(0,x.jsx)(d.Z,{id:"add-".concat(n.replace(/ /g,""),"-").concat(l.toString()),size:"small",onClick:function(){var e=(0,a.Z)(i);e.push({key:"",value:""}),o(e)},children:(0,x.jsx)(m.Z,{})})}),(0,x.jsx)(u.Z,{title:"Remove","aria-label":"removeLabel",children:(0,x.jsx)(d.Z,{id:"remove-".concat(n.replace(/ /g,""),"-").concat(l.toString()),size:"small",style:{marginLeft:16},onClick:function(){if(1===i.length&&o([{key:"",value:""}]),i.length>1){var e=(0,a.Z)(i);e.splice(l,1),o(e)}},children:(0,x.jsx)(g.Z,{})})})]})})},"keyvalue-".concat(l.toString()))}));return(0,x.jsx)(r.Fragment,{children:Z})}))},18158:function(e,t,n){var a=n(72791),i=n(21435),r=n(37516),o=n(90673),s=n(61889),l=n(78687),c=n(11135),u=n(25787),d=n(80184);t.Z=(0,u.Z)((function(e){return(0,c.Z)({configSectionItem:{marginRight:15,marginBottom:15,"& .multiContainer":{border:"1px solid red"}}})}))((function(e){var t=e.classes,n=e.runAsGroup,c=e.runAsUser,u=e.fsGroup,m=e.fsGroupChangePolicy,g=e.runAsNonRoot,v=e.setRunAsUser,h=e.setRunAsGroup,p=e.setFSGroup,x=e.setRunAsNonRoot,f=e.setFSGroupChangePolicy,Z=(0,l.I0)();return(0,d.jsx)(a.Fragment,{children:(0,d.jsxs)("fieldset",{className:"".concat(t.fieldGroup," ").concat(t.fieldSpaceTop," "),children:[(0,d.jsx)("legend",{className:t.descriptionText,children:"Security Context"}),(0,d.jsx)(s.ZP,{item:!0,xs:12,children:(0,d.jsxs)("div",{className:"".concat(t.multiContainerStackNarrow," "),children:[(0,d.jsx)("div",{className:t.configSectionItem,children:(0,d.jsx)(i.Z,{type:"number",id:"securityContext_runAsUser",name:"securityContext_runAsUser",onChange:function(e){Z(v(e.target.value))},label:"Run As User",value:c,required:!0,min:"0"})}),(0,d.jsx)("div",{className:t.configSectionItem,children:(0,d.jsx)(i.Z,{type:"number",id:"securityContext_runAsGroup",name:"securityContext_runAsGroup",onChange:function(e){Z(h(e.target.value))},label:"Run As Group",value:n,required:!0,min:"0"})})]})}),(0,d.jsx)(s.ZP,{item:!0,xs:12,children:(0,d.jsxs)("div",{className:"".concat(t.multiContainerStackNarrow," "),children:[(0,d.jsx)("div",{className:t.configSectionItem,children:(0,d.jsx)(i.Z,{type:"number",id:"securityContext_fsGroup",name:"securityContext_fsGroup",onChange:function(e){Z(p(e.target.value))},label:"FsGroup",value:u,required:!0,min:"0"})}),(0,d.jsx)("div",{className:t.configSectionItem,children:(0,d.jsx)(o.Z,{label:"FsGroupChangePolicy",id:"securityContext_fsGroupChangePolicy",name:"securityContext_fsGroupChangePolicy",onChange:function(e){Z(f(e.target.value))},value:m,options:[{label:"Always",value:"Always"},{label:"OnRootMismatch",value:"OnRootMismatch"}]})})]})}),(0,d.jsx)(s.ZP,{item:!0,xs:12,children:(0,d.jsx)("div",{className:t.multiContainer,children:(0,d.jsx)(r.Z,{value:"SecurityContextRunAsNonRoot",id:"securityContext_runAsNonRoot",name:"securityContext_runAsNonRoot",checked:g,onChange:function(){Z(x(!g))},label:"Do not run as Root"})})})]})})}))},42419:function(e,t,n){var a=n(64836);t.Z=void 0;var i=a(n(45649)),r=n(80184),o=(0,i.default)((0,r.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");t.Z=o},27247:function(e,t,n){var a=n(64836);t.Z=void 0;var i=a(n(45649)),r=n(80184),o=(0,i.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");t.Z=o}}]);
//# sourceMappingURL=5367.23c3580e.chunk.js.map
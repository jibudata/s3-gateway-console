"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[7021],{37021:function(e,a,n){n.r(a);var t=n(93433),i=n(29439),r=n(1413),s=n(72791),o=n(60364),l=n(51691),c=n(20890),d=n(36151),u=n(20068),m=n(13400),h=n(61889),v=n(11135),p=n(25787),f=n(20165),x=n(3579),_=n(23814),Z=n(84741),g=n(40968),j=n(15900),D=n(87995),b=n(81551),N=n(72401),S=n(83679),I=n(21435),y=n(37516),k=n(2148),R=n(81207),A=n(42419),C=n(27247),w=n(50896),F=n(80184),L=(0,o.$j)((function(e){return{loadingTenant:e.tenants.loadingTenant,selectedTenant:e.tenants.currentTenant,tenant:e.tenants.tenantInfo}}),null);a.default=(0,p.Z)((function(e){return(0,v.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)({adUserDnRows:{display:"flex",marginBottom:10},buttonTray:{marginLeft:10,display:"flex",height:38,"& button":{background:"#EAEAEA"}},overlayAction:{marginLeft:10,"& svg":{maxWidth:15,maxHeight:15},"& button":{background:"#EAEAEA"}}},_.oZ),_.bK),{},{loaderAlign:{textAlign:"center"},bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},fileItem:{marginRight:10,display:"flex","& div label":{minWidth:50},"@media (max-width: 900px)":{flexFlow:"column"}}},(0,_.Bz)(e.spacing(4))),_.QV),_.DF),_.oO),_.AK))}))(L((function(e){var a=e.classes,n=(0,b.TL)(),r=(0,o.v9)((function(e){return e.tenants.tenantInfo})),v=(0,o.v9)((function(e){return e.tenants.loadingTenant})),p=(0,s.useState)(!1),_=(0,i.Z)(p,2),L=_[0],P=_[1],T=(0,s.useState)(!1),U=(0,i.Z)(T,2),O=U[0],B=U[1],z=(0,s.useState)("Built-in"),q=(0,i.Z)(z,2),G=q[0],E=q[1],K=(0,s.useState)(""),M=(0,i.Z)(K,2),V=M[0],H=M[1],W=(0,s.useState)(""),Q=(0,i.Z)(W,2),$=Q[0],J=Q[1],X=(0,s.useState)(""),Y=(0,i.Z)(X,2),ee=Y[0],ae=Y[1],ne=(0,s.useState)(!1),te=(0,i.Z)(ne,2),ie=te[0],re=te[1],se=(0,s.useState)(""),oe=(0,i.Z)(se,2),le=oe[0],ce=oe[1],de=(0,s.useState)(""),ue=(0,i.Z)(de,2),me=ue[0],he=ue[1],ve=(0,s.useState)(""),pe=(0,i.Z)(ve,2),fe=pe[0],xe=pe[1],_e=(0,s.useState)(""),Ze=(0,i.Z)(_e,2),ge=Ze[0],je=Ze[1],De=(0,s.useState)(""),be=(0,i.Z)(De,2),Ne=be[0],Se=be[1],Ie=(0,s.useState)(""),ye=(0,i.Z)(Ie,2),ke=ye[0],Re=ye[1],Ae=(0,s.useState)(!1),Ce=(0,i.Z)(Ae,2),we=Ce[0],Fe=Ce[1],Le=(0,s.useState)(""),Pe=(0,i.Z)(Le,2),Te=Pe[0],Ue=Pe[1],Oe=(0,s.useState)(""),Be=(0,i.Z)(Oe,2),ze=Be[0],qe=Be[1],Ge=(0,s.useState)(""),Ee=(0,i.Z)(Ge,2),Ke=Ee[0],Me=Ee[1],Ve=(0,s.useState)(""),He=(0,i.Z)(Ve,2),We=He[0],Qe=He[1],$e=(0,s.useState)(!1),Je=(0,i.Z)($e,2),Xe=Je[0],Ye=Je[1],ea=(0,s.useState)(!1),aa=(0,i.Z)(ea,2),na=aa[0],ta=aa[1],ia=(0,s.useState)(!1),ra=(0,i.Z)(ia,2),sa=ra[0],oa=ra[1],la=(0,s.useState)([""]),ca=(0,i.Z)(la,2),da=ca[0],ua=ca[1],ma=(0,s.useState)([""]),ha=(0,i.Z)(ma,2),va=ha[0],pa=ha[1],fa=(0,s.useState)({}),xa=(0,i.Z)(fa,2),_a=xa[0],Za=xa[1],ga=function(e){Za((0,Z.h)(_a,e))},ja=(0,s.useState)(!1),Da=(0,i.Z)(ja,2),ba=Da[0],Na=Da[1];(0,s.useEffect)((function(){var e=[];"OpenID"===G&&(e=[].concat((0,t.Z)(e),[{fieldKey:"openID_CONFIGURATION_URL",required:!0,value:V},{fieldKey:"openID_clientID",required:!0,value:$},{fieldKey:"openID_secretID",required:!0,value:ee},{fieldKey:"openID_claimName",required:!0,value:me}])),"AD"===G&&(e=[].concat((0,t.Z)(e),[{fieldKey:"AD_URL",required:!0,value:ge},{fieldKey:"ad_lookupBindDN",required:!0,value:Ne}]));var a=(0,g.R)(e);Na(0===Object.keys(a).length),Za(a)}),[G,V,$,ee,me,ge,Ne]);var Sa=(0,s.useCallback)((function(){R.Z.invoke("GET","/api/v1/namespaces/".concat(null===r||void 0===r?void 0:r.namespace,"/tenants/").concat(null===r||void 0===r?void 0:r.name,"/identity-provider")).then((function(e){e&&(e.oidc?(E("OpenID"),H(e.oidc.configuration_url),J(e.oidc.client_id),ae(e.oidc.secret_id),ce(e.oidc.callback_url),he(e.oidc.claim_name),xe(e.oidc.scopes)):e.active_directory&&(E("AD"),je(e.active_directory.url),Se(e.active_directory.lookup_bind_dn),Re(e.active_directory.lookup_bind_password),Ue(e.active_directory.user_dn_search_base_dn),qe(e.active_directory.user_dn_search_filter),Me(e.active_directory.group_search_base_dn),Qe(e.active_directory.group_search_filter),Ye(e.active_directory.skip_tls_verification),ta(e.active_directory.server_insecure),oa(e.active_directory.server_start_tls)))})).catch((function(e){n((0,D.Ih)(e))}))}),[r,n]);(0,s.useEffect)((function(){r&&Sa()}),[r,Sa]);return(0,F.jsxs)(s.Fragment,{children:[(0,F.jsx)(k.Z,{title:"Save and Restart",confirmText:"Restart",cancelText:"Cancel",titleIcon:(0,F.jsx)(j.EjK,{}),isLoading:L,onClose:function(){return B(!1)},isOpen:O,onConfirm:function(){P(!0);var e={};switch(G){case"AD":e.active_directory={url:ge,lookup_bind_dn:Ne,lookup_bind_password:ke,user_dn_search_base_dn:Te,user_dn_search_filter:ze,group_search_base_dn:Ke,group_search_filter:We,skip_tls_verification:Xe,server_insecure:na,server_start_tls:sa};break;case"OpenID":e.oidc={configuration_url:V,client_id:$,secret_id:ee,callback_url:le,claim_name:me,scopes:fe}}R.Z.invoke("POST","/api/v1/namespaces/".concat(null===r||void 0===r?void 0:r.namespace,"/tenants/").concat(null===r||void 0===r?void 0:r.name,"/identity-provider"),e).then((function(){P(!1),B(!1),Sa()})).catch((function(e){n((0,D.Ih)(e)),P(!1)}))},confirmationContent:(0,F.jsx)(l.Z,{children:"Are you sure you want to save the changes and restart the service?"})}),v?(0,F.jsx)("div",{className:a.loaderAlign,children:(0,F.jsx)(N.Z,{})}):(0,F.jsxs)(s.Fragment,{children:[(0,F.jsxs)(h.ZP,{item:!0,xs:12,children:[(0,F.jsx)("h1",{className:a.sectionTitle,children:"Identity Provider"}),(0,F.jsx)("hr",{className:a.hrClass})]}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.protocolRadioOptions,children:(0,F.jsx)(S.Z,{currentSelection:G,id:"idp-options",name:"idp-options",label:"Protocol",onChange:function(e){E(e.target.value)},selectorOptions:[{label:"Built-in",value:"Built-in"},{label:"OpenID",value:"OpenID"},{label:"Active Directory",value:"AD"}]})}),"OpenID"===G&&(0,F.jsxs)(s.Fragment,{children:[(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"openID_CONFIGURATION_URL",name:"openID_CONFIGURATION_URL",onChange:function(e){H(e.target.value),ga("openID_CONFIGURATION_URL")},label:"Configuration URL",value:V,placeholder:"https://your-identity-provider.com/.well-known/openid-configuration",error:_a.openID_CONFIGURATION_URL||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"openID_clientID",name:"openID_clientID",onChange:function(e){J(e.target.value),ga("openID_clientID")},label:"Client ID",value:$,error:_a.openID_clientID||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{type:ie?"text":"password",id:"openID_secretID",name:"openID_secretID",onChange:function(e){ae(e.target.value),ga("openID_secretID")},label:"Secret ID",value:ee,error:_a.openID_secretID||"",required:!0,overlayIcon:ie?(0,F.jsx)(f.Z,{}):(0,F.jsx)(x.Z,{}),overlayAction:function(){return re(!ie)}})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"openID_callbackURL",name:"openID_callbackURL",onChange:function(e){ce(e.target.value),ga("openID_callbackURL")},label:"Callback URL",value:le,placeholder:"https://your-console-endpoint:9443/oauth_callback",error:_a.openID_callbackURL||""})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"openID_claimName",name:"openID_claimName",onChange:function(e){he(e.target.value),ga("openID_claimName")},label:"Claim Name",value:me,error:_a.openID_claimName||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"openID_scopes",name:"openID_scopes",onChange:function(e){xe(e.target.value),ga("openID_scopes")},label:"Scopes",value:fe})})]}),"AD"===G&&(0,F.jsxs)(s.Fragment,{children:[(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"AD_URL",name:"AD_URL",onChange:function(e){je(e.target.value),ga("AD_URL")},label:"LDAP Server Address",value:ge,placeholder:"ldap-server:636",error:_a.AD_URL||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(y.Z,{value:"ad_skipTLS",id:"ad_skipTLS",name:"ad_skipTLS",checked:Xe,onChange:function(e){var a=e.target.checked;Ye(a)},label:"Skip TLS Verification"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(y.Z,{value:"ad_serverInsecure",id:"ad_serverInsecure",name:"ad_serverInsecure",checked:na,onChange:function(e){var a=e.target.checked;ta(a)},label:"Server Insecure"})}),na?(0,F.jsxs)(h.ZP,{item:!0,xs:12,children:[(0,F.jsx)(c.Z,{className:a.error,variant:"caption",display:"block",gutterBottom:!0,children:"Warning: All traffic with Active Directory will be unencrypted"}),(0,F.jsx)("br",{})]}):null,(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(y.Z,{value:"ad_serverStartTLS",id:"ad_serverStartTLS",name:"ad_serverStartTLS",checked:sa,onChange:function(e){var a=e.target.checked;oa(a)},label:"Start TLS connection to AD/LDAP server"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"ad_lookupBindDN",name:"ad_lookupBindDN",onChange:function(e){Se(e.target.value),ga("ad_lookupBindDN")},label:"Lookup Bind DN",value:Ne,placeholder:"cn=admin,dc=min,dc=io",error:_a.ad_lookupBindDN||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{type:we?"text":"password",id:"ad_lookupBindPassword",name:"ad_lookupBindPassword",onChange:function(e){Re(e.target.value)},label:"Lookup Bind Password",value:ke,placeholder:"admin",overlayIcon:we?(0,F.jsx)(f.Z,{}):(0,F.jsx)(x.Z,{}),overlayAction:function(){return Fe(!we)}})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"ad_userDNSearchBaseDN",name:"ad_userDNSearchBaseDN",onChange:function(e){Ue(e.target.value)},label:"User DN Search Base DN",value:Te,placeholder:"dc=min,dc=io"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"ad_userDNSearchFilter",name:"ad_userDNSearchFilter",onChange:function(e){qe(e.target.value)},label:"User DN Search Filter",value:ze,placeholder:"(sAMAcountName=%s)"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"ad_groupSearchBaseDN",name:"ad_groupSearchBaseDN",onChange:function(e){Me(e.target.value)},label:"Group Search Base DN",value:Ke,placeholder:"ou=hwengg,dc=min,dc=io;ou=swengg,dc=min,dc=io"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,F.jsx)(I.Z,{id:"ad_groupSearchFilter",name:"ad_groupSearchFilter",onChange:function(e){Qe(e.target.value)},label:"Group Search Filter",value:We,placeholder:"(&(objectclass=groupOfNames)(member=%s))"})})]}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.buttonContainer,children:(0,F.jsx)(d.Z,{type:"submit",variant:"contained",color:"primary",disabled:!ba||L,onClick:function(){return B(!0)},children:"Save"})}),"AD"===G&&(0,F.jsxs)(s.Fragment,{children:[(0,F.jsx)(w.Z,{children:"User & Group management"}),(0,F.jsx)("br",{}),(0,F.jsxs)("fieldset",{className:a.fieldGroup,children:[(0,F.jsx)("legend",{className:a.descriptionText,children:"List of user DNs (Distinguished Names) to be added as Tenant Administrators"}),(0,F.jsx)(h.ZP,{item:!0,xs:12,children:da.map((function(e,n){return(0,F.jsx)(s.Fragment,{children:(0,F.jsxs)("div",{className:a.adUserDnRows,children:[(0,F.jsx)(I.Z,{id:"ad-userdn-".concat(n.toString()),label:"",placeholder:"",name:"ad-userdn-".concat(n.toString()),value:da[n],onChange:function(e){ua(da.map((function(a,t){return t===n?e.target.value:a})))},index:n,error:_a["ad-userdn-".concat(n.toString())]||""},"csv-ad-userdn-".concat(n.toString())),(0,F.jsxs)("div",{className:a.buttonTray,children:[(0,F.jsx)(u.Z,{title:"Add User","aria-label":"add",children:(0,F.jsx)(m.Z,{size:"small",onClick:function(){ua([].concat((0,t.Z)(da),[""]))},children:(0,F.jsx)(A.Z,{})})}),(0,F.jsx)(u.Z,{title:"Remove","aria-label":"add",children:(0,F.jsx)(m.Z,{size:"small",style:{marginLeft:16},onClick:function(){da.length>1&&ua(da.filter((function(e,a){return a!==n})))},children:(0,F.jsx)(C.Z,{})})})]})]})},"identityField-".concat(n.toString()))}))})]}),(0,F.jsxs)("fieldset",{className:a.fieldGroup,children:[(0,F.jsx)("legend",{className:a.descriptionText,children:"List of group DNs (Distinguished Names) to be added as Tenant Administrators"}),(0,F.jsx)(h.ZP,{item:!0,xs:12,children:va.map((function(e,n){return(0,F.jsx)(s.Fragment,{children:(0,F.jsxs)("div",{className:a.adUserDnRows,children:[(0,F.jsx)(I.Z,{id:"ad-groupdn-".concat(n.toString()),label:"",placeholder:"",name:"ad-groupdn-".concat(n.toString()),value:va[n],onChange:function(e){pa(va.map((function(a,t){return t===n?e.target.value:a})))},index:n,error:_a["ad-groupdn-".concat(n.toString())]||""},"csv-ad-groupdn-".concat(n.toString())),(0,F.jsxs)("div",{className:a.buttonTray,children:[(0,F.jsx)(u.Z,{title:"Add Group","aria-label":"add",children:(0,F.jsx)(m.Z,{size:"small",onClick:function(){pa([].concat((0,t.Z)(va),[""]))},children:(0,F.jsx)(A.Z,{})})}),(0,F.jsx)(u.Z,{title:"Remove","aria-label":"add",children:(0,F.jsx)(m.Z,{size:"small",style:{marginLeft:16},onClick:function(){va.length>1&&pa(va.filter((function(e,a){return a!==n})))},children:(0,F.jsx)(C.Z,{})})})]})]})},"identityField-".concat(n.toString()))}))})]}),(0,F.jsx)("br",{}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:a.buttonContainer,children:(0,F.jsx)(d.Z,{type:"submit",variant:"contained",color:"primary",disabled:!ba||L,onClick:function(){return function(){P(!0);var e={};"AD"===G&&(e={user_dns:da.filter((function(e){return""!==e.trim()})),group_dns:va.filter((function(e){return""!==e.trim()}))});R.Z.invoke("POST","/api/v1/namespaces/".concat(null===r||void 0===r?void 0:r.namespace,"/tenants/").concat(null===r||void 0===r?void 0:r.name,"/set-administrators"),e).then((function(){P(!1),pa([""]),ua([""]),Sa(),n((0,D.y1)("Administrators added successfully"))})).catch((function(e){n((0,D.Ih)(e)),P(!1)}))}()},children:"Add additional DNs"})})]})]})]})})))},42419:function(e,a,n){var t=n(95318);a.Z=void 0;var i=t(n(45649)),r=n(80184),s=(0,i.default)((0,r.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");a.Z=s},27247:function(e,a,n){var t=n(95318);a.Z=void 0;var i=t(n(45649)),r=n(80184),s=(0,i.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");a.Z=s},3579:function(e,a,n){var t=n(95318);a.Z=void 0;var i=t(n(45649)),r=n(80184),s=(0,i.default)((0,r.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"RemoveRedEye");a.Z=s},20165:function(e,a,n){var t=n(95318);a.Z=void 0;var i=t(n(45649)),r=n(80184),s=(0,i.default)((0,r.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff");a.Z=s}}]);
//# sourceMappingURL=7021.2df7e2e0.chunk.js.map
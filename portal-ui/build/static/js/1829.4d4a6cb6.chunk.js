(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[1829],{47986:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});n(72791);var r=n(29945),o=n(80184);const i=e=>{let{iconComponent:t,entity:n}=e;return(0,o.jsx)(r.rjZ,{container:!0,children:(0,o.jsx)(r.rjZ,{item:!0,xs:12,children:(0,o.jsx)(r.KfX,{title:"".concat(n," not available"),iconComponent:t,help:(0,o.jsxs)(r.xuv,{sx:{fontSize:"14px",["@media (max-width: ".concat(r.Egj.sm,"px)")]:{display:"flex",flexFlow:"column"}},children:[(0,o.jsx)("span",{children:"This feature is not available for a single-disk setup.\xa0"}),(0,o.jsxs)("span",{children:["Please deploy a server in"," ",(0,o.jsx)("a",{href:"https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-multi-node-multi-drive.html?ref=con",target:"_blank",rel:"noopener",children:"Distributed Mode"})," ","to use this feature."]})]})})})})}},61829:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>E});var r=n(72791),o=n(78687),i=n(95087),a=n(29945),s=n(19913),l=n(38725),c=n(82839),u=n(90466),h=n(12891),d=n(71827),f=n(27281),b=n(23782),p=n(31776),m=n(82342),x=n(26824),g=n(45248),y=n(23814),v=n(56087),j=n(87995),w=n(38442),S=n(44690),C=n(47986),O=n(79844),k=n(99670),H=n(80184);const E=()=>{const e=(0,o.v9)(j.N5),[t,n]=(0,r.useState)(!1),[E,A]=(0,r.useState)(""),[D,T]=(0,r.useState)([]),[B,P]=(0,r.useState)(""),[N,R]=(0,r.useState)(!1),[Z,_]=(0,r.useState)(!1),[G,z]=(0,r.useState)(!1),[W,I]=(0,r.useState)({beforeHeal:[0,0,0,0],afterHeal:[0,0,0,0],objectsHealed:0,objectsScanned:0,healDuration:0,sizeScanned:""});(0,r.useEffect)((()=>{p.h.buckets.listBuckets().then((e=>{let t=[];e.data.buckets&&(t=e.data.buckets),T(t)})).catch((e=>{console.error((0,m.g)(e.error))}))}),[]),(0,r.useEffect)((()=>{Z&&z(!1)}),[Z]),(0,r.useEffect)((()=>{G&&_(!1)}),[G]);const M=e=>[e.Green,e.Yellow,e.Red,e.Grey];(0,r.useEffect)((()=>{if(t){const e={Green:0,Yellow:0,Red:0,Grey:0},t={Green:0,Yellow:0,Red:0,Grey:0},r=new URL(window.location.toString()),o=!1?"9090":r.port,a=new URL(document.baseURI).pathname,s=(0,x.x2)(r.protocol),l=new i.w3cwebsocket("".concat(s,"://").concat(r.hostname,":").concat(o).concat(a,"ws/heal/").concat(E,"?prefix=").concat(B,"&recursive=").concat(N,"&force-start=").concat(Z,"&force-stop=").concat(G));if(null!==l)return l.onopen=()=>{console.log("WebSocket Client Connected"),l.send("ok")},l.onmessage=n=>{let r=JSON.parse(n.data.toString());for(const[e,o]of Object.entries(r.healthAfterCols))t[e]=100*o/r.itemsScanned;for(const[t,o]of Object.entries(r.healthBeforeCols))e[t]=100*o/r.itemsScanned;I({beforeHeal:M(e),afterHeal:M(t),objectsHealed:r.objectsHealed,objectsScanned:r.objectsScanned,healDuration:r.healDuration,sizeScanned:(0,g.ae)(r.bytesScanned.toString())})},l.onclose=()=>{n(!1),console.log("connection closed by server")},()=>{l.close(1e3),console.log("closing websockets")}}}),[t,E,Z,G,B,N]);let U=[{name:"Green",ah:W.afterHeal[0],bh:W.beforeHeal[0],amt:100},{name:"Yellow",ah:W.afterHeal[1],bh:W.beforeHeal[1],amt:100},{name:"Red",ah:W.afterHeal[2],bh:W.beforeHeal[2],amt:100},{name:"Grey",ah:W.afterHeal[3],bh:W.beforeHeal[3],amt:100}];const L=D.map((e=>({label:e.name,value:e.name}))),F=(0,S.TL)();return(0,r.useEffect)((()=>{F((0,j.Sc)("heal"))}),[]),(0,H.jsxs)(r.Fragment,{children:[(0,H.jsx)(O.Z,{label:"Drives",actions:(0,H.jsx)(k.Z,{})}),(0,H.jsx)(a.Xgh,{children:e?(0,H.jsxs)(w.s,{scopes:[v.Ft.ADMIN_HEAL],resource:v.C3,children:[(0,H.jsxs)(a.xuv,{withBorders:!0,children:[(0,H.jsxs)(a.xuv,{sx:{display:"flex",alignItems:"center",marginBottom:15,gap:15},children:[(0,H.jsxs)(a.xuv,{sx:{flexGrow:1,width:"100%"},children:[(0,H.jsx)(a.AZs,{children:"Bucket"}),(0,H.jsx)(a.PhF,{id:"bucket-name",name:"bucket-name",value:E,onChange:e=>{A(e)},options:L,placeholder:"Select Bucket"})]}),(0,H.jsxs)(a.xuv,{sx:{flexGrow:1,width:"100%"},children:[(0,H.jsx)(a.AZs,{children:"Prefix"}),(0,H.jsx)(a.Wzg,{id:"prefix-resource",disabled:!1,onChange:e=>{P(e.target.value)}})]})]}),(0,H.jsxs)(a.xuv,{sx:{display:"flex",gap:20},children:[(0,H.jsx)(a.xuv,{children:(0,H.jsx)(a.XZJ,{name:"recursive",id:"recursive",value:"recursive",checked:N,onChange:()=>{R(!N)},disabled:!1,label:"Recursive"})}),(0,H.jsx)(a.xuv,{children:(0,H.jsx)(a.XZJ,{name:"forceStart",id:"forceStart",value:"forceStart",checked:Z,onChange:()=>{_(!Z)},disabled:!1,label:"Force Start"})}),(0,H.jsx)(a.xuv,{children:(0,H.jsx)(a.XZJ,{name:"forceStop",id:"forceStop",value:"forceStop",checked:G,onChange:()=>{z(!G)},disabled:!1,label:"Force Stop"})})]}),(0,H.jsx)(a.xuv,{sx:y.ID.modalButtonBar,children:(0,H.jsx)(a.zxk,{id:"start-heal",type:"submit",variant:"callAction",color:"primary",disabled:t,onClick:()=>n(!0),label:"Start"})})]}),(0,H.jsxs)(a.xuv,{withBorders:!0,sx:{marginTop:15,'& ul li:not([class*="Mui"])::before':{listStyle:"none",content:"' '"}},children:[(0,H.jsx)(s.h,{width:"90%",height:400,children:(0,H.jsxs)(l.v,{width:600,height:400,data:U,margin:{top:5,right:30,left:20,bottom:5},children:[(0,H.jsx)(c.q,{strokeDasharray:"3 3"}),(0,H.jsx)(u.K,{dataKey:"name"}),(0,H.jsx)(h.B,{}),(0,H.jsx)(d.u,{}),(0,H.jsx)(f.D,{verticalAlign:"top",layout:"horizontal",className:"noLi"}),(0,H.jsx)(b.$,{dataKey:"ah",name:"After Healing",fill:"#2781B060",stroke:"#2781B0"}),(0,H.jsx)(b.$,{dataKey:"bh",name:"Before Healing",fill:"#C83B5160",stroke:"#C83B51"})]})}),(0,H.jsxs)(a.rjZ,{item:!0,xs:12,sx:{marginTop:20,display:"flex",flexDirection:"row",justifyContent:"space-between","& .scanData":{}},children:[(0,H.jsxs)(a.xuv,{className:"scanData",children:[(0,H.jsx)("strong",{children:"Size scanned:"})," ",W.sizeScanned]}),(0,H.jsxs)(a.xuv,{className:"scanData",children:[(0,H.jsx)("strong",{children:"Objects healed:"})," ",W.objectsHealed," /"," ",W.objectsScanned]}),(0,H.jsxs)(a.xuv,{className:"scanData",children:[(0,H.jsx)("strong",{children:"Healing time:"})," ",W.healDuration,"s"]})]})]})]}):(0,H.jsx)(C.Z,{entity:"Heal",iconComponent:(0,H.jsx)(a.lnI,{})})})]})}},94210:e=>{var t=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},38725:(e,t,n)=>{"use strict";n.d(t,{v:()=>l});var r=n(83667),o=n(23782),i=n(90466),a=n(12891),s=n(93137),l=(0,r.z)({chartName:"BarChart",GraphicalChild:o.$,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:i.K},{axisType:"yAxis",AxisComp:a.B}],formatAxisMap:s.t9})},19913:(e,t,n)=>{"use strict";n.d(t,{h:()=>x});var r=n(63733),o=n(72791),i=n(33038),a=n.n(i),s=n(57441),l=n(70587),c=n(15303),u=n(23031);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===h(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=(0,o.forwardRef)((function(e,t){var n=e.aspect,i=e.initialDimension,h=void 0===i?{width:-1,height:-1}:i,d=e.width,b=void 0===d?"100%":d,m=e.height,x=void 0===m?"100%":m,g=e.minWidth,y=void 0===g?0:g,v=e.minHeight,j=e.maxHeight,w=e.children,S=e.debounce,C=void 0===S?0:S,O=e.id,k=e.className,H=e.onResize,E=e.style,A=void 0===E?{}:E,D=(0,o.useRef)(null),T=(0,o.useRef)();T.current=H,(0,o.useImperativeHandle)(t,(function(){return D}));var B=p((0,o.useState)({containerWidth:h.width,containerHeight:h.height}),2),P=B[0],N=B[1],R=(0,o.useCallback)((function(e,t){N((function(n){var r=Math.round(e),o=Math.round(t);return n.containerWidth===r&&n.containerHeight===o?n:{containerWidth:r,containerHeight:o}}))}),[]);(0,o.useEffect)((function(){var e=function(e){var t,n=e[0].contentRect,r=n.width,o=n.height;R(r,o),null===(t=T.current)||void 0===t||t.call(T,r,o)};C>0&&(e=a()(e,C,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),n=D.current.getBoundingClientRect(),r=n.width,o=n.height;return R(r,o),t.observe(D.current),function(){t.disconnect()}}),[R,C]);var Z=(0,o.useMemo)((function(){var e=P.containerWidth,t=P.containerHeight;if(e<0||t<0)return null;(0,c.Z)((0,l.hU)(b)||(0,l.hU)(x),"The width(%s) and height(%s) are both fixed numbers,\n       maybe you don't need to use a ResponsiveContainer.",b,x),(0,c.Z)(!n||n>0,"The aspect(%s) must be greater than zero.",n);var r=(0,l.hU)(b)?e:b,i=(0,l.hU)(x)?t:x;n&&n>0&&(r?i=r/n:i&&(r=i*n),j&&i>j&&(i=j)),(0,c.Z)(r>0||i>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",r,i,b,x,y,v,n);var a=!Array.isArray(w)&&(0,s.isElement)(w)&&(0,u.Gf)(w.type).endsWith("Chart");return o.Children.map(w,(function(e){return(0,s.isElement)(e)?(0,o.cloneElement)(e,f({width:r,height:i},a?{style:f({height:"100%",width:"100%",maxHeight:i,maxWidth:r},e.props.style)}:{})):e}))}),[n,w,x,j,v,y,P,b]);return o.createElement("div",{id:O?"".concat(O):void 0,className:(0,r.Z)("recharts-responsive-container",k),style:f(f({},A),{},{width:b,height:x,minWidth:y,minHeight:v,maxHeight:j}),ref:D},Z)}))},95087:(e,t,n)=>{var r;if("object"===typeof globalThis)r=globalThis;else try{r=n(94210)}catch(s){}finally{if(r||"undefined"===typeof window||(r=window),!r)throw new Error("Could not determine global this")}var o=r.WebSocket||r.MozWebSocket,i=n(51496);function a(e,t){return t?new o(e,t):new o(e)}o&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(a,e,{get:function(){return o[e]}})})),e.exports={w3cwebsocket:o?a:null,version:i}},51496:(e,t,n)=>{e.exports=n(19794).version},19794:e=>{"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=1829.4d4a6cb6.chunk.js.map
(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[6272],{76272:function(e,t,n){"use strict";n.r(t);var o=n(29439),c=n(72791),r=n(95087),i=n(78687),a=n(29945),l=n(81551),s=n(45248),u=n(26824),f=n(10679),d=n(87995),h=n(81207),b=n(47974),x=n(99670),p=n(80184);t.default=function(){var e=(0,l.TL)(),t=(0,i.v9)((function(e){return e.watch.messages})),n=(0,c.useState)(!1),w=(0,o.Z)(n,2),g=w[0],m=w[1],v=(0,c.useState)("Select Bucket"),j=(0,o.Z)(v,2),k=j[0],y=j[1],S=(0,c.useState)(""),C=(0,o.Z)(S,2),_=C[0],T=C[1],Z=(0,c.useState)(""),E=(0,o.Z)(Z,2),O=E[0],z=E[1],N=(0,c.useState)([]),P=(0,o.Z)(N,2),G=P[0],I=P[1];(0,c.useEffect)((function(){h.Z.invoke("GET","/api/v1/buckets").then((function(e){var t=[];null!==e.buckets&&(t=e.buckets),I(t)})).catch((function(e){console.error(e)}))}),[]),(0,c.useEffect)((function(){if(e((0,f.uE)()),g&&G.some((function(e){return e.name===k}))){var t=new URL(window.location.toString()),n=t.port,o=new URL(document.baseURI).pathname,c=(0,u.x2)(t.protocol),i=new r.w3cwebsocket("".concat(c,"://").concat(t.hostname,":").concat(n).concat(o,"ws/watch/").concat(k,"?prefix=").concat(_,"&suffix=").concat(O)),a=null;if(null!==i)return i.onopen=function(){console.log("WebSocket Client Connected"),i.send("ok"),a=setInterval((function(){i.send("ok")}),1e4)},i.onmessage=function(t){var n=JSON.parse(t.data.toString());n.Time=new Date(n.Time.toString()),n.key=Math.random(),e((0,f.pG)(n))},i.onclose=function(){clearInterval(a),console.log("connection closed by server"),m(!1)},function(){i.close(1e3),clearInterval(a),console.log("closing websockets")}}else m(!1)}),[e,g,G,k,_,O]);var W=G.map((function(e){return{label:e.name,value:e.name}}));(0,c.useEffect)((function(){e((0,d.Sc)("watch"))}),[]);var F=W.map((function(e){return{label:e.label,value:e.value}}));return(0,p.jsxs)(c.Fragment,{children:[(0,p.jsx)(b.Z,{label:"Watch",actions:(0,p.jsx)(x.Z,{})}),(0,p.jsx)(a.Xgh,{children:(0,p.jsxs)(a.rjZ,{container:!0,children:[(0,p.jsxs)(a.rjZ,{item:!0,xs:12,sx:{display:"flex",gap:10,marginBottom:15,alignItems:"center"},children:[(0,p.jsxs)(a.xuv,{sx:{flexGrow:1},children:[(0,p.jsx)(a.AZs,{children:"Bucket"}),(0,p.jsx)(a.PhF,{id:"bucket-name",name:"bucket-name",value:k,onChange:function(e){y(e)},disabled:g,options:F,placeholder:"Select Bucket"})]}),(0,p.jsxs)(a.xuv,{sx:{flexGrow:1},children:[(0,p.jsx)(a.AZs,{children:"Prefix"}),(0,p.jsx)(a.Wzg,{id:"prefix-resource",disabled:g,onChange:function(e){T(e.target.value)}})]}),(0,p.jsxs)(a.xuv,{sx:{flexGrow:1},children:[(0,p.jsx)(a.AZs,{children:"Suffix"}),(0,p.jsx)(a.Wzg,{id:"suffix-resource",disabled:g,onChange:function(e){z(e.target.value)}})]}),(0,p.jsx)(a.xuv,{sx:{alignSelf:"flex-end",paddingBottom:4},children:g?(0,p.jsx)(a.zxk,{id:"stop-watch",type:"submit",variant:"callAction",onClick:function(){return m(!1)},label:"Stop"}):(0,p.jsx)(a.zxk,{id:"start-watch",type:"submit",variant:"callAction",onClick:function(){return m(!0)},label:"Start"})})]}),(0,p.jsx)(a.rjZ,{item:!0,xs:12,children:(0,p.jsx)(a.wQF,{columns:[{label:"Time",elementKey:"Time",renderFunction:s.zk},{label:"Size",elementKey:"Size",renderFunction:s.ae},{label:"Type",elementKey:"Type"},{label:"Path",elementKey:"Path"}],records:t,entityName:"Watch",customEmptyMessage:"No Changes at this time",idField:"watch_table",isLoading:!1,customPaperHeight:"calc(100vh - 270px)"})})]})})]})}},26824:function(e,t,n){"use strict";n.d(t,{HE:function(){return r},V9:function(){return o},ci:function(){return c},x2:function(){return i}});var o=1006,c=1008,r=1011,i=function(e){var t="ws";return"https:"===e&&(t="wss"),t}},94210:function(e){var t=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},95087:function(e,t,n){var o;if("object"===typeof globalThis)o=globalThis;else try{o=n(94210)}catch(a){}finally{if(o||"undefined"===typeof window||(o=window),!o)throw new Error("Could not determine global this")}var c=o.WebSocket||o.MozWebSocket,r=n(51496);function i(e,t){return t?new c(e,t):new c(e)}c&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(i,e,{get:function(){return c[e]}})})),e.exports={w3cwebsocket:c?i:null,version:r}},51496:function(e,t,n){e.exports=n(19794).version},19794:function(e){"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=6272.d6ff2673.chunk.js.map
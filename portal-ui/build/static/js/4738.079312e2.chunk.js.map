{"version":3,"file":"static/js/4738.079312e2.chunk.js","mappings":"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","sources":["screens/Console/Buckets/BucketDetails/AccessDetailsPanel.tsx","screens/Console/Common/PanelTitle/PanelTitle.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { Paper } from \"@mui/material\";\nimport Tabs from \"@mui/material/Tabs\";\nimport Tab from \"@mui/material/Tab\";\n\nimport { TabPanel } from \"../../../shared/tabs\";\nimport TableWrapper from \"../../Common/TableWrapper/TableWrapper\";\nimport {\n  CONSOLE_UI_RESOURCE,\n  IAM_PAGES,\n  IAM_SCOPES,\n} from \"../../../../common/SecureComponent/permissions\";\nimport PanelTitle from \"../../Common/PanelTitle/PanelTitle\";\nimport {\n  hasPermission,\n  SecureComponent,\n} from \"../../../../common/SecureComponent\";\nimport { encodeURLString } from \"../../../../common/utils\";\nimport { setErrorSnackMessage, setHelpName } from \"../../../../systemSlice\";\nimport { selBucketDetailsLoading } from \"./bucketDetailsSlice\";\nimport { useAppDispatch } from \"../../../../store\";\nimport { Policy, ServiceAccounts } from \"../../../../api/consoleApi\";\nimport { api } from \"api\";\nimport { errorToHandler } from \"api/errors\";\n\nfunction a11yProps(index: any) {\n  return {\n    id: `simple-tab-${index}`,\n    \"aria-controls\": `simple-tabpanel-${index}`,\n  };\n}\n\nconst AccessDetails = () => {\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n  const params = useParams();\n\n  const loadingBucket = useSelector(selBucketDetailsLoading);\n\n  const [curTab, setCurTab] = useState<number>(0);\n  const [loadingPolicies, setLoadingPolicies] = useState<boolean>(true);\n  const [bucketPolicy, setBucketPolicy] = useState<Policy[] | undefined>([]);\n  const [loadingUsers, setLoadingUsers] = useState<boolean>(true);\n  const [bucketUsers, setBucketUsers] = useState<ServiceAccounts>([]);\n\n  const bucketName = params.bucketName || \"\";\n\n  const displayPoliciesList = hasPermission(bucketName, [\n    IAM_SCOPES.ADMIN_LIST_USER_POLICIES,\n  ]);\n\n  const displayUsersList = hasPermission(\n    bucketName,\n    [\n      IAM_SCOPES.ADMIN_GET_POLICY,\n      IAM_SCOPES.ADMIN_LIST_USERS,\n      IAM_SCOPES.ADMIN_LIST_GROUPS,\n    ],\n    true\n  );\n\n  const viewUser = hasPermission(CONSOLE_UI_RESOURCE, [\n    IAM_SCOPES.ADMIN_GET_USER,\n  ]);\n  const viewPolicy = hasPermission(CONSOLE_UI_RESOURCE, [\n    IAM_SCOPES.ADMIN_GET_POLICY,\n    IAM_SCOPES.ADMIN_LIST_USERS,\n    IAM_SCOPES.ADMIN_LIST_GROUPS,\n  ]);\n\n  useEffect(() => {\n    if (loadingBucket) {\n      setLoadingUsers(true);\n      setLoadingPolicies(true);\n    }\n  }, [loadingBucket, setLoadingUsers, setLoadingPolicies]);\n\n  const PolicyActions = [\n    {\n      type: \"view\",\n      disableButtonFunction: () => !viewPolicy,\n      onClick: (policy: any) => {\n        navigate(`${IAM_PAGES.POLICIES}/${encodeURLString(policy.name)}`);\n      },\n    },\n  ];\n\n  const userTableActions = [\n    {\n      type: \"view\",\n      disableButtonFunction: () => !viewUser,\n      onClick: (user: any) => {\n        navigate(`${IAM_PAGES.USERS}/${encodeURLString(user)}`);\n      },\n    },\n  ];\n\n  useEffect(() => {\n    if (loadingUsers) {\n      if (displayUsersList) {\n        api.bucketUsers\n          .listUsersWithAccessToBucket(bucketName)\n          .then((res) => {\n            setBucketUsers(res.data);\n            setLoadingUsers(false);\n          })\n          .catch((err) => {\n            dispatch(setErrorSnackMessage(errorToHandler(err)));\n            setLoadingUsers(false);\n          });\n      } else {\n        setLoadingUsers(false);\n      }\n    }\n  }, [loadingUsers, dispatch, bucketName, displayUsersList]);\n\n  useEffect(() => {\n    dispatch(setHelpName(\"bucket_detail_access\"));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (loadingPolicies) {\n      if (displayPoliciesList) {\n        api.bucketPolicy\n          .listPoliciesWithBucket(bucketName)\n          .then((res) => {\n            setBucketPolicy(res.data.policies);\n            setLoadingPolicies(false);\n          })\n          .catch((err) => {\n            dispatch(setErrorSnackMessage(errorToHandler(err)));\n            setLoadingPolicies(false);\n          });\n      } else {\n        setLoadingPolicies(false);\n      }\n    }\n  }, [loadingPolicies, dispatch, bucketName, displayPoliciesList]);\n\n  return (\n    <Fragment>\n      <PanelTitle>Access Audit</PanelTitle>\n      <Tabs\n        value={curTab}\n        onChange={(e: React.ChangeEvent<{}>, newValue: number) => {\n          setCurTab(newValue);\n        }}\n        indicatorColor=\"primary\"\n        textColor=\"primary\"\n        aria-label=\"cluster-tabs\"\n        variant=\"scrollable\"\n        scrollButtons=\"auto\"\n      >\n        {displayPoliciesList && <Tab label=\"Policies\" {...a11yProps(0)} />}\n        {displayUsersList && <Tab label=\"Users\" {...a11yProps(1)} />}\n      </Tabs>\n      <Paper>\n        <TabPanel index={0} value={curTab}>\n          <SecureComponent\n            scopes={[IAM_SCOPES.ADMIN_LIST_USER_POLICIES]}\n            resource={bucketName}\n            errorProps={{ disabled: true }}\n          >\n            {bucketPolicy && (\n              <TableWrapper\n                noBackground={true}\n                itemActions={PolicyActions}\n                columns={[{ label: \"Name\", elementKey: \"name\" }]}\n                isLoading={loadingPolicies}\n                records={bucketPolicy}\n                entityName=\"Policies\"\n                idField=\"name\"\n              />\n            )}\n          </SecureComponent>\n        </TabPanel>\n\n        <TabPanel index={1} value={curTab}>\n          <SecureComponent\n            scopes={[\n              IAM_SCOPES.ADMIN_GET_POLICY,\n              IAM_SCOPES.ADMIN_LIST_USERS,\n              IAM_SCOPES.ADMIN_LIST_GROUPS,\n            ]}\n            resource={bucketName}\n            matchAll\n            errorProps={{ disabled: true }}\n          >\n            <TableWrapper\n              noBackground={true}\n              itemActions={userTableActions}\n              columns={[{ label: \"User\", elementKey: \"accessKey\" }]}\n              isLoading={loadingUsers}\n              records={bucketUsers}\n              entityName=\"Users\"\n              idField=\"accessKey\"\n            />\n          </SecureComponent>\n        </TabPanel>\n      </Paper>\n    </Fragment>\n  );\n};\n\nexport default AccessDetails;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React from \"react\";\nimport { Theme } from \"@mui/material/styles\";\nimport createStyles from \"@mui/styles/createStyles\";\nimport withStyles from \"@mui/styles/withStyles\";\nimport { IconButtonProps } from \"@mui/material\";\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      padding: 0,\n      margin: 0,\n      fontSize: \".9rem\",\n    },\n  });\n\ninterface IPanelTitle extends IconButtonProps {\n  classes: any;\n  children: any;\n}\n\nconst PanelTitle = ({ classes, children }: IPanelTitle) => {\n  return <h1 className={classes.root}>{children}</h1>;\n};\n\nexport default withStyles(styles)(PanelTitle);\n"],"names":["a11yProps","index","id","concat","dispatch","useAppDispatch","navigate","useNavigate","params","useParams","loadingBucket","useSelector","selBucketDetailsLoading","_useState","useState","_useState2","_slicedToArray","curTab","setCurTab","_useState3","_useState4","loadingPolicies","setLoadingPolicies","_useState5","_useState6","bucketPolicy","setBucketPolicy","_useState7","_useState8","loadingUsers","setLoadingUsers","_useState9","_useState10","bucketUsers","setBucketUsers","bucketName","displayPoliciesList","hasPermission","IAM_SCOPES","ADMIN_LIST_USER_POLICIES","displayUsersList","ADMIN_GET_POLICY","ADMIN_LIST_USERS","ADMIN_LIST_GROUPS","viewUser","CONSOLE_UI_RESOURCE","ADMIN_GET_USER","viewPolicy","useEffect","PolicyActions","type","disableButtonFunction","onClick","policy","IAM_PAGES","POLICIES","encodeURLString","name","userTableActions","user","USERS","api","listUsersWithAccessToBucket","then","res","data","catch","err","setErrorSnackMessage","errorToHandler","setHelpName","listPoliciesWithBucket","policies","_jsxs","Fragment","children","_jsx","PanelTitle","Tabs","value","onChange","e","newValue","indicatorColor","textColor","variant","scrollButtons","Tab","_objectSpread","label","Paper","TabPanel","SecureComponent","scopes","resource","errorProps","disabled","TableWrapper","noBackground","itemActions","columns","elementKey","isLoading","records","entityName","idField","matchAll","withStyles","theme","createStyles","root","padding","margin","fontSize","_ref","classes","className"],"sourceRoot":""}
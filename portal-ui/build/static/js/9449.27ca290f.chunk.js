"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[9449],{99449:function(e,a,t){t.r(a),t.d(a,{default:function(){return k}});var n=t(29439),s=t(1413),i=t(72791),l=t(60364),r=t(11135),o=t(25787),c=t(61889),d=t(23814),u=t(51691),m=t(10703),g=t(93433),h=t(56028),x=t(36151),v=t(81207),Z=t(32509),j=t(21435),p=t(40968),C=t(56578),N=t(87995),f=t(80184),b=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)({buttonContainer:{textAlign:"right"}},d.oO),d.ID),d.DF))}))((function(e){e.tenant;var a=e.classes,t=e.open,s=e.onClose,r=e.image,o=e.sidecarImage,d=e.initImage,u=e.labels,m=e.annotations,b=e.nodeSelector,I=e.diskCapacityGB,S=e.serviceAccountName,A=e.storageClassName,y=e.tenantName,P=e.tenantNamespace,R=e.cpuRequest,q=e.memRequest,k=(0,l.I0)(),z=(0,i.useState)({}),w=(0,n.Z)(z,2),M=w[0],G=w[1],F=(0,i.useState)(u.length>0?(0,g.Z)(u):[{key:"",value:""}]),E=(0,n.Z)(F,2),B=E[0],U=E[1],D=(0,i.useState)(m.length>0?(0,g.Z)(m):[{key:"",value:""}]),L=(0,n.Z)(D,2),O=L[0],_=L[1],K=(0,i.useState)(b.length>0?(0,g.Z)(b):[{key:"",value:""}]),$=(0,n.Z)(K,2),T=$[0],V=$[1],Y=(0,i.useState)(r),H=(0,n.Z)(Y,2),J=H[0],Q=H[1],W=(0,i.useState)(o),X=(0,n.Z)(W,2),ee=X[0],ae=X[1],te=(0,i.useState)(d),ne=(0,n.Z)(te,2),se=ne[0],ie=ne[1],le=(0,i.useState)(I.toString()),re=(0,n.Z)(le,2),oe=re[0],ce=re[1],de=(0,i.useState)(R),ue=(0,n.Z)(de,2),me=ue[0],ge=ue[1],he=(0,i.useState)(q?Math.floor(parseInt(q,10)/1e9).toString():""),xe=(0,n.Z)(he,2),ve=xe[0],Ze=xe[1],je=(0,i.useState)(S),pe=(0,n.Z)(je,2),Ce=pe[0],Ne=pe[1],fe=(0,i.useState)(A),be=(0,n.Z)(fe,2),Ie=be[0],Se=be[1],Ae=(0,i.useState)({}),ye=(0,n.Z)(Ae,2),Pe=ye[0],Re=ye[1],qe=(0,i.useState)({}),ke=(0,n.Z)(qe,2),ze=ke[0],we=ke[1],Me=(0,i.useState)({}),Ge=(0,n.Z)(Me,2),Fe=Ge[0],Ee=Ge[1],Be=function(e){for(var a=[],t=0;t<e.length;t++)""!==e[t].key&&a.push(e[t]);return a};(0,i.useEffect)((function(){var e=[];e.push({fieldKey:"image",required:!1,value:J,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"sidecarImage",required:!1,value:ee,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"initImage",required:!1,value:se,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"diskCapacityGB",required:!0,value:oe,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newCPURequest",required:!1,value:me,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newMemRequest",required:!1,value:ve,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"serviceAccountName",required:!1,value:Ce,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid service account name"}),e.push({fieldKey:"storageClassName",required:!1,value:Ie,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid storage class name"});var a=(0,p.R)(e);G(a)}),[J,ee,se,oe,Ce,Ie,me,ve,G]);return(0,f.jsx)(h.Z,{onClose:function(){return s(!0)},modalOpen:t,title:"Edit Monitoring Configuration",children:(0,f.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault(),v.Z.invoke("PUT","/api/v1/namespaces/".concat(P,"/tenants/").concat(y,"/monitoring"),{labels:Be(B),annotations:Be(O),nodeSelector:Be(T),image:J,sidecarImage:ee,initImage:se,diskCapacityGB:oe,serviceAccountName:Ce,storageClassName:Ie,monitoringCPURequest:me,monitoringMemRequest:ve+"Gi"}).then((function(){s(!0)})).catch((function(e){}))},children:(0,f.jsxs)(c.ZP,{container:!0,children:[(0,f.jsxs)(c.ZP,{xs:12,className:a.modalFormScrollable,children:[(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(j.Z,{id:"image",label:"Image",placeholder:"Image",name:"image",value:J,onChange:function(e){Q(e.target.value)},error:M.image||""},"image")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(j.Z,{id:"sidecarImage",label:"Sidecar Image",placeholder:"Sidecar Image",name:"sidecarImage",value:ee,onChange:function(e){ae(e.target.value)},error:M.sidecarImage||""},"sidecarImage")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(j.Z,{id:"initImage",label:"Init Image",placeholder:"Init Image",name:"initImage",value:se,onChange:function(e){ie(e.target.value)},error:M.initImage||""},"initImage")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(j.Z,{id:"diskCapacityGB",label:"Disk Capacity",placeholder:"Disk Capacity",name:"diskCapacityGB",value:oe,onChange:function(e){ce(e.target.value)},error:M.diskCapacityGB||"",overlayObject:(0,f.jsx)(C.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"diskCapacityGB")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(j.Z,{id:"cpuRequest",label:"CPU Request",placeholder:"CPU Request",name:"cpuRequest",value:me,onChange:function(e){ge(e.target.value)},error:M.cpuRequest||""},"cpuRequest")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(j.Z,{id:"memRequest",label:"Memory Request",placeholder:"Memory request",name:"memRequest",value:ve,onChange:function(e){e.target.validity.valid&&Ze(e.target.value)},pattern:"[0-9]*",error:M.memRequest||"",overlayObject:(0,f.jsx)(C.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"memRequest")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(j.Z,{id:"serviceAccountName",label:"Service Account",placeholder:"Service Account Name",name:"serviceAccountName",value:Ce,onChange:function(e){Ne(e.target.value)},error:M.serviceAccountName||""},"serviceAccountName")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(j.Z,{id:"storageClassName",label:"Storage Class",placeholder:"Storage Class Name",name:"storageClassName",value:Ie,onChange:function(e){Se(e.target.value)},error:M.storageClassName||""},"storageClassName")}),(0,f.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,f.jsx)("span",{className:a.inputLabel,children:"Labels"}),(0,f.jsx)(Z.Z,{newValues:B,setNewValues:U,paramName:"Labels",error:Pe,setError:Re})]}),(0,f.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,f.jsx)("span",{className:a.inputLabel,children:"Annotations"}),(0,f.jsx)(Z.Z,{newValues:O,setNewValues:_,paramName:"Annotations",error:ze,setError:we})]}),(0,f.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,f.jsx)("span",{className:a.inputLabel,children:"Node Selector"}),(0,f.jsx)(Z.Z,{newValues:T,setNewValues:V,paramName:"Node Selector",error:Fe,setError:Ee})]})]}),(0,f.jsx)(c.ZP,{xs:12,className:a.buttonContainer,children:(0,f.jsx)(x.Z,{type:"submit",variant:"contained",color:"primary",disabled:!function(){if(0!==Object.keys(M).length||0!==Object.keys(Pe).length||0!==Object.keys(ze).length||0!==Object.keys(Fe).length){return k((0,N.zb)({errorMessage:"Invalid entry",detailedError:""})),!1}return!0}(),children:"Save"})})]})})})})),I=t(51047),S=t(37516),A=t(47879),y=t(45248),P=t(2148),R=t(40603),q=t(72401),k=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)((0,s.Z)({},d.oZ),{},{paperContainer:{padding:"15px 15px 15px 50px"}},d.OR),d.qg),(0,d.Bz)(e.spacing(4))))}))((function(e){var a=e.classes,t=e.match,s=e.tenant,r=e.loadingTenant,o=(0,l.I0)(),d=(0,i.useState)(!1),g=(0,n.Z)(d,2),h=g[0],x=g[1],Z=(0,i.useState)(!1),j=(0,n.Z)(Z,2),p=j[0],C=j[1],k=(0,i.useState)(),z=(0,n.Z)(k,2),w=z[0],M=z[1],G=(0,i.useState)(!1),F=(0,n.Z)(G,2),E=F[0],B=F[1],U=(0,i.useState)(!0),D=(0,n.Z)(U,2),L=D[0],O=D[1],_=t.params.tenantName,K=t.params.tenantNamespace;(0,i.useEffect)((function(){L&&v.Z.invoke("GET","/api/v1/namespaces/".concat(K,"/tenants/").concat(_,"/monitoring")).then((function(e){x(e.prometheusEnabled),M(e),O(!1)})).catch((function(e){o((0,N.Ih)(e)),O(!1)}))}),[L]);return(0,f.jsxs)(i.Fragment,{children:[p&&null!==s&&h&&(0,f.jsx)(b,{classes:a,open:p,onClose:function(){C(!1),O(!0)},tenant:s,image:(null===w||void 0===w?void 0:w.image)||"",sidecarImage:(null===w||void 0===w?void 0:w.sidecarImage)||"",initImage:(null===w||void 0===w?void 0:w.initImage)||"",diskCapacityGB:null!==w&&void 0!==w&&w.diskCapacityGB?parseInt(null===w||void 0===w?void 0:w.diskCapacityGB):5,labels:(null===w||void 0===w?void 0:w.labels)||[],annotations:(null===w||void 0===w?void 0:w.annotations)||[],nodeSelector:(null===w||void 0===w?void 0:w.nodeSelector)||[],serviceAccountName:(null===w||void 0===w?void 0:w.serviceAccountName)||"",tenantName:_,tenantNamespace:K,storageClassName:(null===w||void 0===w?void 0:w.storageClassName)||"",cpuRequest:(null===w||void 0===w?void 0:w.monitoringCPURequest)||"",memRequest:(null===w||void 0===w?void 0:w.monitoringMemRequest)||""}),E&&(0,f.jsx)(P.Z,{isOpen:E,title:h?"Disable Prometheus monitoring?":"Enable Prometheus monitoring?",confirmText:h?"Disable":"Enable",cancelText:"Cancel",onClose:function(){return B(!1)},onConfirm:function(){var e={prometheusEnabled:h,toggle:!0};v.Z.invoke("PUT","/api/v1/namespaces/".concat(K,"/tenants/").concat(_,"/monitoring"),e).then((function(){x(!h),O(!0),B(!1),O(!0)})).catch((function(e){o((0,N.Ih)(e))}))},confirmationContent:(0,f.jsx)(u.Z,{children:h?"Disabling monitoring will erase any custom values you have used to configure Prometheus monitoring":"Prometheus monitoring will be enabled with default values"})}),(0,f.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,f.jsx)(c.ZP,{item:!0,xs:!0,children:(0,f.jsx)("h1",{className:a.sectionTitle,children:"Monitoring"})}),(0,f.jsx)(c.ZP,{item:!0,xs:4,children:(0,f.jsx)(S.Z,{indicatorLabels:["Enabled","Disabled"],checked:h,value:"monitoring_status",id:"monitoring-status",name:"monitoring-status",onChange:function(e){B(!0)},description:""})})]}),h&&void 0!==w&&(0,f.jsx)(m.Z,{className:a.paperContainer,children:(0,f.jsxs)(c.ZP,{container:!0,children:[(0,f.jsx)(c.ZP,{item:!0,xs:12,children:(0,f.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,f.jsx)(c.ZP,{xs:8,children:(0,f.jsx)("h3",{children:"Configuration"})}),(0,f.jsx)(c.ZP,{xs:4,justifyContent:"end",textAlign:"right",children:(0,f.jsx)(R.Z,{tooltip:"Edit Monitoring configuration",text:"Edit",onClick:function(){C(!0)},icon:(0,f.jsx)(I.dY8,{}),color:"primary",variant:"contained"})})]})}),(0,f.jsxs)(c.ZP,{item:!0,xs:12,children:[(0,f.jsx)("hr",{className:a.hrClass}),(0,f.jsx)("table",{width:"100%",children:(0,f.jsx)("tbody",{children:r?(0,f.jsx)("tr",{children:(0,f.jsx)("td",{className:a.centerAlign,colSpan:4,children:(0,f.jsx)(q.Z,{})})}):(0,f.jsxs)(i.Fragment,{children:[null!=w.image&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Image:"}),(0,f.jsx)("td",{children:w.image})]}),null!=w.sidecarImage&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Sidecar Image:"}),(0,f.jsx)("td",{children:null===w||void 0===w?void 0:w.sidecarImage})]}),null!=w.initImage&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Init Image:"}),(0,f.jsx)("td",{children:null===w||void 0===w?void 0:w.initImage})]}),null!=w.diskCapacityGB&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Disk Capacity (GB):"}),(0,f.jsx)("td",{children:null===w||void 0===w?void 0:w.diskCapacityGB})]}),null!=w.serviceAccountName&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Service Account Name:"}),(0,f.jsx)("td",{children:null===w||void 0===w?void 0:w.serviceAccountName})]}),null!=w.storageClassName&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Storage Class Name:"}),(0,f.jsx)("td",{children:null===w||void 0===w?void 0:w.storageClassName})]}),null!=w.labels&&w.labels.length>0&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("tr",{children:(0,f.jsx)("td",{children:(0,f.jsx)("h4",{children:"Labels"})})}),(0,f.jsx)("tr",{children:(0,f.jsx)("td",{className:a.titleCol,children:(0,f.jsx)(A.Z,{records:w.labels,recordName:"Labels"})})})]}),null!=w.annotations&&w.annotations.length>0&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("tr",{children:(0,f.jsx)("td",{children:(0,f.jsx)("h4",{children:"Annotations"})})}),(0,f.jsx)("tr",{children:(0,f.jsx)("td",{className:a.titleCol,children:(0,f.jsx)(A.Z,{records:w.annotations,recordName:"Annotations"})})})]}),null!=w.monitoringCPURequest&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"CPU Request:"}),(0,f.jsx)("td",{children:null===w||void 0===w?void 0:w.monitoringCPURequest})]}),null!=w.monitoringMemRequest&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Memory Request:"}),(0,f.jsx)("td",{children:(0,y.ae)(null===w||void 0===w?void 0:w.monitoringMemRequest,!0)})]}),null!=w.nodeSelector&&w.nodeSelector.length>0&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("h4",{children:"Node Selector:"}),(0,f.jsx)("td",{className:a.titleCol,children:(0,f.jsx)(A.Z,{records:w.nodeSelector,recordName:"Node Selector"})})]})]})})})]})]})})]})}))}}]);
//# sourceMappingURL=9449.27ca290f.chunk.js.map
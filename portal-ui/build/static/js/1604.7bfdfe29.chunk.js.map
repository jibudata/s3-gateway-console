{"version":3,"file":"static/js/1604.7bfdfe29.chunk.js","mappings":"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","sources":["screens/Console/Buckets/BucketDetails/SetRetentionConfig.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { useEffect, useState, Fragment } from \"react\";\nimport {\n  Button,\n  Loader,\n  Grid,\n  FormLayout,\n  RadioGroup,\n  InputBox,\n  ProgressBar,\n} from \"mds\";\nimport { api } from \"api\";\nimport { ObjectRetentionMode, ObjectRetentionUnit } from \"api/consoleApi\";\nimport { errorToHandler } from \"api/errors\";\n\nimport { modalStyleUtils } from \"../../Common/FormComponents/common/styleLibrary\";\nimport { setModalErrorSnackMessage } from \"../../../../systemSlice\";\nimport { useAppDispatch } from \"../../../../store\";\nimport ModalWrapper from \"../../Common/ModalWrapper/ModalWrapper\";\n\ninterface ISetRetentionConfigProps {\n  open: boolean;\n  bucketName: string;\n  closeModalAndRefresh: () => void;\n}\n\nconst SetRetentionConfig = ({\n  open,\n  bucketName,\n  closeModalAndRefresh,\n}: ISetRetentionConfigProps) => {\n  const dispatch = useAppDispatch();\n  const [addLoading, setAddLoading] = useState<boolean>(false);\n  const [loadingForm, setLoadingForm] = useState<boolean>(true);\n  const [retentionMode, setRetentionMode] = useState<\n    ObjectRetentionMode | undefined\n  >(ObjectRetentionMode.Compliance);\n  const [retentionUnit, setRetentionUnit] = useState<\n    ObjectRetentionUnit | undefined\n  >(ObjectRetentionUnit.Days);\n  const [retentionValidity, setRetentionValidity] = useState<\n    number | undefined\n  >(1);\n  const [valid, setValid] = useState<boolean>(false);\n\n  const setRetention = (event: React.FormEvent) => {\n    event.preventDefault();\n    if (addLoading) {\n      return;\n    }\n    setAddLoading(true);\n    api.buckets\n      .setBucketRetentionConfig(bucketName, {\n        mode: retentionMode || ObjectRetentionMode.Compliance,\n        unit: retentionUnit || ObjectRetentionUnit.Days,\n        validity: retentionValidity || 1,\n      })\n      .then(() => {\n        setAddLoading(false);\n        closeModalAndRefresh();\n      })\n      .catch((err) => {\n        setAddLoading(false);\n        dispatch(setModalErrorSnackMessage(errorToHandler(err.error)));\n      });\n  };\n\n  useEffect(() => {\n    if (Number.isNaN(retentionValidity) || (retentionValidity || 1) < 1) {\n      setValid(false);\n      return;\n    }\n    setValid(true);\n  }, [retentionValidity]);\n\n  useEffect(() => {\n    if (loadingForm) {\n      api.buckets\n        .getBucketRetentionConfig(bucketName)\n        .then((res) => {\n          setLoadingForm(false);\n\n          // We set default values\n          setRetentionMode(res.data.mode);\n          setRetentionValidity(res.data.validity);\n          setRetentionUnit(res.data.unit);\n        })\n        .catch(() => {\n          setLoadingForm(false);\n        });\n    }\n  }, [loadingForm, bucketName]);\n\n  return (\n    <ModalWrapper\n      title=\"Set Retention Configuration\"\n      modalOpen={open}\n      onClose={() => {\n        closeModalAndRefresh();\n      }}\n    >\n      {loadingForm ? (\n        <Loader style={{ width: 16, height: 16 }} />\n      ) : (\n        <form\n          noValidate\n          autoComplete=\"off\"\n          onSubmit={(e: React.FormEvent<HTMLFormElement>) => {\n            setRetention(e);\n          }}\n        >\n          <FormLayout containerPadding={false} withBorders={false}>\n            <RadioGroup\n              currentValue={retentionMode as string}\n              id=\"retention_mode\"\n              name=\"retention_mode\"\n              label=\"Retention Mode\"\n              onChange={(e: React.ChangeEvent<{ value: unknown }>) => {\n                setRetentionMode(e.target.value as ObjectRetentionMode);\n              }}\n              selectorOptions={[\n                { value: \"compliance\", label: \"Compliance\" },\n                { value: \"governance\", label: \"Governance\" },\n              ]}\n              helpTip={\n                <Fragment>\n                  {\" \"}\n                  <a\n                    href=\"https://min.io/docs/minio/macos/administration/object-management/object-retention.html#minio-object-locking-compliance\"\n                    target=\"blank\"\n                  >\n                    Compliance\n                  </a>{\" \"}\n                  lock protects Objects from write operations by all users,\n                  including the MinIO root user.\n                  <br />\n                  <br />\n                  <a\n                    href=\"https://min.io/docs/minio/macos/administration/object-management/object-retention.html#minio-object-locking-governance\"\n                    target=\"blank\"\n                  >\n                    Governance\n                  </a>{\" \"}\n                  lock protects Objects from write operations by non-privileged\n                  users.\n                </Fragment>\n              }\n              helpTipPlacement=\"right\"\n            />\n            <RadioGroup\n              currentValue={retentionUnit as string}\n              id=\"retention_unit\"\n              name=\"retention_unit\"\n              label=\"Retention Unit\"\n              onChange={(e: React.ChangeEvent<{ value: unknown }>) => {\n                setRetentionUnit(e.target.value as ObjectRetentionUnit);\n              }}\n              selectorOptions={[\n                { value: \"days\", label: \"Days\" },\n                { value: \"years\", label: \"Years\" },\n              ]}\n            />\n            <InputBox\n              type=\"number\"\n              id=\"retention_validity\"\n              name=\"retention_validity\"\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setRetentionValidity(e.target.valueAsNumber);\n              }}\n              label=\"Retention Validity\"\n              value={String(retentionValidity)}\n              required\n              min=\"1\"\n            />\n            <Grid item xs={12} sx={modalStyleUtils.modalButtonBar}>\n              <Button\n                id={\"cancel\"}\n                type=\"button\"\n                variant=\"regular\"\n                disabled={addLoading}\n                onClick={() => {\n                  closeModalAndRefresh();\n                }}\n                label={\"Cancel\"}\n              />\n              <Button\n                id={\"set\"}\n                type=\"submit\"\n                variant=\"callAction\"\n                color=\"primary\"\n                disabled={addLoading || !valid}\n                label={\"Set\"}\n              />\n            </Grid>\n            {addLoading && (\n              <Grid item xs={12}>\n                <ProgressBar />\n              </Grid>\n            )}\n          </FormLayout>\n        </form>\n      )}\n    </ModalWrapper>\n  );\n};\n\nexport default SetRetentionConfig;\n"],"names":["_ref","open","bucketName","closeModalAndRefresh","dispatch","useAppDispatch","_useState","useState","_useState2","_slicedToArray","addLoading","setAddLoading","_useState3","_useState4","loadingForm","setLoadingForm","_useState5","ObjectRetentionMode","Compliance","_useState6","retentionMode","setRetentionMode","_useState7","ObjectRetentionUnit","Days","_useState8","retentionUnit","setRetentionUnit","_useState9","_useState10","retentionValidity","setRetentionValidity","_useState11","_useState12","valid","setValid","useEffect","Number","isNaN","api","buckets","getBucketRetentionConfig","then","res","data","mode","validity","unit","catch","_jsx","ModalWrapper","title","modalOpen","onClose","children","Loader","style","width","height","noValidate","autoComplete","onSubmit","e","preventDefault","setBucketRetentionConfig","err","setModalErrorSnackMessage","errorToHandler","error","_jsxs","FormLayout","containerPadding","withBorders","RadioGroup","currentValue","id","name","label","onChange","target","value","selectorOptions","helpTip","Fragment","href","helpTipPlacement","InputBox","type","valueAsNumber","String","required","min","Grid","item","xs","sx","modalStyleUtils","modalButtonBar","Button","variant","disabled","onClick","color","ProgressBar"],"sourceRoot":""}
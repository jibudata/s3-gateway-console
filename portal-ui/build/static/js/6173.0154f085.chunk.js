"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[6173],{96173:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var i=n(23430),a=n(18489),s=n(50390),l=n(34424),r=n(86509),c=n(4285),o=n(25594),d=n(14792),u=n(56135),m=n(44149),x=n(72462),f=n(30324),h=n(17777),p=n(8235),Z=n(48122),g=n(15607),j=n(49495),b=n(37882),k=n(53224),S=n(66946),v=n(76352),R=n(66964),N=n(65703),C=n(98280),P=n(50280),F=n(92440),y=n(62559),I=(0,l.$j)(null,{setModalErrorSnackMessage:m.zb}),T=(0,c.Z)((function(e){return(0,r.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({buttonContainer:{textAlign:"right"},multiContainer:{display:"flex",alignItems:"center"},sizeFactorContainer:{"& label":{display:"none"},"& div:first-child":{marginBottom:0}}},x.bK),x.QV),x.DF),x.ID),{},{modalFormScrollable:(0,a.Z)((0,a.Z)({},x.ID.modalFormScrollable),{},{paddingRight:10})}))}))(I((function(e){var t=e.closeModalAndRefresh,n=e.open,a=e.classes,l=e.bucketName,r=e.ruleID,c=e.setModalErrorSnackMessage,d=(0,s.useState)(!0),u=(0,i.Z)(d,2),m=u[0],x=u[1],h=(0,s.useState)(!1),p=(0,i.Z)(h,2),Z=p[0],g=p[1],j=(0,s.useState)("1"),b=(0,i.Z)(j,2),k=b[0],I=b[1],T=(0,s.useState)(""),E=(0,i.Z)(T,2),D=E[0],w=E[1],A=(0,s.useState)(""),O=(0,i.Z)(A,2),_=O[0],M=O[1],B=(0,s.useState)(!1),G=(0,i.Z)(B,2),U=G[0],K=G[1],L=(0,s.useState)(!1),z=(0,i.Z)(L,2),H=z[0],V=z[1],Y=(0,s.useState)(""),$=(0,i.Z)(Y,2),q=$[0],Q=$[1],J=(0,s.useState)(""),W=(0,i.Z)(J,2),X=W[0],ee=W[1],te=(0,s.useState)(""),ne=(0,i.Z)(te,2),ie=ne[0],ae=ne[1],se=(0,s.useState)(!1),le=(0,i.Z)(se,2),re=le[0],ce=le[1],oe=(0,s.useState)(!1),de=(0,i.Z)(oe,2),ue=de[0],me=de[1],xe=(0,s.useState)(!1),fe=(0,i.Z)(xe,2),he=fe[0],pe=fe[1];return(0,s.useEffect)((function(){m&&f.Z.invoke("GET","/api/v1/buckets/".concat(l,"/replication/").concat(r)).then((function(e){I(e.priority.toString());var t=e.prefix||"",n=e.tags||"";M(t),Q(n),ee(n),w(e.destination.bucket),K(e.delete_marker_replication),ae(e.storageClass||""),ce(!!e.existingObjects),me(!!e.deletes_replication),pe("Enabled"===e.status),V(!!e.metadata_replication),x(!1)})).catch((function(e){c(e),x(!1)}))}),[m,c,l,r]),(0,s.useEffect)((function(){if(Z){var e={arn:D,ruleState:he,prefix:_,tags:X,replicateDeleteMarkers:U,replicateDeletes:ue,replicateExistingObjects:re,replicateMetadata:H,priority:parseInt(k),storageClass:ie};f.Z.invoke("PUT","/api/v1/buckets/".concat(l,"/replication/").concat(r),e).then((function(){g(!1),t(!0)})).catch((function(e){c(e),g(!1)}))}}),[Z,l,r,D,_,X,U,k,ue,re,he,H,ie,t,c]),(0,y.jsx)(v.Z,{modalOpen:n,onClose:function(){t(!1)},title:"Edit Bucket Replication",titleIcon:(0,y.jsx)(C.xR,{}),children:(0,y.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault(),g(!0)},children:(0,y.jsxs)(o.ZP,{container:!0,children:[(0,y.jsxs)(o.ZP,{item:!0,xs:12,className:a.modalFormScrollable,children:[(0,y.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,y.jsx)(F.Z,{checked:he,id:"ruleState",name:"ruleState",label:"Rule State",onChange:function(e){pe(e.target.checked)},value:he})}),(0,y.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,y.jsx)(P.Z,{label:"Destination",content:D})}),(0,y.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,y.jsx)(R.Z,{id:"priority",name:"priority",onChange:function(e){e.target.validity.valid&&I(e.target.value)},label:"Priority",value:k,pattern:"[0-9]*"})}),(0,y.jsx)(o.ZP,{item:!0,xs:12,className:"".concat(a.spacerTop," ").concat(a.formFieldRow),children:(0,y.jsx)(R.Z,{id:"storageClass",name:"storageClass",onChange:function(e){ae(e.target.value)},placeholder:"STANDARD_IA,REDUCED_REDUNDANCY etc",label:"Storage Class",value:ie})}),(0,y.jsx)(o.ZP,{item:!0,xs:12,children:(0,y.jsxs)("fieldset",{className:a.fieldGroup,children:[(0,y.jsx)("legend",{className:a.descriptionText,children:"Object Filters"}),(0,y.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,y.jsx)(R.Z,{id:"prefix",name:"prefix",onChange:function(e){M(e.target.value)},placeholder:"prefix",label:"Prefix",value:_})}),(0,y.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,y.jsx)(N.Z,{name:"tags",label:"Tags",elements:q,onChange:function(e){ee(e)},keyPlaceholder:"Tag Key",valuePlaceholder:"Tag Value",withBorder:!0})})]})}),(0,y.jsx)(o.ZP,{item:!0,xs:12,children:(0,y.jsxs)("fieldset",{className:a.fieldGroup,children:[(0,y.jsx)("legend",{className:a.descriptionText,children:"Replication Options"}),(0,y.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,y.jsx)(F.Z,{checked:re,id:"repExisting",name:"repExisting",label:"Existing Objects",onChange:function(e){ce(e.target.checked)},value:re,description:"Replicate existing objects"})}),(0,y.jsx)(F.Z,{checked:H,id:"metadatataSync",name:"metadatataSync",label:"Metadata Sync",onChange:function(e){V(e.target.checked)},value:H,description:"Metadata Sync"}),(0,y.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,y.jsx)(F.Z,{checked:U,id:"deleteMarker",name:"deleteMarker",label:"Delete Marker",onChange:function(e){K(e.target.checked)},value:U,description:"Replicate soft deletes"})}),(0,y.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,y.jsx)(F.Z,{checked:ue,id:"repDelete",name:"repDelete",label:"Deletes",onChange:function(e){me(e.target.checked)},value:ue,description:"Replicate versioned deletes"})})]})})]}),(0,y.jsxs)(o.ZP,{item:!0,xs:12,className:a.modalButtonBar,children:[(0,y.jsx)(S.Z,{type:"button",variant:"outlined",color:"primary",disabled:m||Z,onClick:function(){t(!1)},children:"Cancel"}),(0,y.jsx)(S.Z,{type:"submit",variant:"contained",color:"primary",disabled:m||Z,children:"Save"})]})]})})})}))),E=(0,b.Z)(s.lazy((function(){return n.e(6866).then(n.bind(n,86866))}))),D=(0,b.Z)(s.lazy((function(){return n.e(8564).then(n.bind(n,98564))}))),w=(0,l.$j)((function(e){return{session:e.console.session,loadingBucket:e.buckets.bucketDetails.loadingBucket,bucketInfo:e.buckets.bucketDetails.bucketInfo}}),{setErrorSnackMessage:m.Ih}),A=(0,c.Z)((function(e){return(0,r.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},x.qg),x.OR),{},{twHeight:{minHeight:400}}))}))(w((function(e){var t=e.classes,n=e.match,a=e.setErrorSnackMessage,l=e.loadingBucket,r=(e.bucketInfo,(0,s.useState)(!0)),c=(0,i.Z)(r,2),m=c[0],x=c[1],b=(0,s.useState)([]),S=(0,i.Z)(b,2),v=S[0],R=S[1],N=(0,s.useState)(!1),C=(0,i.Z)(N,2),P=C[0],F=C[1],I=(0,s.useState)(!1),w=(0,i.Z)(I,2),A=w[0],O=w[1],_=(0,s.useState)(!1),M=(0,i.Z)(_,2),B=M[0],G=M[1],U=(0,s.useState)(""),K=(0,i.Z)(U,2),L=K[0],z=K[1],H=n.params.bucketName,V=(0,g.F)(H,[j.Ft.S3_GET_REPLICATION_CONFIGURATION]);(0,s.useEffect)((function(){l&&x(!0)}),[l,x]),(0,s.useEffect)((function(){m&&(V?f.Z.invoke("GET","/api/v1/buckets/".concat(H,"/replication")).then((function(e){var t=e.rules?e.rules:[];t.sort((function(e,t){return e.priority-t.priority})),R(t),x(!1)})).catch((function(e){a(e),x(!1)})):x(!1))}),[m,a,H,V]);var Y=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];O(e)},$=[{type:"delete",onClick:function(e){z(e.id),F(!0)},disableButtonFunction:function(){return 1===v.length}},{type:"view",onClick:function(e){z(e.id),G(!0)},disableButtonFunction:!(0,g.F)(H,[j.Ft.S3_PUT_REPLICATION_CONFIGURATION],!0)}];return(0,y.jsxs)(s.Fragment,{children:[A&&(0,y.jsx)(E,{closeModalAndRefresh:function(){Y(!1),x(!0)},open:A,bucketName:H,setReplicationRules:v}),P&&(0,y.jsx)(D,{deleteOpen:P,selectedBucket:H,closeDeleteModalAndRefresh:function(e){F(!1),e&&x(!0)},ruleToDelete:L}),B&&(0,y.jsx)(T,{closeModalAndRefresh:function(e){G(!1),e&&x(!0)},open:B,bucketName:H,ruleID:L}),(0,y.jsxs)(o.ZP,{container:!0,children:[(0,y.jsxs)(o.ZP,{item:!0,xs:12,className:t.actionsTray,children:[(0,y.jsx)(Z.Z,{children:"Replication"}),(0,y.jsx)(g.Z,{scopes:[j.Ft.S3_PUT_REPLICATION_CONFIGURATION],resource:H,matchAll:!0,errorProps:{disabled:!0},children:(0,y.jsx)(k.Z,{tooltip:"Add Replication Rule",onClick:function(){Y(!0)},text:"Add Replication Rule",icon:(0,y.jsx)(d.Z,{}),color:"primary",variant:"contained"})})]}),(0,y.jsx)(o.ZP,{item:!0,xs:12,children:(0,y.jsx)(g.Z,{scopes:[j.Ft.S3_GET_REPLICATION_CONFIGURATION],resource:H,errorProps:{disabled:!0},children:(0,y.jsx)(h.Z,{itemActions:$,columns:[{label:"Priority",elementKey:"priority",width:55,contentTextAlign:"center"},{label:"Destination",elementKey:"destination",renderFunction:function(e){return(0,y.jsx)(s.Fragment,{children:e.bucket.replace("arn:aws:s3:::","")})}},{label:"Prefix",elementKey:"prefix",width:200},{label:"Tags",elementKey:"tags",renderFunction:function(e){return(0,y.jsx)(s.Fragment,{children:e&&""!==e.tags?"Yes":"No"})},width:60},{label:"Status",elementKey:"status",width:100}],isLoading:m,records:v,entityName:"Replication Rules",idField:"id",customPaperHeight:t.twHeight,textSelectable:!0})})}),(0,y.jsx)(o.ZP,{item:!0,xs:12,children:(0,y.jsx)(p.Z,{title:"Replication",iconComponent:(0,y.jsx)(u.default,{}),help:(0,y.jsxs)(s.Fragment,{children:["MinIO supports server-side and client-side replication of objects between source and destination buckets.",(0,y.jsx)("br",{}),(0,y.jsx)("br",{}),"You can learn more at our"," ",(0,y.jsx)("a",{href:"https://docs.min.io/minio/baremetal/replication/replication-overview.html?ref=con",target:"_blank",rel:"noreferrer",children:"documentation"}),"."]})})})]})]})})))},50280:function(e,t,n){var i=n(18489),a=n(50390),s=n(25594),l=n(86509),r=n(4285),c=n(72462),o=n(62559);t.Z=(0,r.Z)((function(e){return(0,l.Z)((0,i.Z)({},c.xx))}))((function(e){var t=e.classes,n=e.label,i=void 0===n?"":n,l=e.content,r=e.multiLine,c=void 0!==r&&r;return(0,o.jsx)(a.Fragment,{children:(0,o.jsxs)(s.ZP,{className:t.prefinedContainer,children:[""!==i&&(0,o.jsx)(s.ZP,{item:!0,xs:12,className:t.predefinedTitle,children:i}),(0,o.jsx)(s.ZP,{item:!0,xs:12,className:t.predefinedList,children:(0,o.jsx)(s.ZP,{item:!0,xs:12,className:c?t.innerContentMultiline:t.innerContent,children:l})})]})})}))}}]);
//# sourceMappingURL=6173.0154f085.chunk.js.map
{"version":3,"file":"static/js/4738.b8531f47.chunk.js","mappings":"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","sources":["screens/Console/Buckets/BucketDetails/AccessDetailsPanel.tsx","screens/Console/Common/PanelTitle/PanelTitle.tsx","screens/shared/tabs.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { Paper } from \"@mui/material\";\nimport Tabs from \"@mui/material/Tabs\";\nimport Tab from \"@mui/material/Tab\";\n\nimport { TabPanel } from \"../../../shared/tabs\";\nimport { Policy } from \"../../Policies/types\";\nimport { User } from \"../../Users/types\";\nimport { ErrorResponseHandler } from \"../../../../common/types\";\nimport TableWrapper from \"../../Common/TableWrapper/TableWrapper\";\nimport api from \"../../../../common/api\";\nimport {\n  CONSOLE_UI_RESOURCE,\n  IAM_PAGES,\n  IAM_SCOPES,\n} from \"../../../../common/SecureComponent/permissions\";\nimport PanelTitle from \"../../Common/PanelTitle/PanelTitle\";\nimport {\n  hasPermission,\n  SecureComponent,\n} from \"../../../../common/SecureComponent\";\nimport { encodeURLString } from \"../../../../common/utils\";\nimport { setErrorSnackMessage } from \"../../../../systemSlice\";\nimport { selBucketDetailsLoading } from \"./bucketDetailsSlice\";\nimport { useAppDispatch } from \"../../../../store\";\n\nfunction a11yProps(index: any) {\n  return {\n    id: `simple-tab-${index}`,\n    \"aria-controls\": `simple-tabpanel-${index}`,\n  };\n}\n\nconst AccessDetails = () => {\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n  const params = useParams();\n\n  const loadingBucket = useSelector(selBucketDetailsLoading);\n\n  const [curTab, setCurTab] = useState<number>(0);\n  const [loadingPolicies, setLoadingPolicies] = useState<boolean>(true);\n  const [bucketPolicy, setBucketPolicy] = useState<Policy[]>([]);\n  const [loadingUsers, setLoadingUsers] = useState<boolean>(true);\n  const [bucketUsers, setBucketUsers] = useState<User[]>([]);\n\n  const bucketName = params.bucketName || \"\";\n\n  const displayPoliciesList = hasPermission(bucketName, [\n    IAM_SCOPES.ADMIN_LIST_USER_POLICIES,\n  ]);\n\n  const displayUsersList = hasPermission(\n    bucketName,\n    [\n      IAM_SCOPES.ADMIN_GET_POLICY,\n      IAM_SCOPES.ADMIN_LIST_USERS,\n      IAM_SCOPES.ADMIN_LIST_GROUPS,\n    ],\n    true\n  );\n\n  const viewUser = hasPermission(CONSOLE_UI_RESOURCE, [\n    IAM_SCOPES.ADMIN_GET_USER,\n  ]);\n  const viewPolicy = hasPermission(CONSOLE_UI_RESOURCE, [\n    IAM_SCOPES.ADMIN_GET_POLICY,\n    IAM_SCOPES.ADMIN_LIST_USERS,\n    IAM_SCOPES.ADMIN_LIST_GROUPS,\n  ]);\n\n  useEffect(() => {\n    if (loadingBucket) {\n      setLoadingUsers(true);\n      setLoadingPolicies(true);\n    }\n  }, [loadingBucket, setLoadingUsers, setLoadingPolicies]);\n\n  const PolicyActions = [\n    {\n      type: \"view\",\n      disableButtonFunction: () => !viewPolicy,\n      onClick: (policy: any) => {\n        navigate(`${IAM_PAGES.POLICIES}/${encodeURLString(policy.name)}`);\n      },\n    },\n  ];\n\n  const userTableActions = [\n    {\n      type: \"view\",\n      disableButtonFunction: () => !viewUser,\n      onClick: (user: any) => {\n        navigate(`${IAM_PAGES.USERS}/${encodeURLString(user)}`);\n      },\n    },\n  ];\n\n  useEffect(() => {\n    if (loadingUsers) {\n      if (displayUsersList) {\n        api\n          .invoke(\"GET\", `/api/v1/bucket-users/${bucketName}`)\n          .then((res: any) => {\n            setBucketUsers(res);\n            setLoadingUsers(false);\n          })\n          .catch((err: ErrorResponseHandler) => {\n            dispatch(setErrorSnackMessage(err));\n            setLoadingUsers(false);\n          });\n      } else {\n        setLoadingUsers(false);\n      }\n    }\n  }, [loadingUsers, dispatch, bucketName, displayUsersList]);\n\n  useEffect(() => {\n    if (loadingPolicies) {\n      if (displayPoliciesList) {\n        api\n          .invoke(\"GET\", `/api/v1/bucket-policy/${bucketName}`)\n          .then((res: any) => {\n            setBucketPolicy(res.policies);\n            setLoadingPolicies(false);\n          })\n          .catch((err: ErrorResponseHandler) => {\n            dispatch(setErrorSnackMessage(err));\n            setLoadingPolicies(false);\n          });\n      } else {\n        setLoadingPolicies(false);\n      }\n    }\n  }, [loadingPolicies, dispatch, bucketName, displayPoliciesList]);\n\n  return (\n    <Fragment>\n      <PanelTitle>Access Audit</PanelTitle>\n      <Tabs\n        value={curTab}\n        onChange={(e: React.ChangeEvent<{}>, newValue: number) => {\n          setCurTab(newValue);\n        }}\n        indicatorColor=\"primary\"\n        textColor=\"primary\"\n        aria-label=\"cluster-tabs\"\n        variant=\"scrollable\"\n        scrollButtons=\"auto\"\n      >\n        {displayPoliciesList && <Tab label=\"Policies\" {...a11yProps(0)} />}\n        {displayUsersList && <Tab label=\"Users\" {...a11yProps(1)} />}\n      </Tabs>\n      <Paper>\n        <TabPanel index={0} value={curTab}>\n          <SecureComponent\n            scopes={[IAM_SCOPES.ADMIN_LIST_USER_POLICIES]}\n            resource={bucketName}\n            errorProps={{ disabled: true }}\n          >\n            <TableWrapper\n              noBackground={true}\n              itemActions={PolicyActions}\n              columns={[{ label: \"Name\", elementKey: \"name\" }]}\n              isLoading={loadingPolicies}\n              records={bucketPolicy}\n              entityName=\"Policies\"\n              idField=\"name\"\n            />\n          </SecureComponent>\n        </TabPanel>\n\n        <TabPanel index={1} value={curTab}>\n          <SecureComponent\n            scopes={[\n              IAM_SCOPES.ADMIN_GET_POLICY,\n              IAM_SCOPES.ADMIN_LIST_USERS,\n              IAM_SCOPES.ADMIN_LIST_GROUPS,\n            ]}\n            resource={bucketName}\n            matchAll\n            errorProps={{ disabled: true }}\n          >\n            <TableWrapper\n              noBackground={true}\n              itemActions={userTableActions}\n              columns={[{ label: \"User\", elementKey: \"accessKey\" }]}\n              isLoading={loadingUsers}\n              records={bucketUsers}\n              entityName=\"Users\"\n              idField=\"accessKey\"\n            />\n          </SecureComponent>\n        </TabPanel>\n      </Paper>\n    </Fragment>\n  );\n};\n\nexport default AccessDetails;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React from \"react\";\nimport { Theme } from \"@mui/material/styles\";\nimport createStyles from \"@mui/styles/createStyles\";\nimport withStyles from \"@mui/styles/withStyles\";\nimport { IconButtonProps } from \"@mui/material\";\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      padding: 0,\n      margin: 0,\n      fontSize: \".9rem\",\n    },\n  });\n\ninterface IPanelTitle extends IconButtonProps {\n  classes: any;\n  children: any;\n}\n\nconst PanelTitle = ({ classes, children }: IPanelTitle) => {\n  return <h1 className={classes.root}>{children}</h1>;\n};\n\nexport default withStyles(styles)(PanelTitle);\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment } from \"react\";\n\ninterface TabPanelProps {\n  children?: React.ReactNode;\n  index: any;\n  value: any;\n}\n\nexport const TabPanel = (props: TabPanelProps) => {\n  const { children, value, index, ...other } = props;\n\n  return (\n    <div\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      style={{ marginTop: \"5px\" }}\n      {...other}\n    >\n      {value === index && <Fragment>{children}</Fragment>}\n    </div>\n  );\n};\n"],"names":["a11yProps","index","id","dispatch","useAppDispatch","navigate","useNavigate","params","useParams","loadingBucket","useSelector","selBucketDetailsLoading","useState","curTab","setCurTab","loadingPolicies","setLoadingPolicies","bucketPolicy","setBucketPolicy","loadingUsers","setLoadingUsers","bucketUsers","setBucketUsers","bucketName","displayPoliciesList","hasPermission","IAM_SCOPES","displayUsersList","viewUser","CONSOLE_UI_RESOURCE","viewPolicy","useEffect","PolicyActions","type","disableButtonFunction","onClick","policy","IAM_PAGES","encodeURLString","name","userTableActions","user","api","then","res","catch","err","setErrorSnackMessage","policies","Fragment","value","onChange","e","newValue","indicatorColor","textColor","variant","scrollButtons","label","scopes","resource","errorProps","disabled","noBackground","itemActions","columns","elementKey","isLoading","records","entityName","idField","matchAll","withStyles","theme","createStyles","root","padding","margin","fontSize","classes","children","className","TabPanel","props","other","role","hidden","style","marginTop"],"sourceRoot":""}
"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[3875],{21435:function(e,n,i){var t=i(29439),r=i(1413),s=i(72791),a=i(27391),o=i(61889),c=i(30829),l=i(20068),d=i(13400),p=i(20165),u=i(3579),x=i(11135),f=i(72455),h=i(25787),m=i(23814),g=i(75952),v=i(28182),j=i(80184),y=(0,f.Z)((function(e){return(0,x.Z)((0,r.Z)({},m.gM))}));function Z(e){var n=y();return(0,j.jsx)(a.Z,(0,r.Z)({InputProps:{classes:n}},e))}n.Z=(0,h.Z)((function(e){return(0,x.Z)((0,r.Z)((0,r.Z)((0,r.Z)({},m.YI),m.Hr),{},{textBoxContainer:{flexGrow:1,position:"relative"},overlayAction:{position:"absolute",right:5,top:6,"& svg":{maxWidth:15,maxHeight:15},"&.withLabel":{top:5}}}))}))((function(e){var n=e.label,i=e.onChange,a=e.value,x=e.id,f=e.name,h=e.type,m=void 0===h?"text":h,y=e.autoComplete,b=void 0===y?"off":y,C=e.disabled,K=void 0!==C&&C,w=e.multiline,S=void 0!==w&&w,k=e.tooltip,I=void 0===k?"":k,T=e.index,R=void 0===T?0:T,A=e.error,z=void 0===A?"":A,F=e.required,L=void 0!==F&&F,P=e.placeholder,E=void 0===P?"":P,B=e.min,N=e.max,M=e.overlayId,W=e.overlayIcon,O=void 0===W?null:W,q=e.overlayObject,D=void 0===q?null:q,H=e.extraInputProps,_=void 0===H?{}:H,Y=e.overlayAction,G=e.noLabelMinWidth,V=void 0!==G&&G,U=e.pattern,X=void 0===U?"":U,J=e.autoFocus,Q=void 0!==J&&J,$=e.classes,ee=e.className,ne=void 0===ee?"":ee,ie=e.onKeyPress,te=e.onFocus,re=e.onPaste,se=(0,r.Z)({"data-index":R},_),ae=(0,s.useState)(!1),oe=(0,t.Z)(ae,2),ce=oe[0],le=oe[1];"number"===m&&B&&(se.min=B),"number"===m&&N&&(se.max=N),""!==X&&(se.pattern=X);var de=O,pe=m;return"password"===m&&null===O&&(de=ce?(0,j.jsx)(p.Z,{}):(0,j.jsx)(u.Z,{}),pe=ce?"text":"password"),(0,j.jsx)(s.Fragment,{children:(0,j.jsxs)(o.ZP,{container:!0,className:(0,v.Z)(""!==ne?ne:"",""!==z?$.errorInField:$.inputBoxContainer),children:[""!==n&&(0,j.jsxs)(c.Z,{htmlFor:x,className:V?$.noMinWidthLabel:$.inputLabel,children:[(0,j.jsxs)("span",{children:[n,L?"*":""]}),""!==I&&(0,j.jsx)("div",{className:$.tooltipContainer,children:(0,j.jsx)(l.Z,{title:I,placement:"top-start",children:(0,j.jsx)("div",{className:$.tooltip,children:(0,j.jsx)(g.byK,{})})})})]}),(0,j.jsxs)("div",{className:$.textBoxContainer,children:[(0,j.jsx)(Z,{id:x,name:f,fullWidth:!0,value:a,autoFocus:Q,disabled:K,onChange:i,type:pe,multiline:S,autoComplete:b,inputProps:se,error:""!==z,helperText:z,placeholder:E,className:$.inputRebase,onKeyPress:ie,onFocus:te,onPaste:re}),de&&(0,j.jsx)("div",{className:"".concat($.overlayAction," ").concat(""!==n?"withLabel":""),children:(0,j.jsx)(d.Z,{onClick:Y?function(){Y()}:function(){return le(!ce)},id:M,size:"small",disableFocusRipple:!1,disableRipple:!1,disableTouchRipple:!1,children:de})}),D&&(0,j.jsx)("div",{className:"".concat($.overlayAction," ").concat(""!==n?"withLabel":""),children:D})]})]})})}))},93875:function(e,n,i){i.r(n),i.d(n,{default:function(){return R}});var t=i(93433),r=i(4942),s=i(1413),a=i(29439),o=i(72791),c=i(61889),l=i(64554),d=i(40986),p=i(57689),u=i(75952),x=i(9505),f=i(56087),h=i(74794),m=i(50896),g=i(87995),v=i(81551),j=i(78687),y=i(46078),Z=i(21435),b=i(27454),C=i(80184),K=function(e){var n=e.rowData,i=e.rowId,t=e.onFieldChange,r=e.onAddClick,s=e.onRemoveClick,a=e.canAdd,d=void 0===a||a,p=e.canRemove,x=void 0===p||p,f=e.showRowActions,h=void 0===f||f,m=e.disabledFields,g=void 0===m?[]:m,v=e.fieldErrors,j=void 0===v?{}:v,y=n.endpoint,K=void 0===y?"":y,w=n.accessKey,S=void 0===w?"":w,k=n.secretKey,I=void 0===k?"":k,T=n.name,R=void 0===T?"":T;return(0,C.jsxs)(o.Fragment,{children:[(0,C.jsx)(l.Z,{children:(0,C.jsx)(Z.Z,{id:"add-rep-peer-site-".concat(i),name:"add-rep-peer-site-".concat(i),placeholder:"site-name",label:"",extraInputProps:{readOnly:g.includes("name")},value:R,onChange:function(e){t(e,"name",i)},"data-test-id":"add-site-rep-peer-site-".concat(i)})}),(0,C.jsx)(l.Z,{children:(0,C.jsx)(Z.Z,{id:"add-rep-peer-site-ep-".concat(i),name:"add-rep-peer-site-ep-".concat(i),placeholder:"https://dr.minio-storage:900".concat(i),label:"",extraInputProps:{readOnly:g.includes("endpoint")},error:j.endpoint,value:K,onChange:function(e){t(e,"endpoint",i)},"data-test-id":"add-site-rep-peer-ep-".concat(i)})}),(0,C.jsx)(l.Z,{children:(0,C.jsx)(Z.Z,{id:"add-rep-peer-site-ac-".concat(i),name:"add-rep-peer-site-ac-".concat(i),label:"",required:!0,disabled:g.includes("accessKey"),value:S,error:j.accessKey,onChange:function(e){t(e,"accessKey",i)},"data-test-id":"add-rep-peer-site-ac-".concat(i)})}),(0,C.jsx)(l.Z,{children:(0,C.jsx)(Z.Z,{id:"add-rep-peer-site-sk-".concat(i),name:"add-rep-peer-site-sk-".concat(i),label:"",required:!0,type:"password",value:I,error:j.secretKey,disabled:g.includes("secretKey"),onChange:function(e){t(e,"secretKey",i)},"data-test-id":"add-rep-peer-site-sk-".concat(i)})}),(0,C.jsx)(c.ZP,{item:!0,xs:12,alignItems:"center",display:"flex",children:(0,C.jsx)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"baseline",marginTop:"4px","& button":{borderColor:"#696969",color:"#696969",borderRadius:"50%"}},children:h?(0,C.jsxs)(o.Fragment,{children:[(0,C.jsx)(b.Z,{tooltip:"Add a Row",children:(0,C.jsx)(u.zxk,{id:"add-row-".concat(i),variant:"regular",disabled:!d,icon:(0,C.jsx)(u.dtP,{}),onClick:function(e){e.preventDefault(),null===r||void 0===r||r(i)},style:{width:25,height:25,padding:0}})}),(0,C.jsx)(b.Z,{tooltip:"Remove Row",children:(0,C.jsx)(u.zxk,{id:"remove-row-".concat(i),variant:"regular",disabled:!x,icon:(0,C.jsx)(u.HFL,{}),onClick:function(e){e.preventDefault(),null===s||void 0===s||s(i)},style:{width:25,height:25,padding:0,marginLeft:8}})})]}):null})})]},"".concat(i))},w=i(47974),S=function(e){var n=!1;try{new URL(e),n=!0}catch(i){n=!1}return n?"":"Invalid Endpoint"},k=function(e){return""===(null===e||void 0===e?void 0:e.trim())},I=function(){return(0,C.jsxs)(o.Fragment,{children:[(0,C.jsx)(l.Z,{sx:{fontSize:"14px",marginLeft:"5px"},children:"Site Name"}),(0,C.jsxs)(l.Z,{sx:{fontSize:"14px",marginLeft:"5px"},children:["Endpoint ","*"]}),(0,C.jsxs)(l.Z,{sx:{fontSize:"14px",marginLeft:"5px"},children:["Access Key ","*"]}),(0,C.jsxs)(l.Z,{sx:{fontSize:"14px",marginLeft:"5px"},children:["Secret Key ","*"]}),(0,C.jsx)(l.Z,{children:" "})]})},T=function(e){var n=e.title;return(0,C.jsx)(c.ZP,{item:!0,xs:12,children:(0,C.jsx)(l.Z,{sx:{marginBottom:"15px",fontSize:"14px",fontWeight:600},children:n})})},R=function(){var e=(0,v.TL)(),n=(0,p.s0)(),i=(0,j.v9)(y.gK).serverEndPoint,Z=void 0===i?"":i,b=(0,o.useState)([{endpoint:Z,name:"",accessKey:"",secretKey:""}]),R=(0,a.Z)(b,2),A=R[0],z=R[1],F=(0,o.useState)([]),L=(0,a.Z)(F,2),P=L[0],E=L[1],B=function(){E([{endpoint:"",name:"",accessKey:"",secretKey:""}])},N=(0,x.Z)((function(e){var n=e.sites,i=e.name,t=n.findIndex((function(e){return e.name===i}));if(-1!==t){var r=n[t];r=(0,s.Z)((0,s.Z)({},r),{},{isCurrent:!0,isSaved:!0}),z([r]),n.splice(t,1)}n.sort((function(e,n){return e.name===i?-1:n.name===i?1:0}));var a=n.map((function(e){return(0,s.Z)((0,s.Z)({},e),{},{accessKey:"",secretKey:"",isSaved:!0})}));a.length?E(a):B()}),(function(e){B()})),M=(0,a.Z)(N,2),W=M[0],O=M[1],q=function(){O("GET","api/v1/admin/site-replication")};(0,o.useEffect)((function(){q()}),[]);var D=P.reduce((function(e,n,i){var t=P[i].endpoint,r=S(t);return""===r&&""!==t&&e.push(r),e}),[]),H=P.map((function(e){return!k(e.accessKey)&&!k(e.secretKey)})).filter(Boolean),_=A[0],Y=_.accessKey,G=_.secretKey,V=!k(Y)&&!k(G),U=D.length===P.length,X=H.length===P.length,J=V&&U&&X,Q=(0,x.Z)((function(i){i.success?(e((0,g.y1)(i.status)),ie(),q(),n(f.gA.SITE_REPLICATION)):e((0,g.Ih)({errorMessage:"Error",detailedError:i.status}))}),(function(n){e((0,g.Ih)(n))})),$=(0,a.Z)(Q,2),ee=$[0],ne=$[1],ie=function(){B(),z((function(e){return e.map((function(e,n){return(0,s.Z)((0,s.Z)({},e),{},{accessKey:"",secretKey:"",name:""})}))}))};return(0,C.jsxs)(o.Fragment,{children:[(0,C.jsx)(w.Z,{label:(0,C.jsx)(u.hbI,{label:"Add Replication Site",onClick:function(){return n(f.gA.SITE_REPLICATION)}})}),(0,C.jsx)(h.Z,{children:(0,C.jsxs)(l.Z,{sx:{display:"grid",padding:"25px",gap:"25px",gridTemplateColumns:"1fr",border:"1px solid #eaeaea"},children:[(0,C.jsxs)(l.Z,{children:[(0,C.jsx)(m.Z,{icon:(0,C.jsx)(u.aWt,{}),children:"Add Sites for Replication"}),W||ee?(0,C.jsx)(d.Z,{}):null,(0,C.jsx)(l.Z,{sx:{fontSize:"14px",fontStyle:"italic",marginTop:"10px",marginBottom:"10px"},children:"Note: AccessKey and SecretKey values for every site is required while adding or editing peer sites"}),(0,C.jsxs)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){return e.preventDefault(),function(){var e=null===A||void 0===A?void 0:A.map((function(e,n){return{accessKey:e.accessKey,secretKey:e.secretKey,name:e.name,endpoint:e.endpoint.trim()}})),n=P.reduce((function(e,n,i){return n.endpoint&&e.push({accessKey:n.accessKey,secretKey:n.secretKey,name:n.name||"dr-site-".concat(i),endpoint:n.endpoint.trim()}),e}),[]),i=e.concat(n);ne("POST","api/v1/admin/site-replication",i)}()},children:[(0,C.jsxs)(l.Z,{sx:{marginTop:"15px"},children:[(0,C.jsx)(T,{title:"This Site"}),(0,C.jsxs)(l.Z,{sx:{display:"grid",gridTemplateColumns:".8fr 1.2fr .8fr .8fr .2fr",border:"1px solid #eaeaea",padding:"15px",gap:"10px",maxHeight:"430px",overflowY:"auto"},children:[(0,C.jsx)(I,{}),A.map((function(e,n){var i=k(e.accessKey)?"AccessKey is required":"",t=k(e.secretKey)?"SecretKey is required":"";return(0,C.jsx)(K,{rowData:e,rowId:n,fieldErrors:{accessKey:i,secretKey:t},onFieldChange:function(e,n,i){var t=e.target.value;""!==n&&z((function(e){return e.map((function(e,a){return a===i?(0,s.Z)((0,s.Z)({},e),{},(0,r.Z)({},n,t)):e}))}))},showRowActions:!1},"current-".concat(n))}))]})]}),(0,C.jsxs)(l.Z,{sx:{marginTop:"25px"},children:[(0,C.jsx)(T,{title:"Peer Sites"}),(0,C.jsxs)(l.Z,{sx:{display:"grid",gridTemplateColumns:".8fr 1.2fr .8fr .8fr .2fr",border:"1px solid #eaeaea",padding:"15px",gap:"10px",maxHeight:"430px",overflowY:"auto"},children:[(0,C.jsx)(I,{}),P.map((function(e,n){var i=S(e.endpoint),a=k(e.accessKey)?"AccessKey is required":"",o=k(e.secretKey)?"SecretKey is required":"";return(0,C.jsx)(K,{rowData:e,rowId:n,fieldErrors:{endpoint:i,accessKey:a,secretKey:o},onFieldChange:function(e,n,i){var t=e.target.value;E((function(e){return e.map((function(e,a){return a===i?(0,s.Z)((0,s.Z)({},e),{},(0,r.Z)({},n,t)):e}))}))},canAdd:!0,canRemove:n>0&&!e.isSaved,onAddClick:function(){var e=(0,t.Z)(P);e.splice(n+1,0,{name:"",endpoint:"",accessKey:"",secretKey:""}),E(e)},onRemoveClick:function(e){E(P.filter((function(n,i){return i!==e})))}},"exiting-".concat(n))}))]})]}),(0,C.jsx)(c.ZP,{item:!0,xs:12,children:(0,C.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:"20px",gap:"15px"},children:[(0,C.jsx)(u.zxk,{id:"clear",type:"button",variant:"regular",disabled:ee,onClick:ie,label:"Clear"}),(0,C.jsx)(u.zxk,{id:"save",type:"submit",variant:"callAction",disabled:ee||!J,label:"Save"})]})})]})]}),(0,C.jsx)(u.KfX,{title:"",iconComponent:null,help:(0,C.jsxs)(o.Fragment,{children:[(0,C.jsxs)(l.Z,{sx:{marginTop:"-25px",fontSize:"16px",fontWeight:600,display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"2px"},children:[(0,C.jsx)(l.Z,{sx:{backgroundColor:"#07193E",height:"15px",width:"15px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",marginRight:"18px",padding:"3px",paddingLeft:"2px","& .min-icon":{height:"11px",width:"11px",fill:"#ffffff"}},children:(0,C.jsx)(u.aWt,{})}),"About Site Replication"]}),(0,C.jsxs)(l.Z,{sx:{display:"flex",flexFlow:"column",fontSize:"14px",flex:"2","& .step-number":{color:"#ffffff",height:"25px",width:"25px",background:"#081C42",marginRight:"10px",textAlign:"center",fontWeight:600,borderRadius:"50%"},"& li":{fontSize:"14px",display:"flex",marginTop:"15px",marginBottom:"15px",width:"100%","&.step-text":{fontWeight:400},"&:before":{content:"' '",height:"7px",width:"7px",backgroundColor:"#2781B0",marginRight:"10px",marginTop:"12px",flexShrink:0}}},children:[(0,C.jsx)(l.Z,{children:"The following changes are replicated to all other sites"}),(0,C.jsxs)("ul",{children:[(0,C.jsx)("li",{children:"Creation and deletion of buckets and objects"}),(0,C.jsx)("li",{children:"Creation and deletion of all IAM users, groups, policies and their mappings to users or groups"}),(0,C.jsx)("li",{children:"Creation of STS credentials"}),(0,C.jsx)("li",{children:"Creation and deletion of service accounts (except those owned by the root user)"}),(0,C.jsx)("li",{children:(0,C.jsxs)(l.Z,{style:{display:"flex",flexFlow:"column",justifyContent:"flex-start"},children:[(0,C.jsx)("div",{style:{paddingTop:"1px"},children:"Changes to Bucket features such as"}),(0,C.jsxs)("ul",{children:[(0,C.jsx)("li",{children:"Bucket Policies"}),(0,C.jsx)("li",{children:"Bucket Tags"}),(0,C.jsx)("li",{children:"Bucket Object-Lock configurations"}),(0,C.jsx)("li",{children:"Bucket Encryption configuration"})]})]})}),(0,C.jsx)("li",{children:(0,C.jsxs)(l.Z,{style:{display:"flex",flexFlow:"column",justifyContent:"flex-start"},children:[(0,C.jsx)("div",{style:{paddingTop:"1px"},children:"The following Bucket features will NOT be replicated"}),(0,C.jsxs)("ul",{children:[(0,C.jsx)("li",{children:"Bucket notification configuration"}),(0,C.jsx)("li",{children:"Bucket lifecycle (ILM) configuration"})]})]})})]})]})]})})]})})]})}},3579:function(e,n,i){var t=i(64836);n.Z=void 0;var r=t(i(45649)),s=i(80184),a=(0,r.default)((0,s.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"RemoveRedEye");n.Z=a},20165:function(e,n,i){var t=i(64836);n.Z=void 0;var r=t(i(45649)),s=i(80184),a=(0,r.default)((0,s.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff");n.Z=a}}]);
//# sourceMappingURL=3875.5db2c08f.chunk.js.map
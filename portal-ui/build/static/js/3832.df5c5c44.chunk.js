(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[3832],{63832:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var o=t(93433),i=t(29439),r=t(72791),s=t(95087),l=t(29945),a=t(78687),c=t(44690),d=t(26824),u=t(69129),x=t(87995),h=t(59114),g=t(81207),p=t(99779),f=t(26181),j=t.n(f),m=t(80184),v="HH:mm:ss ZZZZ MM/dd/yyyy",b=function(e){var n=e.log,t=(0,r.useState)(!1),o=(0,i.Z)(t,2),s=o[0],a=o[1],c=function(e){return j()(n,e,"")},d="",u=c("ConsoleMsg"),x=c("error.message");""!==u?d=u:""!==x&&(d=x);var h=(d||"").replace(/\u2501|\u250f|\u2513|\u2503|\u2517|\u251b/g,"");h=h.replace(/([^\x20-\x7F])/g,"");var g=(0,m.jsx)(r.Fragment,{});""!==u?g=function(e){var n=e.ConsoleMsg;return n=(n=n.replace(/\x1B/g," ")).replace(/((\[[0-9;]+m))/g,""),(0,m.jsx)("div",{style:{display:"table",tableLayout:"fixed",width:"100%",paddingLeft:10,paddingRight:10},children:(0,m.jsx)("div",{style:{display:"table-cell",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"auto"},children:(0,m.jsx)("pre",{children:n})})})}(n):""!==x&&(g=function(e){var n={color:"#C83B51",fontWeight:400,fontFamily:"monospace",fontSize:"12px"},t={fontFamily:"monospace",fontSize:"12px"},o=function(n){return j()(e,n,"")},i=p.ou.fromFormat(e.time.toString(),"HH:mm:ss z MM/dd/yyyy",{zone:"UTC"});return(0,m.jsxs)(r.Fragment,{children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("b",{style:t,children:"API:\xa0"}),(0,m.jsx)("span",{style:n,children:o("api.name")})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("b",{style:t,children:"Time:\xa0"}),(0,m.jsx)("span",{style:n,children:i.toFormat(v)})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("b",{style:t,children:"DeploymentID:\xa0"}),(0,m.jsx)("span",{style:n,children:o("deploymentid")})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("b",{style:t,children:"RequestID:\xa0"}),(0,m.jsx)("span",{style:n,children:o("requestID")})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("b",{style:t,children:"RemoteHost:\xa0"}),(0,m.jsx)("span",{style:n,children:o("remotehost")})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("b",{style:t,children:"UserAgent:\xa0"}),(0,m.jsx)("span",{style:n,children:o("userAgent")})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("b",{style:t,children:"Error:\xa0"}),(0,m.jsx)("span",{style:n,children:o("error.message")})]}),(0,m.jsx)("br",{}),(0,m.jsx)("div",{children:(0,m.jsx)("b",{style:t,children:"Backtrace:\xa0"})}),(e.error.source||[]).map((function(e,o){return(0,m.jsxs)("div",{children:[(0,m.jsxs)("b",{style:t,children:[o,":\xa0"]}),(0,m.jsx)("span",{style:n,children:e})]})}))]})}(n)),h=(h||"").replace(/((\[[0-9;]+m))/g,"");var f=p.ou.fromFormat(n.time.toString(),"HH:mm:ss z MM/dd/yyyy",{zone:"UTC"}),b=f.toJSDate(),y=(0,m.jsx)(r.Fragment,{children:f.toFormat(v)});return 1===b.getFullYear()&&(y=(0,m.jsx)(r.Fragment,{children:"n/a"})),(0,m.jsxs)(r.Fragment,{children:[(0,m.jsxs)(l.SCH,{sx:{cursor:"pointer",borderLeft:"0",borderRight:"0"},children:[(0,m.jsx)(l.pj1,{onClick:function(){return a(!s)},sx:{width:280,color:"#989898",fontSize:12},children:(0,m.jsxs)(l.xuv,{sx:{display:"flex",gap:1,alignItems:"center","& .min-icon":{width:12,marginRight:1},fontWeight:"bold",lineHeight:1},children:[(0,m.jsx)(l.AeX,{}),(0,m.jsx)("div",{children:y})]})}),(0,m.jsx)(l.pj1,{onClick:function(){return a(!s)},sx:{width:200,color:"#989898",fontSize:12},children:(0,m.jsx)(l.xuv,{sx:{"& .min-icon":{width:12,marginRight:1},fontWeight:"bold",lineHeight:1},children:n.errKind})}),(0,m.jsx)(l.pj1,{onClick:function(){return a(!s)},children:(0,m.jsx)(l.xuv,{sx:{display:"table",tableLayout:"fixed",width:"100%",paddingLeft:10,paddingRight:10},children:(0,m.jsx)(l.xuv,{sx:{display:"table-cell",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:h})})}),(0,m.jsx)(l.pj1,{onClick:function(){return a(!s)},sx:{width:40},children:(0,m.jsx)(l.xuv,{sx:{"& .min-icon":{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"2px"},"&:hover .min-icon":{fill:"#eaeaea"}},children:s?(0,m.jsx)(l.Ekf,{}):(0,m.jsx)(l._f_,{})})})]}),s?(0,m.jsxs)(l.SCH,{children:[(0,m.jsx)(l.pj1,{sx:{paddingBottom:0,paddingTop:0,width:200,textTransform:"uppercase",verticalAlign:"top",textAlign:"right",color:"#8399AB",fontWeight:"bold"},children:(0,m.jsx)(l.xuv,{sx:{marginTop:10},children:"Log Details"})}),(0,m.jsx)(l.pj1,{sx:{paddingBottom:0,paddingTop:0},colSpan:2,children:(0,m.jsx)(l.xuv,{sx:{margin:1,padding:4,fontSize:14},withBorders:!0,useBackground:!0,children:g})}),(0,m.jsx)(l.pj1,{sx:{paddingBottom:0,paddingTop:0,width:40}})]}):null]},f.toString())},y=t(47974),w=t(99670),S=null,C=function(){var e=(0,c.TL)(),n=(0,a.v9)((function(e){return e.logs.logMessages})),t=(0,a.v9)((function(e){return e.logs.logsStarted})),p=(0,r.useState)(""),f=(0,i.Z)(p,2),j=f[0],v=f[1],C=(0,r.useState)([""]),k=(0,i.Z)(C,2),A=k[0],Z=k[1],L=(0,r.useState)("all"),T=(0,i.Z)(L,2),F=T[0],_=T[1],O=(0,r.useState)("Select user agent"),I=(0,i.Z)(O,2),M=I[0],B=I[1],z=(0,r.useState)(["All User Agents"]),R=(0,i.Z)(z,2),H=R[0],E=R[1],U=(0,r.useState)("all"),N=(0,i.Z)(U,2),P=N[0],D=N[1],W=(0,r.useState)(!1),G=(0,i.Z)(W,2),X=G[0],q=G[1],J=j.toLowerCase(),K=n.filter((function(e){return(e.userAgent===M||"All User Agents"===M||"Select user agent"===M)&&(""===j||(e.ConsoleMsg.toLowerCase().indexOf(J)>=0||(!!(e.error&&e.error.source&&e.error.source.filter((function(e){return e.toLowerCase().indexOf(J)>=0})).length>0)||(!!(e.error&&e.error.message.toLowerCase().indexOf(J)>=0)||!!(e.api&&e.api.name.toLowerCase().indexOf(J)>=0)))))}));return(0,r.useEffect)((function(){q(!0),g.Z.invoke("GET","/api/v1/nodes").then((function(e){Z(e),q(!1)})).catch((function(e){q(!1)}))}),[]),(0,r.useEffect)((function(){e((0,x.Sc)("error_logs"))}),[]),(0,m.jsxs)(r.Fragment,{children:[(0,m.jsx)(y.Z,{label:"Logs",actions:(0,m.jsx)(w.Z,{})}),(0,m.jsx)(l.Xgh,{children:(0,m.jsxs)(l.rjZ,{container:!0,sx:{gap:15},children:[(0,m.jsx)(l.rjZ,{item:!0,xs:3,children:X?(0,m.jsx)("h3",{children:" Loading nodes"}):(0,m.jsx)(l.PhF,{id:"node-selector",name:"node","data-test-id":"node-selector",value:F,onChange:function(e){_(e)},disabled:X||t,options:[{label:"All Nodes",value:"all"}].concat((0,o.Z)(A.map((function(e){return{label:e,value:e}}))))})}),(0,m.jsx)(l.rjZ,{item:!0,xs:3,children:(0,m.jsx)(l.PhF,{id:"logType",name:"logType","data-test-id":"log-type",value:P,onChange:function(e){D(e)},disabled:X||t,options:[{value:"all",label:"All Log Types"},{value:"minio",label:"MinIO"},{value:"application",label:"Application"}]})}),(0,m.jsx)(l.rjZ,{item:!0,xs:3,children:H.length>1&&(0,m.jsx)(l.PhF,{id:"userAgent",name:"userAgent","data-test-id":"user-agent",value:M,onChange:function(e){B(e)},disabled:H.length<1||t,options:H.map((function(e){return{label:e,value:e}}))})}),(0,m.jsxs)(l.rjZ,{item:!0,xs:2,sx:{display:"flex",justifyContent:"flex-end"},children:[!t&&(0,m.jsx)(l.zxk,{id:"start-logs",type:"submit",variant:"callAction",disabled:!1,onClick:function(){e((0,u.i1)());var n=new URL(window.location.toString()),t=n.port,o=(0,d.x2)(n.protocol),i=new URL(document.baseURI).pathname;S=new s.w3cwebsocket("".concat(o,"://").concat(n.hostname,":").concat(t).concat(i,"ws/console/?logType=").concat(P,"&node=").concat("Select node"===F?"":F));var r=null;if(null!==S)return S.onopen=function(){console.log("WebSocket Client Connected"),e((0,u.v0)(!0)),S.send("ok"),r=setInterval((function(){S.send("ok")}),1e4)},S.onmessage=function(n){var t=JSON.parse(n.data.toString()),o=!0;""===t.level&&""===t.errKind&&"00:00:00 UTC 01/01/0001"===t.time&&""===t.ConsoleMsg&&""===t.node&&(o=!1),t.key=Math.random(),H.indexOf(t.userAgent)<0&&void 0!==t.userAgent&&(H.push(t.userAgent),E(H)),o&&e((0,u.Qo)(t))},S.onclose=function(){clearInterval(r),console.log("connection closed by server"),e((0,u.v0)(!1))},function(){S.close(1e3),clearInterval(r),console.log("closing websockets"),e((0,u.v0)(!1))}},label:"Start Logs"}),t&&(0,m.jsx)(l.zxk,{id:"stop-logs",type:"button",variant:"callAction",onClick:function(){null!==S&&void 0!==S&&(S.close(1e3),e((0,u.v0)(!1)))},label:"Stop Logs"})]}),(0,m.jsx)(l.rjZ,{item:!0,xs:12,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem","& button":{flexGrow:0,marginLeft:8,marginBottom:0}},children:(0,m.jsx)(h.Z,{placeholder:"Filter",onChange:function(e){v(e)},value:j})}),(0,m.jsx)(l.rjZ,{item:!0,xs:12,children:(0,m.jsx)(l.xuv,{id:"logs-container","data-test-id":"logs-list-container",sx:{minHeight:400,height:"calc(100vh - 200px)",overflow:"auto",fontSize:13,borderRadius:4},children:(0,m.jsxs)(l.xuv,{withBorders:!0,customBorderPadding:"0px",useBackground:!0,children:[(0,m.jsx)(l.iA_,{"aria-label":"collapsible table",children:(0,m.jsx)(l.RMI,{children:K.map((function(e){return(0,m.jsx)(b,{log:e})}))})}),0===K.length&&(0,m.jsx)(l.xuv,{sx:{padding:20,textAlign:"center"},children:"No logs to display"})]})})})]})})]})}},94210:function(e){var n=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}()},95087:function(e,n,t){var o;if("object"===typeof globalThis)o=globalThis;else try{o=t(94210)}catch(l){}finally{if(o||"undefined"===typeof window||(o=window),!o)throw new Error("Could not determine global this")}var i=o.WebSocket||o.MozWebSocket,r=t(51496);function s(e,n){return n?new i(e,n):new i(e)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(s,e,{get:function(){return i[e]}})})),e.exports={w3cwebsocket:i?s:null,version:r}},51496:function(e,n,t){e.exports=t(19794).version},19794:function(e){"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=3832.df5c5c44.chunk.js.map
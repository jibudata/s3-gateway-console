"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[3543],{74794:function(e,t,n){var s=n(1413),a=(n(72791),n(61889)),o=n(11135),i=n(25787),c=n(23814),r=n(80184);t.Z=(0,i.Z)((function(e){return(0,o.Z)((0,s.Z)({},c.Bw))}))((function(e){var t=e.classes,n=e.className,s=void 0===n?"":n,o=e.children;return(0,r.jsx)("div",{className:t.contentSpacer,children:(0,r.jsx)(a.ZP,{container:!0,children:(0,r.jsx)(a.ZP,{item:!0,xs:12,className:s,children:o})})})}))},33543:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var s=n(42982),a=n(70885),o=n(1413),i=n(72791),c=n(60364),r=n(26181),l=n.n(r),u=n(11135),d=n(25787),m=n(61889),h=n(36151),p=n(23814),g=n(45248),f=n(42649),x=n(81207),b=n(92983),j=n(27391),_=n(80184),C=(0,d.Z)((function(e){return(0,u.Z)({searchField:(0,o.Z)((0,o.Z)({},p.qg.searchField),{},{height:30,padding:0,"& input":{padding:"0 12px",height:28,fontSize:12,fontWeight:600,color:"#393939"},"&.isDisabled":{"&:hover":{borderColor:"#EAEDEE"}},"& input.Mui-disabled":{backgroundColor:"#EAEAEA"}}),labelStyle:{color:"#393939",fontSize:12,marginBottom:4},buttonKit:{display:"flex",alignItems:"center"},fieldContainer:{flexGrow:1,margin:"0 15px"}})}))((function(e){var t=e.classes,n=e.label,s=e.onChange,a=e.value,o=e.placeholder,c=void 0===o?"":o,r=e.id,l=e.name;return(0,_.jsx)(i.Fragment,{children:(0,_.jsxs)("div",{className:t.fieldContainer,children:[(0,_.jsx)("div",{className:t.labelStyle,children:n}),(0,_.jsx)("div",{className:t.buttonKit,children:(0,_.jsx)(j.Z,{placeholder:c,id:r,name:l,label:"",onChange:function(e){s(e.target.value)},InputProps:{disableUnderline:!0},className:t.searchField,value:a})})]})})})),Z=n(56028),S={time:"Timestamp",api_name:"API Name",access_key:"Access Key",bucket:"Bucket",object:"Object",remote_host:"Remote Host",request_id:"Request ID",user_agent:"User Agent",response_status:"Response Status",response_status_code:"Response Status Code",request_content_length:"Request Content Length",response_content_length:"Response Content Length",time_to_response_ns:"Time to Response NS"},y=(0,d.Z)((function(e){return(0,u.Z)((0,o.Z)({buttonContainer:{textAlign:"right"},objectKeyCol:{fontWeight:700,paddingRight:"10px",textAlign:"left"}},p.oO))}))((function(e){var t=e.modalOpen,n=e.logSearchElement,s=e.onClose,a=e.classes,o=Object.keys(n);return(0,_.jsx)(i.Fragment,{children:(0,_.jsx)(Z.Z,{modalOpen:t,title:"Full Log Information",onClose:function(){s()},children:(0,_.jsxs)(m.ZP,{container:!0,children:[(0,_.jsx)(m.ZP,{item:!0,xs:12,children:(0,_.jsx)("table",{children:(0,_.jsx)("tbody",{children:o.map((function(e,t){return(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{className:a.objectKeyCol,children:l()(S,e,"".concat(e))}),(0,_.jsx)("td",{children:l()(n,e,"")})]},"logSearch-".concat(t.toString()))}))})})}),(0,_.jsx)(m.ZP,{item:!0,xs:12,className:a.buttonContainer,children:(0,_.jsx)(h.Z,{type:"button",variant:"contained",color:"primary",onClick:s,children:"Close"})})]})})})})),v=n(63856),k=n(32291),N=n(74794),E=n(93385),A=n(56087),F=n(38442),P=n(74833),K=n(23804),O=function(e){var t=e.iconComponent,n=e.entity,s=e.documentationLink;return(0,_.jsx)(m.ZP,{container:!0,justifyContent:"center",alignContent:"center",alignItems:"center",children:(0,_.jsx)(m.ZP,{item:!0,xs:8,children:(0,_.jsx)(K.Z,{title:"".concat(n," not available"),iconComponent:t,help:(0,_.jsxs)(i.Fragment,{children:["This feature is not available.",(0,_.jsx)("br",{}),"Please configure"," ",(0,_.jsx)("a",{href:s,target:"_blank",rel:"noreferrer",children:n})," ","first to use this feature."]})})})})},q={setErrorSnackMessage:f.Ih},B=(0,c.$j)((function(e){return{features:e.console.session.features}}),q),I=(0,d.Z)((function(e){return(0,u.Z)((0,o.Z)((0,o.Z)((0,o.Z)((0,o.Z)({blockCollapsed:{display:"none",overflowY:"hidden"},filterOpen:{display:"block",marginBottom:12},endLineAction:{marginBottom:15,padding:"0 15px 0 15px",display:"flex",alignItems:"center",justifyContent:"flex-end"},filtersContainer:{display:"flex",justifyContent:"space-between",marginBottom:12},innerContainer:{backgroundColor:"#fff"},noticeLabel:{marginLeft:15,marginBottom:15,fontSize:12,color:"#9C9C9C"},tableFOpen:{height:"calc(100vh - 520px)"},tableFClosed:{height:"calc(100vh - 320px)"}},p.VX),p.S),{},{searchOptions:{display:"flex",padding:15,"@media (max-width: 900px)":{flexFlow:"column"}},formBox:{border:"1px solid #EAEAEA",marginBottom:15},dateRangePicker:{"& div":{marginBottom:0}},advancedButton:{display:"flex",alignItems:"center",justifyContent:"flex-start"}},p.o$),(0,p.Bz)(e.spacing(4))))}))(B((function(e){var t=e.classes,n=e.features,o=e.setErrorSnackMessage,c=(0,i.useState)(!0),r=(0,a.Z)(c,2),u=r[0],d=r[1],p=(0,i.useState)(null),f=(0,a.Z)(p,2),j=f[0],Z=f[1],K=(0,i.useState)(null),q=(0,a.Z)(K,2),B=q[0],I=q[1],L=(0,i.useState)(!1),w=(0,a.Z)(L,2),R=w[0],D=w[1],T=(0,i.useState)([]),M=(0,a.Z)(T,2),z=M[0],H=M[1],W=(0,i.useState)(""),G=(0,a.Z)(W,2),U=G[0],Y=G[1],$=(0,i.useState)(""),V=(0,a.Z)($,2),X=V[0],J=V[1],Q=(0,i.useState)(""),ee=(0,a.Z)(Q,2),te=ee[0],ne=ee[1],se=(0,i.useState)(""),ae=(0,a.Z)(se,2),oe=ae[0],ie=ae[1],ce=(0,i.useState)(""),re=(0,a.Z)(ce,2),le=re[0],ue=re[1],de=(0,i.useState)(""),me=(0,a.Z)(de,2),he=me[0],pe=me[1],ge=(0,i.useState)(""),fe=(0,a.Z)(ge,2),xe=fe[0],be=fe[1],je=(0,i.useState)("DESC"),_e=(0,a.Z)(je,2),Ce=_e[0],Ze=_e[1],Se=(0,i.useState)(["time","api_name","access_key","bucket","object","remote_host","request_id","user_agent","response_status"]),ye=(0,a.Z)(Se,2),ve=ye[0],ke=ye[1],Ne=(0,i.useState)(0),Ee=(0,a.Z)(Ne,2),Ae=Ee[0],Fe=Ee[1],Pe=(0,i.useState)(!1),Ke=(0,a.Z)(Pe,2),Oe=Ke[0],qe=Ke[1],Be=(0,i.useState)(!1),Ie=(0,a.Z)(Be,2),Le=Ie[0],we=Ie[1],Re=(0,i.useState)(null),De=(0,a.Z)(Re,2),Te=De[0],Me=De[1],ze=null,He=n&&n.includes("log-search"),We=(0,i.useCallback)((function(){if(!Oe&&He){qe(!0);var e="".concat(""!==U?"&fp=bucket:".concat(U):"").concat(""!==le?"&fp=object:".concat(le):"").concat(""!==X?"&fp=api_name:".concat(X):"").concat(""!==te?"&fp=access_key:".concat(te):"").concat(""!==he?"&fp=request_id:".concat(he):"").concat(""!==oe?"&fp=user_agent:".concat(oe):"").concat(""!==xe?"&fp=response_status:".concat(xe):"");(e=e.trim()).endsWith(",")&&(e=e.slice(0,-1)),x.Z.invoke("GET","/api/v1/logs/search?q=reqinfo".concat(""!==e?"".concat(e):"","&pageSize=100&pageNo=").concat(Ae,"&order=").concat("DESC"===Ce?"timeDesc":"timeAsc").concat(null!==j?"&timeStart=".concat(j.toISOString()):"").concat(null!==B?"&timeEnd=".concat(B.toISOString()):"")).then((function(e){var t=e.results||[];d(!1),qe(!1),H(t),Fe(Ae+1),null!==ze&&ze()})).catch((function(e){d(!1),qe(!1),o(e)}))}else d(!1),qe(!1)}),[Oe,He,U,le,X,te,he,oe,xe,Ae,Ce,j,B,ze,o]);(0,i.useEffect)((function(){u&&(H([]),We())}),[u,Ce,We]);return(0,_.jsxs)(i.Fragment,{children:[Le&&null!==Te&&(0,_.jsx)(y,{logSearchElement:Te,modalOpen:Le,onClose:function(){Me(null),we(!1)}}),(0,_.jsx)(k.Z,{label:"Audit Logs"}),(0,_.jsx)(N.Z,{children:He?(0,_.jsxs)(i.Fragment,{children:[" ",(0,_.jsxs)(m.ZP,{xs:12,className:t.formBox,children:[(0,_.jsxs)(m.ZP,{item:!0,xs:12,className:"".concat(t.searchOptions),children:[(0,_.jsx)("div",{className:t.dateRangePicker,children:(0,_.jsx)(v.Z,{setTimeEnd:I,setTimeStart:Z,timeEnd:B,timeStart:j})}),(0,_.jsx)(m.ZP,{item:!0,className:t.advancedButton,children:(0,_.jsxs)("button",{onClick:function(){D(!R)},className:t.advancedConfiguration,children:[R?"Hide":"Show"," advanced Filters"," ",(0,_.jsx)("span",{className:R?t.advancedOpen:t.advancedClosed,children:(0,_.jsx)(E.Z,{})})]})})]}),(0,_.jsx)(m.ZP,{item:!0,xs:12,className:"".concat(t.blockCollapsed," ").concat(R?t.filterOpen:""),children:(0,_.jsxs)("div",{className:t.innerContainer,children:[(0,_.jsxs)("div",{className:t.noticeLabel,children:["Enable your preferred options to get filtered records.",(0,_.jsx)("br",{}),"You can use '*' to match any character, '.' to signify a single character or '\\' to scape an special character (E.g. mybucket-*)"]}),(0,_.jsxs)("div",{className:t.filtersContainer,children:[(0,_.jsx)(C,{onChange:Y,value:U,label:"Bucket",id:"bucket",name:"bucket"}),(0,_.jsx)(C,{onChange:J,value:X,label:"API Name",id:"api_name",name:"api_name"}),(0,_.jsx)(C,{onChange:ne,value:te,label:"Access Key",id:"access_key",name:"access_key"}),(0,_.jsx)(C,{onChange:ie,value:oe,label:"User Agent",id:"user_agent",name:"user_agent"})]}),(0,_.jsxs)("div",{className:t.filtersContainer,children:[(0,_.jsx)(C,{onChange:ue,value:le,label:"Object",id:"object",name:"object"}),(0,_.jsx)(C,{onChange:pe,value:he,label:"Request ID",id:"request_id",name:"request_id"}),(0,_.jsx)(C,{onChange:be,value:xe,label:"Response Status",id:"response_status",name:"response_status"})]})]})}),(0,_.jsx)(m.ZP,{item:!0,xs:12,className:t.endLineAction,children:(0,_.jsx)(h.Z,{type:"button",variant:"contained",color:"primary",onClick:function(){Fe(0),d(!0)},children:"Get Information"})})]}),(0,_.jsx)(m.ZP,{item:!0,xs:12,className:t.tableBlock,children:(0,_.jsx)(F.s,{scopes:[A.Ft.ADMIN_HEALTH_INFO],resource:A.C3,errorProps:{disabled:!0},children:(0,_.jsx)(b.Z,{columns:[{label:S.time,elementKey:"time",enableSort:!0},{label:S.api_name,elementKey:"api_name"},{label:S.access_key,elementKey:"access_key"},{label:S.bucket,elementKey:"bucket"},{label:S.object,elementKey:"object"},{label:S.remote_host,elementKey:"remote_host"},{label:S.request_id,elementKey:"request_id"},{label:S.user_agent,elementKey:"user_agent"},{label:S.response_status,elementKey:"response_status",renderFunction:function(e){return(0,_.jsx)(i.Fragment,{children:(0,_.jsxs)("span",{children:[e.response_status_code," (",e.response_status,")"]})})},renderFullObject:!0},{label:S.request_content_length,elementKey:"request_content_length",renderFunction:g.ae},{label:S.response_content_length,elementKey:"response_content_length",renderFunction:g.ae},{label:S.time_to_response_ns,elementKey:"time_to_response_ns",renderFunction:g.Yj,contentTextAlign:"right"}],isLoading:u,records:z,entityName:"Logs",customEmptyMessage:"There is no information with this criteria",idField:"request_id",columnsSelector:!0,columnsShown:ve,onColumnChange:function(e,t){var n=(0,s.Z)(ve);t?n.includes(e)||n.push(e):n=ve.filter((function(t){return t!==e})),ke(n)},customPaperHeight:R?t.tableFOpen:t.tableFClosed,sortConfig:{currentSort:"time",currentDirection:Ce,triggerSort:function(e){var t=l()(e,"sortDirection","DESC");Ze(t),Fe(0),d(!0)}},infiniteScrollConfig:{recordsCount:1e6,loadMoreRecords:function(e){return We(),new Promise((function(e){ze=e}))}},itemActions:[{type:"view",onClick:function(e){Me(e),we(!0)}}],textSelectable:!0})})})]}):(0,_.jsx)(O,{entity:"Audit Logs",iconComponent:(0,_.jsx)(P.W1,{}),documentationLink:"https://github.com/minio/operator/tree/master/logsearchapi"})})]})})))}}]);
//# sourceMappingURL=3543.7f1f5dd1.chunk.js.map
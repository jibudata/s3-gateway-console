"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[9952],{99952:function(e,n,t){t.r(n),t.d(n,{default:function(){return Z}});var s=t(74165),a=t(15861),r=t(29439),i=t(72791),c=t(29945),o=t(66315),l=t(31776),u=t(82342),d=t(23814),f=t(87995),p=t(44690),x=t(56087),m=t(38442),h=t(27454),k=t(9505),b=t(23508),y=t(40214),j=t(80184),v=function(e){var n=e.closeAddModalAndRefresh,t=e.addOpen,s=(0,p.TL)(),a=(0,k.Z)((function(){return n(!0)}),(function(e){n(!1),s((0,f.Ih)(e))})),o=(0,r.Z)(a,2),l=o[0],u=o[1],d=(0,i.useState)(""),x=(0,r.Z)(d,2),m=x[0],h=x[1];return(0,j.jsx)(b.Z,{title:"",confirmText:"Create",isOpen:t,isLoading:l,onConfirm:function(){u("POST","/api/v1/kms/keys/",{key:m})},onClose:function(){return n(!1)},confirmButtonProps:{disabled:-1!==m.indexOf(" ")||""===m||l,variant:"callAction"},confirmationContent:(0,j.jsxs)(i.Fragment,{children:[(0,j.jsx)(y.Z,{helpText:"Create Key",contents:["Create a new cryptographic key in the Key Management Service server connected to MINIO."]}),(0,j.jsx)(c.rjZ,{item:!0,xs:12,sx:{marginTop:15},children:(0,j.jsx)(c.Wzg,{id:"key-name",name:"key-name",label:"Key Name",autoFocus:!0,value:m,error:-1!==m.indexOf(" ")?"Key name cannot contain spaces":"",onChange:function(e){h(e.target.value)}})})]})})},S=t(56028),Z=function(e){var n=e.open,t=e.encryptionCfg,k=e.selectedBucket,b=e.closeModalAndRefresh,y=(0,p.TL)(),Z=(0,i.useState)(!1),g=(0,r.Z)(Z,2),C=g[0],K=g[1],E=(0,i.useState)(""),M=(0,r.Z)(E,2),A=M[0],I=M[1],T=(0,i.useState)("disabled"),B=(0,r.Z)(T,2),O=B[0],w=B[1],P=(0,i.useState)([]),z=(0,r.Z)(P,2),D=z[0],F=z[1],J=(0,i.useState)(!1),L=(0,r.Z)(J,2),R=L[0],_=L[1],N=(0,i.useState)(!1),X=(0,r.Z)(N,2),Y=X[0],V=X[1];(0,i.useEffect)((function(){t&&("AES256"===t.algorithm?w(o.bJ.SseS3):(w(o.bJ.SseKms),I(t.kmsMasterKeyID||"")))}),[t]),(0,i.useEffect)((function(){"sse-kms"===O&&l.h.kms.kmsListKeys().then((function(e){F(e.data.results),_(!1)})).catch((function(e){_(!1),y((0,f.zb)((0,u.g)(e.error)))}))}),[O,R,y]);return(0,j.jsxs)(i.Fragment,{children:[Y&&(0,j.jsx)(v,{addOpen:Y,closeAddModalAndRefresh:function(e){V(!1),_(!0)}}),(0,j.jsx)(S.Z,{modalOpen:n,onClose:function(){b()},title:"Enable Bucket Encryption",titleIcon:(0,j.jsx)(c.Xn4,{}),children:(0,j.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault(),C||("disabled"===O?l.h.buckets.disableBucketEncryption(k).then((function(){K(!1),b()})).catch(function(){var e=(0,a.Z)((0,s.Z)().mark((function e(n){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:t=e.sent,K(!1),y((0,f.zb)((0,u.g)(t)));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()):l.h.buckets.enableBucketEncryption(k,{encType:O,kmsKeyID:A}).then((function(){K(!1),b()})).catch(function(){var e=(0,a.Z)((0,s.Z)().mark((function e(n){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:t=e.sent,K(!1),y((0,f.zb)((0,u.g)(t)));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()))},children:(0,j.jsxs)(c.ltY,{withBorders:!1,containerPadding:!1,children:[(0,j.jsx)(c.PhF,{onChange:function(e){w(e)},id:"select-encryption-type",name:"select-encryption-type",label:"Encryption Type",value:O,options:[{label:"Disabled",value:"disabled"},{label:"SSE-S3",value:o.bJ.SseS3},{label:"SSE-KMS",value:o.bJ.SseKms}]}),"sse-kms"===O&&(0,j.jsxs)(c.xuv,{sx:{display:"flex",gap:10},className:"inputItem",children:[D&&(0,j.jsx)(c.PhF,{onChange:function(e){I(e)},id:"select-kms-key-id",name:"select-kms-key-id",label:"KMS Key ID",value:A,options:D.map((function(e){return{label:e.name||"",value:e.name||""}}))}),(0,j.jsx)(m.s,{scopes:[x.Ft.KMS_IMPORT_KEY],resource:x.C3,errorProps:{disabled:!0},children:(0,j.jsx)(h.Z,{tooltip:"Add key",children:(0,j.jsx)(c.zxk,{id:"import-key",variant:"regular",icon:(0,j.jsx)(c.dtP,{}),onClick:function(e){V(!0),e.preventDefault()}})})})]}),(0,j.jsxs)(c.rjZ,{item:!0,xs:12,sx:d.ID.modalButtonBar,children:[(0,j.jsx)(c.zxk,{id:"cancel",type:"submit",variant:"regular",onClick:function(){b()},disabled:C,label:"Cancel"}),(0,j.jsx)(c.zxk,{id:"save",type:"submit",variant:"callAction",disabled:C,label:"Save"})]}),C&&(0,j.jsx)(c.rjZ,{item:!0,xs:12,children:(0,j.jsx)(c.kod,{})})]})})})]})}},40214:function(e,n,t){var s=t(72791),a=t(29945),r=t(80184);n.Z=function(e){var n=e.helpText,t=e.contents;return(0,r.jsx)(a.KfX,{iconComponent:(0,r.jsx)(a.M9A,{}),title:n,help:(0,r.jsx)(s.Fragment,{children:t.map((function(e){return(0,r.jsx)(a.xuv,{sx:{paddingBottom:"20px"},children:e})}))})})}}}]);
//# sourceMappingURL=9952.977159a7.chunk.js.map
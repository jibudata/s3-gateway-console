"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[5367],{15367:function(e,t,n){n.r(t);var a=n(29439),i=n(1413),r=n(11135),o=n(25787),s=n(23814),l=n(72791),c=n(60364),u=n(25469),d=n(81207),m=n(16871),g=n(37516),v=n(61889),h=n(21435),p=n(51691),x=n(36151),f=n(2148),Z=n(87995),y=n(32509),j=n(56578),C=n(25693),b=n(84741),N=n(18158),A=n(80184);t.default=(0,o.Z)((function(e){return(0,r.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},s.oZ),s.bK),{},{bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},fileItem:{marginRight:10,display:"flex","& div label":{minWidth:50},"@media (max-width: 900px)":{flexFlow:"column"}}},(0,s.Bz)(e.spacing(4))),s.QV),s.DF),s.oO),s.AK))}))((function(e){var t=e.classes,n=(0,u.TL)(),i=(0,m.UO)(),r=i.tenantName,o=i.tenantNamespace,s=(0,c.v9)((function(e){return e.editTenantMonitoring.prometheusEnabled})),R=(0,c.v9)((function(e){return e.editTenantMonitoring.image})),S=(0,c.v9)((function(e){return e.editTenantMonitoring.sidecarImage})),k=(0,c.v9)((function(e){return e.editTenantMonitoring.initImage})),G=(0,c.v9)((function(e){return e.editTenantMonitoring.diskCapacityGB})),P=(0,c.v9)((function(e){return e.editTenantMonitoring.monitoringCPURequest})),I=(0,c.v9)((function(e){return e.editTenantMonitoring.monitoringMemRequest})),q=(0,c.v9)((function(e){return e.editTenantMonitoring.serviceAccountName})),M=(0,c.v9)((function(e){return e.editTenantMonitoring.storageClassName})),T=(0,l.useState)({}),w=(0,a.Z)(T,2),B=w[0],U=w[1],F=(0,l.useState)(!1),_=(0,a.Z)(F,2),z=_[0],E=_[1],L=(0,l.useState)([{key:"",value:""}]),V=(0,a.Z)(L,2),O=V[0],D=V[1],X=(0,l.useState)([{key:"",value:""}]),K=(0,a.Z)(X,2),$=K[0],H=K[1],Q=(0,l.useState)([{key:"",value:""}]),W=(0,a.Z)(Q,2),J=W[0],Y=W[1],ee=(0,l.useState)(!0),te=(0,a.Z)(ee,2),ne=te[0],ae=te[1],ie=(0,l.useState)({}),re=(0,a.Z)(ie,2),oe=re[0],se=re[1],le=(0,l.useState)({}),ce=(0,a.Z)(le,2),ue=ce[0],de=ce[1],me=(0,l.useState)({}),ge=(0,a.Z)(me,2),ve=ge[0],he=ge[1],pe=(0,c.v9)((function(e){return e.editTenantMonitoring.runAsGroup})),xe=(0,c.v9)((function(e){return e.editTenantMonitoring.runAsUser})),fe=(0,c.v9)((function(e){return e.editTenantMonitoring.fsGroup})),Ze=(0,c.v9)((function(e){return e.editTenantMonitoring.runAsNonRoot})),ye=function(e){U((0,b.he)(B,e))},je=function(e){for(var t=[],n=0;n<e.length;n++)""!==e[n].key&&t.push(e[n]);return t},Ce=function(){if(0!==Object.keys(B).length||0!==Object.keys(oe).length||0!==Object.keys(ue).length||0!==Object.keys(ve).length){return n((0,Z.Ih)({errorMessage:"Invalid entry",detailedError:""})),!1}return!0};(0,l.useEffect)((function(){ne&&d.Z.invoke("GET","/api/v1/namespaces/".concat(o||"","/tenants/").concat(r||"","/monitoring")).then((function(e){n((0,C.bX)(e.prometheusEnabled)),function(e){n((0,C.QL)(e.image)),n((0,C.Ct)(e.sidecarImage)),n((0,C.Xz)(e.initImage)),n((0,C.cj)(e.storageClassName)),n((0,C.Tg)(e.diskCapacityGB)),n((0,C.qX)(e.serviceAccountName)),n((0,C.AC)(e.monitoringCPURequest)),e.monitoringMemRequest?n((0,C.bZ)(Math.floor(parseInt(e.monitoringMemRequest,10)/1e9).toString())):n((0,C.bZ)("0")),null!=e.labels?D(e.labels):D([{key:"",value:""}]),null!=e.annotations?H(e.annotations):H([{key:"",value:""}]),null!=e.nodeSelector?Y(e.nodeSelector):Y([{key:"",value:""}]),n((0,C.Be)(e.securityContext.runAsGroup)),n((0,C.wT)(e.securityContext.runAsUser)),n((0,C.vM)(e.securityContext.runAsNonRoot)),n((0,C.FP)(e.securityContext.fsGroup))}(e),ae(!1)})).catch((function(e){n((0,Z.Ih)(e)),ae(!1)}))}),[ne]);return(0,A.jsxs)(l.Fragment,{children:[z&&(0,A.jsx)(f.Z,{isOpen:z,title:s?"Disable Prometheus monitoring for this tenant?":"Enable Prometheus monitoring for this tenant?",confirmText:s?"Disable":"Enable",cancelText:"Cancel",onClose:function(){return E(!1)},onConfirm:function(){var e={prometheusEnabled:s,toggle:!0};d.Z.invoke("PUT","/api/v1/namespaces/".concat(o,"/tenants/").concat(r,"/monitoring"),e).then((function(){n((0,C.bX)(!s)),ae(!0),E(!1),ae(!0)})).catch((function(e){n((0,Z.Ih)(e))}))},confirmationContent:(0,A.jsx)(p.Z,{children:s?" Current configuration will be lost, and defaults reset if reenabled.":"A small Prometheus server will be started per the configuration provided, which will collect the Prometheus metrics for your tenant."})}),(0,A.jsxs)(v.ZP,{container:!0,spacing:1,children:[(0,A.jsx)(v.ZP,{item:!0,xs:!0,children:(0,A.jsx)("h1",{className:t.sectionTitle,children:"Prometheus Monitoring "})}),(0,A.jsx)(v.ZP,{item:!0,xs:7,justifyContent:"end",textAlign:"right",children:(0,A.jsx)(g.Z,{label:"",indicatorLabels:["Enabled","Disabled"],checked:s,value:"tenant_monitoring",id:"tenant-monitoring",name:"tenant-monitoring",onChange:function(){E(!0)},description:""})}),(0,A.jsx)(v.ZP,{item:!0,xs:12,children:(0,A.jsx)("hr",{className:t.hrClass})})]}),s&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(v.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,A.jsx)(h.Z,{id:"prometheus_image",label:"Image",placeholder:"quay.io/prometheus/prometheus:latest",name:"image",value:R,onChange:function(e){e.target.validity.valid&&n((0,C.QL)(e.target.value)),ye("image")},pattern:b.lN,error:B.image||""},"image")}),(0,A.jsx)(v.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,A.jsx)(h.Z,{id:"sidecarImage",label:"Sidecar Image",placeholder:"library/alpine:latest",name:"sidecarImage",value:S,onChange:function(e){e.target.validity.valid&&n((0,C.Ct)(e.target.value)),ye("sidecarImage")},pattern:b.lN,error:B.sidecarImage||""},"sidecarImage")}),(0,A.jsx)(v.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,A.jsx)(h.Z,{id:"initImage",label:"Init Image",placeholder:"library/busybox:1.33.1",name:"initImage",value:k,onChange:function(e){e.target.validity.valid&&n((0,C.Xz)(e.target.value)),ye("initImage")},pattern:b.lN,error:B.initImage||""},"initImage")}),(0,A.jsx)(v.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,A.jsx)(h.Z,{id:"diskCapacityGB",label:"Disk Capacity",placeholder:"Disk Capacity",name:"diskCapacityGB",value:G,onChange:function(e){e.target.validity.valid&&n((0,C.Tg)(e.target.value)),ye("diskCapacityGB")},pattern:b.ux,error:B.diskCapacityGB||"",overlayObject:(0,A.jsx)(j.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"diskCapacityGB")}),(0,A.jsx)(v.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,A.jsx)(h.Z,{id:"cpuRequest",label:"CPU Request",placeholder:"CPU Request",name:"cpuRequest",value:P,pattern:b.ux,onChange:function(e){e.target.validity.valid&&n((0,C.AC)(e.target.value)),ye("cpuRequest")},error:B.cpuRequest||""},"cpuRequest")}),(0,A.jsx)(v.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,A.jsx)(h.Z,{id:"memRequest",label:"Memory Request",placeholder:"Memory request",name:"memRequest",value:I,onChange:function(e){e.target.validity.valid&&n((0,C.bZ)(e.target.value)),ye("memRequest")},pattern:b.ux,error:B.memRequest||"",overlayObject:(0,A.jsx)(j.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"memRequest")}),(0,A.jsx)(v.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,A.jsx)(h.Z,{id:"serviceAccountName",label:"Service Account",placeholder:"Service Account Name",name:"serviceAccountName",value:q,onChange:function(e){e.target.validity.valid&&n((0,C.qX)(e.target.value)),ye("serviceAccountName")},pattern:"^[a-zA-Z0-9-.]{1,253}$",error:B.serviceAccountName||""},"serviceAccountName")}),(0,A.jsx)(v.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,A.jsx)(h.Z,{id:"storageClassName",label:"Storage Class",placeholder:"Storage Class Name",name:"storageClassName",value:M,onChange:function(e){e.target.validity.valid&&n((0,C.cj)(e.target.value)),ye("storageClassName")},pattern:"^[a-zA-Z0-9-.]{1,253}$",error:B.storageClassName||""},"storageClassName")}),null!==O&&(0,A.jsxs)(v.ZP,{item:!0,xs:12,className:t.formFieldRow,children:[(0,A.jsx)("span",{className:t.inputLabel,children:"Labels"}),(0,A.jsx)(y.Z,{newValues:O,setNewValues:D,paramName:"Labels",error:oe,setError:se})]}),null!==$&&(0,A.jsxs)(v.ZP,{item:!0,xs:12,className:t.formFieldRow,children:[(0,A.jsx)("span",{className:t.inputLabel,children:"Annotations"}),(0,A.jsx)(y.Z,{newValues:$,setNewValues:H,paramName:"Annotations",error:ue,setError:de})]}),null!==J&&(0,A.jsxs)(v.ZP,{item:!0,xs:12,className:t.formFieldRow,children:[(0,A.jsx)("span",{className:t.inputLabel,children:"Node Selector"}),(0,A.jsx)(y.Z,{newValues:J,setNewValues:Y,paramName:"Node Selector",error:ve,setError:he})]}),(0,A.jsx)(v.ZP,{item:!0,xs:12,className:t.formFieldRow,children:(0,A.jsx)(N.Z,{classes:t,runAsGroup:pe,runAsUser:xe,fsGroup:fe,runAsNonRoot:Ze,setFSGroup:function(e){return n((0,C.FP)(e))},setRunAsUser:function(e){return n((0,C.wT)(e))},setRunAsGroup:function(e){return n((0,C.Be)(e))},setRunAsNonRoot:function(e){return n((0,C.vM)(e))}})}),(0,A.jsx)(v.ZP,{item:!0,xs:12,textAlign:"right",children:(0,A.jsx)(x.Z,{type:"submit",id:"submit_button",variant:"contained",color:"primary",disabled:!Ce(),onClick:function(){return function(){if(Ce()){var e={runAsGroup:null!=pe?pe:"0",runAsUser:null!=xe?xe:"0",fsGroup:null!=fe?fe:"0",runAsNonRoot:null==Ze||Ze};d.Z.invoke("PUT","/api/v1/namespaces/".concat(o,"/tenants/").concat(r,"/monitoring"),{labels:je(O),annotations:je($),nodeSelector:je(J),image:R,sidecarImage:S,initImage:k,diskCapacityGB:G,serviceAccountName:q,storageClassName:M,monitoringCPURequest:P,monitoringMemRequest:I+"Gi",securityContext:e}).then((function(){ae(!0),n((0,Z.y1)("Prometheus configuration updated."))})).catch((function(e){(0,Z.Ih)(e)}))}}()},children:"Save"})})]})]})}))},32509:function(e,t,n){var a=n(93433),i=n(1413),r=n(72791),o=n(11135),s=n(25787),l=n(23814),c=n(21435),u=n(20068),d=n(13400),m=n(42419),g=n(27247),v=n(40968),h=n(84741),p=n(61889),x=n(80184);t.Z=(0,s.Z)((function(e){return(0,o.Z)((0,i.Z)({bottomContainer:{display:"flex",flexGrow:1,alignItems:"center","& div":{flexGrow:1,width:"100%"}},shortened:{gridTemplateColumns:"auto auto 20px 20px",display:"grid",gridGap:20,paddingRight:20}},l.oO))}))((function(e){var t=e.classes,n=e.paramName,i=e.newValues,o=e.setNewValues,s=e.error,l=e.setError,f=function(e){l((0,h.he)(s,e))};(0,r.useEffect)((function(){for(var e=[],t=0;t<i.length;t++)e.push({fieldKey:"key-".concat(t.toString()),required:!1,value:i[t].key,pattern:/^[a-zA-Z0-9-_.]{1,63}$/,customPatternMessage:"Invalid key"}),e.push({fieldKey:"val-".concat(t.toString()),required:!1,value:i[t].value,pattern:/^[a-zA-Z0-9-_.]{1,63}$/,customPatternMessage:"Invalid value"});var n=(0,v.R)(e);l(n)}),[i,l]);var Z=i.map((function(e,l){return(0,x.jsx)(r.Fragment,{children:(0,x.jsx)(p.ZP,{paddingBottom:1,children:(0,x.jsxs)("div",{className:t.shortened,children:[(0,x.jsx)(c.Z,{id:"key-".concat(n.replace(/ /g,""),"-").concat(l.toString()),label:"",placeholder:"Key",name:"key-".concat(l.toString()),value:i[l].key,onChange:function(e){var t=(0,a.Z)(i);t[l].key=e.target.value,o(t),f("key-".concat(l.toString()))},index:l,error:s["key-".concat(l.toString())]||""},"csv-key-".concat(l.toString())),(0,x.jsx)(c.Z,{id:"val-".concat(n.replace(/ /g,""),"-").concat(l.toString()),label:"",placeholder:"Value",name:"val-".concat(l.toString()),value:i[l].value,onChange:function(e){var t=(0,a.Z)(i);t[l].value=e.target.value,o(t),f("val-".concat(l.toString()))},index:l,error:s["val-".concat(l.toString())]||""},"csv-val-".concat(l.toString())),(0,x.jsx)(u.Z,{title:"Add ".concat(n),"aria-label":"addlabel",children:(0,x.jsx)(d.Z,{id:"add-".concat(n.replace(/ /g,""),"-").concat(l.toString()),size:"small",onClick:function(){var e=(0,a.Z)(i);e.push({key:"",value:""}),o(e)},children:(0,x.jsx)(m.Z,{})})}),(0,x.jsx)(u.Z,{title:"Remove","aria-label":"removeLabel",children:(0,x.jsx)(d.Z,{id:"remove-".concat(n.replace(/ /g,""),"-").concat(l.toString()),size:"small",style:{marginLeft:16},onClick:function(){if(1===i.length&&o([{key:"",value:""}]),i.length>1){var e=(0,a.Z)(i);e.splice(l,1),o(e)}},children:(0,x.jsx)(g.Z,{})})})]})})},"keyvalue-".concat(l.toString()))}));return(0,x.jsx)(r.Fragment,{children:Z})}))},18158:function(e,t,n){var a=n(72791),i=n(21435),r=n(37516),o=n(61889),s=n(60364),l=n(80184);t.Z=function(e){var t=e.classes,n=e.runAsGroup,c=e.runAsUser,u=e.fsGroup,d=e.runAsNonRoot,m=e.setRunAsUser,g=e.setRunAsGroup,v=e.setFSGroup,h=e.setRunAsNonRoot,p=(0,s.I0)();return(0,l.jsx)(a.Fragment,{children:(0,l.jsxs)("fieldset",{className:"".concat(t.fieldGroup," ").concat(t.fieldSpaceTop," "),children:[(0,l.jsx)("legend",{className:t.descriptionText,children:"Security Context"}),(0,l.jsx)(o.ZP,{item:!0,xs:12,children:(0,l.jsxs)("div",{className:"".concat(t.multiContainerStackNarrow," "),children:[(0,l.jsx)("div",{className:t.configSectionItem,children:(0,l.jsx)(i.Z,{type:"number",id:"securityContext_runAsUser",name:"securityContext_runAsUser",onChange:function(e){p(m(e.target.value))},label:"Run As User",value:c,required:!0,min:"0"})}),(0,l.jsx)("div",{className:t.configSectionItem,children:(0,l.jsx)(i.Z,{type:"number",id:"securityContext_runAsGroup",name:"securityContext_runAsGroup",onChange:function(e){p(g(e.target.value))},label:"Run As Group",value:n,required:!0,min:"0"})}),(0,l.jsx)("div",{className:t.configSectionItem,children:(0,l.jsx)(i.Z,{type:"number",id:"securityContext_fsGroup",name:"securityContext_fsGroup",onChange:function(e){p(v(e.target.value))},label:"FsGroup",value:u,required:!0,min:"0"})})]})}),(0,l.jsx)("br",{}),(0,l.jsx)(o.ZP,{item:!0,xs:12,children:(0,l.jsx)("div",{className:t.multiContainer,children:(0,l.jsx)(r.Z,{value:"SecurityContextRunAsNonRoot",id:"securityContext_runAsNonRoot",name:"securityContext_runAsNonRoot",checked:d,onChange:function(){p(h(!d))},label:"Do not run as Root"})})})]})})}},42419:function(e,t,n){var a=n(95318);t.Z=void 0;var i=a(n(45649)),r=n(80184),o=(0,i.default)((0,r.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");t.Z=o},27247:function(e,t,n){var a=n(95318);t.Z=void 0;var i=a(n(45649)),r=n(80184),o=(0,i.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");t.Z=o}}]);
//# sourceMappingURL=5367.4ee5c384.chunk.js.map
"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[2841],{32841:function(e,a,t){t.r(a),t.d(a,{default:function(){return w}});var n=t(23430),s=t(18489),i=t(50390),l=t(34424),r=t(86509),o=t(4285),c=t(25594),d=t(72462),u=t(23473),m=t(18201),g=t(46981),h=t(44149),x=t(35531),v=t(51002),Z=t(66946),p=t(30324),j=t(55572),N=t(66964),f=t(84201),C=t(1365),b=t(62559),S=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)({buttonContainer:{textAlign:"right"}},d.oO),d.ID),d.DF))}))((function(e){e.tenant;var a=e.classes,t=e.open,s=e.onClose,l=e.image,r=e.sidecarImage,o=e.initImage,d=e.labels,u=e.annotations,m=e.nodeSelector,g=e.diskCapacityGB,S=e.serviceAccountName,A=e.storageClassName,I=e.tenantName,y=e.tenantNamespace,R=e.cpuRequest,P=e.memRequest,q=(0,i.useState)({}),k=(0,n.Z)(q,2),z=k[0],w=k[1],M=(0,i.useState)(d.length>0?(0,x.Z)(d):[{key:"",value:""}]),G=(0,n.Z)(M,2),F=G[0],E=G[1],B=(0,i.useState)(u.length>0?(0,x.Z)(u):[{key:"",value:""}]),L=(0,n.Z)(B,2),U=L[0],D=L[1],O=(0,i.useState)(m.length>0?(0,x.Z)(m):[{key:"",value:""}]),T=(0,n.Z)(O,2),$=T[0],_=T[1],K=(0,i.useState)(l),V=(0,n.Z)(K,2),W=V[0],Y=V[1],H=(0,i.useState)(r),J=(0,n.Z)(H,2),Q=J[0],X=J[1],ee=(0,i.useState)(o),ae=(0,n.Z)(ee,2),te=ae[0],ne=ae[1],se=(0,i.useState)(g.toString()),ie=(0,n.Z)(se,2),le=ie[0],re=ie[1],oe=(0,i.useState)(R),ce=(0,n.Z)(oe,2),de=ce[0],ue=ce[1],me=(0,i.useState)(P?Math.floor(parseInt(P,10)/1e9).toString():""),ge=(0,n.Z)(me,2),he=ge[0],xe=ge[1],ve=(0,i.useState)(S),Ze=(0,n.Z)(ve,2),pe=Ze[0],je=Ze[1],Ne=(0,i.useState)(A),fe=(0,n.Z)(Ne,2),Ce=fe[0],be=fe[1],Se=(0,i.useState)({}),Ae=(0,n.Z)(Se,2),Ie=Ae[0],ye=Ae[1],Re=(0,i.useState)({}),Pe=(0,n.Z)(Re,2),qe=Pe[0],ke=Pe[1],ze=(0,i.useState)({}),we=(0,n.Z)(ze,2),Me=we[0],Ge=we[1],Fe=function(e){for(var a=[],t=0;t<e.length;t++)""!==e[t].key&&a.push(e[t]);return a};(0,i.useEffect)((function(){var e=[];e.push({fieldKey:"image",required:!1,value:W,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"sidecarImage",required:!1,value:Q,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"initImage",required:!1,value:te,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"diskCapacityGB",required:!0,value:le,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newCPURequest",required:!1,value:de,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newMemRequest",required:!1,value:he,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"serviceAccountName",required:!1,value:pe,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid service account name"}),e.push({fieldKey:"storageClassName",required:!1,value:Ce,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid storage class name"});var a=(0,f.R)(e);w(a)}),[W,Q,te,le,pe,Ce,de,he,w]);return(0,b.jsx)(v.Z,{onClose:function(){return s(!0)},modalOpen:t,title:"Edit Monitoring Configuration",children:(0,b.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault(),p.Z.invoke("PUT","/api/v1/namespaces/".concat(y,"/tenants/").concat(I,"/monitoring"),{labels:Fe(F),annotations:Fe(U),nodeSelector:Fe($),image:W,sidecarImage:Q,initImage:te,diskCapacityGB:le,serviceAccountName:pe,storageClassName:Ce,monitoringCPURequest:de,monitoringMemRequest:he+"Gi"}).then((function(){s(!0)})).catch((function(e){}))},children:(0,b.jsxs)(c.ZP,{container:!0,children:[(0,b.jsxs)(c.ZP,{xs:12,className:a.modalFormScrollable,children:[(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(N.Z,{id:"image",label:"Image",placeholder:"Image",name:"image",value:W,onChange:function(e){Y(e.target.value)},error:z.image||""},"image")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(N.Z,{id:"sidecarImage",label:"Sidecar Image",placeholder:"Sidecar Image",name:"sidecarImage",value:Q,onChange:function(e){X(e.target.value)},error:z.sidecarImage||""},"sidecarImage")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(N.Z,{id:"initImage",label:"Init Image",placeholder:"Init Image",name:"initImage",value:te,onChange:function(e){ne(e.target.value)},error:z.initImage||""},"initImage")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(N.Z,{id:"diskCapacityGB",label:"Disk Capacity",placeholder:"Disk Capacity",name:"diskCapacityGB",value:le,onChange:function(e){re(e.target.value)},error:z.diskCapacityGB||"",overlayObject:(0,b.jsx)(C.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"diskCapacityGB")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(N.Z,{id:"cpuRequest",label:"CPU Request",placeholder:"CPU Request",name:"cpuRequest",value:de,onChange:function(e){ue(e.target.value)},error:z.cpuRequest||""},"cpuRequest")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(N.Z,{id:"memRequest",label:"Memory Request",placeholder:"Memory request",name:"memRequest",value:he,onChange:function(e){e.target.validity.valid&&xe(e.target.value)},pattern:"[0-9]*",error:z.memRequest||"",overlayObject:(0,b.jsx)(C.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"memRequest")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(N.Z,{id:"serviceAccountName",label:"Service Account",placeholder:"Service Account Name",name:"serviceAccountName",value:pe,onChange:function(e){je(e.target.value)},error:z.serviceAccountName||""},"serviceAccountName")}),(0,b.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,b.jsx)(N.Z,{id:"storageClassName",label:"Storage Class",placeholder:"Storage Class Name",name:"storageClassName",value:Ce,onChange:function(e){be(e.target.value)},error:z.storageClassName||""},"storageClassName")}),(0,b.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,b.jsx)("span",{className:a.inputLabel,children:"Labels"}),(0,b.jsx)(j.Z,{newValues:F,setNewValues:E,paramName:"Labels",error:Ie,setError:ye})]}),(0,b.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,b.jsx)("span",{className:a.inputLabel,children:"Annotations"}),(0,b.jsx)(j.Z,{newValues:U,setNewValues:D,paramName:"Annotations",error:qe,setError:ke})]}),(0,b.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,b.jsx)("span",{className:a.inputLabel,children:"Node Selector"}),(0,b.jsx)(j.Z,{newValues:$,setNewValues:_,paramName:"Node Selector",error:Me,setError:Ge})]})]}),(0,b.jsx)(c.ZP,{xs:12,className:a.buttonContainer,children:(0,b.jsx)(Z.Z,{type:"submit",variant:"contained",color:"primary",disabled:!function(){if(0!==Object.keys(z).length||0!==Object.keys(Ie).length||0!==Object.keys(qe).length||0!==Object.keys(Me).length){return(0,h.zb)({errorMessage:"Invalid entry",detailedError:""}),!1}return!0}(),children:"Save"})})]})})})})),A=t(86362),I=t(92440),y=t(88370),R=t(28948),P=t(60656),q=t(53224),k={setErrorSnackMessage:h.Ih},z=(0,l.$j)(null,k),w=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)((0,s.Z)({},d.oZ),{},{headerLabel:{fontSize:22,fontWeight:600,color:"#000",marginTop:4},breadcrumLink:{textDecoration:"none",color:"black"},tableWrapper:{height:"calc(100vh - 267px)"},paperContainer:{padding:"15px 15px 15px 50px"}},d.OR),d.qg),(0,d.Bz)(e.spacing(4))))}))(z((function(e){var a=e.classes,t=e.match,s=e.tenant,l=e.loadingTenant,r=(0,i.useState)(!1),o=(0,n.Z)(r,2),d=o[0],x=o[1],v=(0,i.useState)(!1),Z=(0,n.Z)(v,2),j=Z[0],N=Z[1],f=(0,i.useState)(),C=(0,n.Z)(f,2),k=C[0],z=C[1],w=(0,i.useState)(!1),M=(0,n.Z)(w,2),G=M[0],F=M[1],E=(0,i.useState)(!0),B=(0,n.Z)(E,2),L=B[0],U=B[1],D=t.params.tenantName,O=t.params.tenantNamespace;(0,i.useEffect)((function(){L&&p.Z.invoke("GET","/api/v1/namespaces/".concat(O,"/tenants/").concat(D,"/monitoring")).then((function(e){x(e.prometheusEnabled),z(e),U(!1)})).catch((function(e){(0,h.Ih)(e),U(!1)}))}),[L]);return(0,b.jsxs)(i.Fragment,{children:[j&&null!==s&&d&&(0,b.jsx)(S,{classes:a,open:j,onClose:function(){N(!1),U(!0)},tenant:s,image:(null===k||void 0===k?void 0:k.image)||"",sidecarImage:(null===k||void 0===k?void 0:k.sidecarImage)||"",initImage:(null===k||void 0===k?void 0:k.initImage)||"",diskCapacityGB:null!==k&&void 0!==k&&k.diskCapacityGB?parseInt(null===k||void 0===k?void 0:k.diskCapacityGB):5,labels:(null===k||void 0===k?void 0:k.labels)||[],annotations:(null===k||void 0===k?void 0:k.annotations)||[],nodeSelector:(null===k||void 0===k?void 0:k.nodeSelector)||[],serviceAccountName:(null===k||void 0===k?void 0:k.serviceAccountName)||"",tenantName:D,tenantNamespace:O,storageClassName:(null===k||void 0===k?void 0:k.storageClassName)||"",cpuRequest:(null===k||void 0===k?void 0:k.monitoringCPURequest)||"",memRequest:(null===k||void 0===k?void 0:k.monitoringMemRequest)||""}),G&&(0,b.jsx)(P.Z,{isOpen:G,title:d?"Disable Prometheus monitoring?":"Enable Prometheus monitoring?",confirmText:d?"Disable":"Enable",cancelText:"Cancel",onClose:function(){return F(!1)},onConfirm:function(){var e={prometheusEnabled:d,toggle:!0};p.Z.invoke("PUT","/api/v1/namespaces/".concat(O,"/tenants/").concat(D,"/monitoring"),e).then((function(){x(!d),U(!0),F(!1),U(!0)})).catch((function(e){(0,h.Ih)(e)}))},confirmationContent:(0,b.jsx)(u.Z,{children:d?"Disabling monitoring will erase any custom values you have used to configure Prometheus monitoring":"Prometheus monitoring will be enabled with default values"})}),(0,b.jsx)("h1",{className:a.sectionTitle,children:"Monitoring"}),(0,b.jsxs)("div",{className:a.actionsTray,children:[(0,b.jsx)(I.Z,{label:"Prometheus Monitoring",indicatorLabels:["Enabled","Disabled"],checked:d,value:"monitoring_status",id:"monitoring-status",name:"monitoring-status",onChange:function(e){F(!0)},description:""}),d&&(0,b.jsx)(q.Z,{tooltip:"Edit Monitoring configuration",text:"Edit",onClick:function(){N(!0)},icon:(0,b.jsx)(A.dY,{}),color:"primary",variant:"contained"})]}),d&&void 0!==k&&(0,b.jsx)(g.Z,{className:a.paperContainer,children:(0,b.jsx)(c.ZP,{container:!0,children:(0,b.jsx)(c.ZP,{item:!0,xs:12,children:(0,b.jsx)("table",{width:"100%",children:(0,b.jsx)("tbody",{children:l?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:a.centerAlign,colSpan:4,children:(0,b.jsx)(m.Z,{})})}):(0,b.jsxs)(i.Fragment,{children:[null!=k.image&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Image:"}),(0,b.jsx)("td",{children:k.image})]}),null!=k.sidecarImage&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Sidecar Image:"}),(0,b.jsx)("td",{children:null===k||void 0===k?void 0:k.sidecarImage})]}),null!=k.initImage&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Init Image:"}),(0,b.jsx)("td",{children:null===k||void 0===k?void 0:k.initImage})]}),null!=k.diskCapacityGB&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Disk Capacity (GB):"}),(0,b.jsx)("td",{children:null===k||void 0===k?void 0:k.diskCapacityGB})]}),null!=k.serviceAccountName&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Service Account Name:"}),(0,b.jsx)("td",{children:null===k||void 0===k?void 0:k.serviceAccountName})]}),null!=k.storageClassName&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Storage Class Name:"}),(0,b.jsx)("td",{children:null===k||void 0===k?void 0:k.storageClassName})]}),null!=k.labels&&k.labels.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("tr",{children:(0,b.jsx)("td",{children:(0,b.jsx)("h4",{children:"Labels"})})}),(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:a.titleCol,children:(0,b.jsx)(y.Z,{records:k.labels,recordName:"Labels"})})})]}),null!=k.annotations&&k.annotations.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("tr",{children:(0,b.jsx)("td",{children:(0,b.jsx)("h4",{children:"Annotations"})})}),(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:a.titleCol,children:(0,b.jsx)(y.Z,{records:k.annotations,recordName:"Annotations"})})})]}),null!=k.monitoringCPURequest&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"CPU Request:"}),(0,b.jsx)("td",{children:null===k||void 0===k?void 0:k.monitoringCPURequest})]}),null!=k.monitoringMemRequest&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:a.titleCol,children:"Memory Request:"}),(0,b.jsx)("td",{children:(0,R.ae)(null===k||void 0===k?void 0:k.monitoringMemRequest,!0)})]}),null!=k.nodeSelector&&k.nodeSelector.length>0&&(0,b.jsxs)("tr",{children:[(0,b.jsx)("h4",{children:"Node Selector:"}),(0,b.jsx)("td",{className:a.titleCol,children:(0,b.jsx)(y.Z,{records:k.nodeSelector,recordName:"Node Selector"})})]})]})})})})})})]})})))}}]);
//# sourceMappingURL=2841.1efed130.chunk.js.map
{"version":3,"file":"static/js/7134.c5901625.chunk.js","mappings":"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","sources":["screens/Console/KMS/ListKeys.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2022 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { Grid, Theme } from \"@mui/material\";\nimport { createStyles, withStyles } from \"@mui/styles\";\nimport { AddIcon, Button, PageHeader, RefreshIcon, UploadIcon } from \"mds\";\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport api from \"../../../common/api\";\nimport {\n  hasPermission,\n  SecureComponent,\n} from \"../../../common/SecureComponent\";\nimport {\n  CONSOLE_UI_RESOURCE,\n  IAM_PAGES,\n  IAM_SCOPES,\n} from \"../../../common/SecureComponent/permissions\";\nimport { ErrorResponseHandler } from \"../../../common/types\";\nimport { useAppDispatch } from \"../../../store\";\nimport { setErrorSnackMessage } from \"../../../systemSlice\";\nimport withSuspense from \"../Common/Components/withSuspense\";\nimport {\n  containerForHeader,\n  searchField,\n} from \"../Common/FormComponents/common/styleLibrary\";\nimport PageLayout from \"../Common/Layout/PageLayout\";\nimport SearchBox from \"../Common/SearchBox\";\nimport TableWrapper from \"../Common/TableWrapper/TableWrapper\";\nimport TooltipWrapper from \"../Common/TooltipWrapper/TooltipWrapper\";\n\nconst DeleteKMSModal = withSuspense(\n  React.lazy(() => import(\"./DeleteKMSModal\"))\n);\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    ...searchField,\n    ...containerForHeader,\n  });\n\ninterface IKeysProps {\n  classes: any;\n}\n\nconst ListKeys = ({ classes }: IKeysProps) => {\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n\n  const [filter, setFilter] = useState<string>(\"\");\n  const [deleteOpen, setDeleteOpen] = useState<boolean>(false);\n  const [selectedKey, setSelectedKey] = useState<string>(\"\");\n  const [loading, setLoading] = useState<boolean>(false);\n  const [records, setRecords] = useState<[]>([]);\n\n  const deleteKey = hasPermission(CONSOLE_UI_RESOURCE, [\n    IAM_SCOPES.KMS_DELETE_KEY,\n  ]);\n\n  const displayKeys = hasPermission(CONSOLE_UI_RESOURCE, [\n    IAM_SCOPES.KMS_LIST_KEYS,\n  ]);\n\n  useEffect(() => {\n    fetchRecords();\n  }, []);\n\n  useEffect(() => {\n    setLoading(true);\n  }, [filter]);\n\n  useEffect(() => {\n    if (loading) {\n      if (displayKeys) {\n        let pattern = filter.trim() === \"\" ? \"*\" : filter.trim();\n        api\n          .invoke(\"GET\", `/api/v1/kms/keys?pattern=${pattern}`)\n          .then((res) => {\n            setLoading(false);\n            setRecords(res.results);\n          })\n          .catch((err: ErrorResponseHandler) => {\n            setLoading(false);\n            dispatch(setErrorSnackMessage(err));\n          });\n      } else {\n        setLoading(false);\n      }\n    }\n  }, [loading, setLoading, setRecords, dispatch, displayKeys, filter]);\n\n  const fetchRecords = () => {\n    setLoading(true);\n  };\n\n  const confirmDeleteKey = (key: string) => {\n    setDeleteOpen(true);\n    setSelectedKey(key);\n  };\n\n  const closeDeleteModalAndRefresh = (refresh: boolean) => {\n    setDeleteOpen(false);\n\n    if (refresh) {\n      fetchRecords();\n    }\n  };\n\n  const tableActions = [\n    {\n      type: \"delete\",\n      onClick: confirmDeleteKey,\n      sendOnlyId: true,\n      disableButtonFunction: () => !deleteKey,\n    },\n  ];\n\n  return (\n    <React.Fragment>\n      {deleteOpen && (\n        <DeleteKMSModal\n          deleteOpen={deleteOpen}\n          selectedItem={selectedKey}\n          endpoint={\"/api/v1/kms/keys/\"}\n          element={\"Key\"}\n          closeDeleteModalAndRefresh={closeDeleteModalAndRefresh}\n        />\n      )}\n      <PageHeader label=\"Key Management Service Keys\" />\n      <PageLayout className={classes.pageContainer}>\n        <Grid container spacing={1}>\n          <Grid\n            item\n            xs={12}\n            display={\"flex\"}\n            alignItems={\"center\"}\n            justifyContent={\"flex-end\"}\n            sx={{\n              \"& button\": {\n                marginLeft: \"8px\",\n              },\n            }}\n          >\n            <SecureComponent\n              scopes={[IAM_SCOPES.KMS_LIST_KEYS]}\n              resource={CONSOLE_UI_RESOURCE}\n              errorProps={{ disabled: true }}\n            >\n              <SearchBox\n                onChange={setFilter}\n                placeholder=\"Search Keys with pattern\"\n                value={filter}\n              />\n            </SecureComponent>\n\n            <SecureComponent\n              scopes={[IAM_SCOPES.KMS_LIST_KEYS]}\n              resource={CONSOLE_UI_RESOURCE}\n              errorProps={{ disabled: true }}\n            >\n              <TooltipWrapper tooltip={\"Refresh\"}>\n                <Button\n                  id={\"refresh-keys\"}\n                  variant=\"regular\"\n                  icon={<RefreshIcon />}\n                  onClick={() => setLoading(true)}\n                />\n              </TooltipWrapper>\n            </SecureComponent>\n            <SecureComponent\n              scopes={[IAM_SCOPES.KMS_IMPORT_KEY]}\n              resource={CONSOLE_UI_RESOURCE}\n              errorProps={{ disabled: true }}\n            >\n              <TooltipWrapper tooltip={\"Import Key\"}>\n                <Button\n                  id={\"import-key\"}\n                  variant={\"regular\"}\n                  icon={<UploadIcon />}\n                  onClick={() => {\n                    navigate(IAM_PAGES.KMS_KEYS_IMPORT);\n                  }}\n                />\n              </TooltipWrapper>\n            </SecureComponent>\n            <SecureComponent\n              scopes={[IAM_SCOPES.KMS_CREATE_KEY]}\n              resource={CONSOLE_UI_RESOURCE}\n              errorProps={{ disabled: true }}\n            >\n              <TooltipWrapper tooltip={\"Create Key\"}>\n                <Button\n                  id={\"create-key\"}\n                  label={\"Create Key\"}\n                  variant={\"callAction\"}\n                  icon={<AddIcon />}\n                  onClick={() => navigate(IAM_PAGES.KMS_KEYS_ADD)}\n                />\n              </TooltipWrapper>\n            </SecureComponent>\n          </Grid>\n          <Grid item xs={12} className={classes.tableBlock}>\n            <SecureComponent\n              scopes={[IAM_SCOPES.KMS_LIST_KEYS]}\n              resource={CONSOLE_UI_RESOURCE}\n              errorProps={{ disabled: true }}\n            >\n              <TableWrapper\n                itemActions={tableActions}\n                columns={[\n                  { label: \"Name\", elementKey: \"name\" },\n                  { label: \"Created By\", elementKey: \"createdBy\" },\n                  { label: \"Created At\", elementKey: \"createdAt\" },\n                ]}\n                isLoading={loading}\n                records={records}\n                entityName=\"Keys\"\n                idField=\"name\"\n              />\n            </SecureComponent>\n          </Grid>\n        </Grid>\n      </PageLayout>\n    </React.Fragment>\n  );\n};\n\nexport default withStyles(styles)(ListKeys);\n"],"names":["DeleteKMSModal","withSuspense","React","withStyles","theme","createStyles","searchField","containerForHeader","classes","dispatch","useAppDispatch","navigate","useNavigate","useState","filter","setFilter","deleteOpen","setDeleteOpen","selectedKey","setSelectedKey","loading","setLoading","records","setRecords","deleteKey","hasPermission","CONSOLE_UI_RESOURCE","IAM_SCOPES","displayKeys","useEffect","fetchRecords","pattern","trim","api","then","res","results","catch","err","setErrorSnackMessage","tableActions","type","onClick","key","sendOnlyId","disableButtonFunction","selectedItem","endpoint","element","closeDeleteModalAndRefresh","refresh","label","className","pageContainer","container","spacing","item","xs","display","alignItems","justifyContent","sx","marginLeft","scopes","resource","errorProps","disabled","onChange","placeholder","value","tooltip","id","variant","icon","IAM_PAGES","tableBlock","itemActions","columns","elementKey","isLoading","entityName","idField"],"sourceRoot":""}
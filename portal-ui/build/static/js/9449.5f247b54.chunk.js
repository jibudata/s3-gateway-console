"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[9449],{99449:function(e,a,t){t.r(a),t.d(a,{default:function(){return w}});var n=t(29439),s=t(1413),i=t(72791),l=t(60364),r=t(11135),o=t(25787),c=t(61889),d=t(23814),u=t(51691),m=t(10703),g=t(42649),h=t(93433),x=t(56028),v=t(36151),Z=t(81207),j=t(32509),p=t(21435),C=t(40968),N=t(56578),f=t(80184),b=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)({buttonContainer:{textAlign:"right"}},d.oO),d.ID),d.DF))}))((function(e){e.tenant;var a=e.classes,t=e.open,s=e.onClose,l=e.image,r=e.sidecarImage,o=e.initImage,d=e.labels,u=e.annotations,m=e.nodeSelector,b=e.diskCapacityGB,S=e.serviceAccountName,I=e.storageClassName,A=e.tenantName,y=e.tenantNamespace,P=e.cpuRequest,R=e.memRequest,q=(0,i.useState)({}),k=(0,n.Z)(q,2),z=k[0],w=k[1],M=(0,i.useState)(d.length>0?(0,h.Z)(d):[{key:"",value:""}]),G=(0,n.Z)(M,2),F=G[0],E=G[1],B=(0,i.useState)(u.length>0?(0,h.Z)(u):[{key:"",value:""}]),U=(0,n.Z)(B,2),D=U[0],L=U[1],O=(0,i.useState)(m.length>0?(0,h.Z)(m):[{key:"",value:""}]),$=(0,n.Z)(O,2),_=$[0],K=$[1],T=(0,i.useState)(l),V=(0,n.Z)(T,2),Y=V[0],H=V[1],J=(0,i.useState)(r),Q=(0,n.Z)(J,2),W=Q[0],X=Q[1],ee=(0,i.useState)(o),ae=(0,n.Z)(ee,2),te=ae[0],ne=ae[1],se=(0,i.useState)(b.toString()),ie=(0,n.Z)(se,2),le=ie[0],re=ie[1],oe=(0,i.useState)(P),ce=(0,n.Z)(oe,2),de=ce[0],ue=ce[1],me=(0,i.useState)(R?Math.floor(parseInt(R,10)/1e9).toString():""),ge=(0,n.Z)(me,2),he=ge[0],xe=ge[1],ve=(0,i.useState)(S),Ze=(0,n.Z)(ve,2),je=Ze[0],pe=Ze[1],Ce=(0,i.useState)(I),Ne=(0,n.Z)(Ce,2),fe=Ne[0],be=Ne[1],Se=(0,i.useState)({}),Ie=(0,n.Z)(Se,2),Ae=Ie[0],ye=Ie[1],Pe=(0,i.useState)({}),Re=(0,n.Z)(Pe,2),qe=Re[0],ke=Re[1],ze=(0,i.useState)({}),we=(0,n.Z)(ze,2),Me=we[0],Ge=we[1],Fe=function(e){for(var a=[],t=0;t<e.length;t++)""!==e[t].key&&a.push(e[t]);return a};(0,i.useEffect)((function(){var e=[];e.push({fieldKey:"image",required:!1,value:Y,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"sidecarImage",required:!1,value:W,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"initImage",required:!1,value:te,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"diskCapacityGB",required:!0,value:le,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newCPURequest",required:!1,value:de,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newMemRequest",required:!1,value:he,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"serviceAccountName",required:!1,value:je,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid service account name"}),e.push({fieldKey:"storageClassName",required:!1,value:fe,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid storage class name"});var a=(0,C.R)(e);w(a)}),[Y,W,te,le,je,fe,de,he,w]);return(0,f.jsx)(x.Z,{onClose:function(){return s(!0)},modalOpen:t,title:"Edit Monitoring Configuration",children:(0,f.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault(),Z.Z.invoke("PUT","/api/v1/namespaces/".concat(y,"/tenants/").concat(A,"/monitoring"),{labels:Fe(F),annotations:Fe(D),nodeSelector:Fe(_),image:Y,sidecarImage:W,initImage:te,diskCapacityGB:le,serviceAccountName:je,storageClassName:fe,monitoringCPURequest:de,monitoringMemRequest:he+"Gi"}).then((function(){s(!0)})).catch((function(e){}))},children:(0,f.jsxs)(c.ZP,{container:!0,children:[(0,f.jsxs)(c.ZP,{xs:12,className:a.modalFormScrollable,children:[(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(p.Z,{id:"image",label:"Image",placeholder:"Image",name:"image",value:Y,onChange:function(e){H(e.target.value)},error:z.image||""},"image")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(p.Z,{id:"sidecarImage",label:"Sidecar Image",placeholder:"Sidecar Image",name:"sidecarImage",value:W,onChange:function(e){X(e.target.value)},error:z.sidecarImage||""},"sidecarImage")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(p.Z,{id:"initImage",label:"Init Image",placeholder:"Init Image",name:"initImage",value:te,onChange:function(e){ne(e.target.value)},error:z.initImage||""},"initImage")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(p.Z,{id:"diskCapacityGB",label:"Disk Capacity",placeholder:"Disk Capacity",name:"diskCapacityGB",value:le,onChange:function(e){re(e.target.value)},error:z.diskCapacityGB||"",overlayObject:(0,f.jsx)(N.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"diskCapacityGB")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(p.Z,{id:"cpuRequest",label:"CPU Request",placeholder:"CPU Request",name:"cpuRequest",value:de,onChange:function(e){ue(e.target.value)},error:z.cpuRequest||""},"cpuRequest")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(p.Z,{id:"memRequest",label:"Memory Request",placeholder:"Memory request",name:"memRequest",value:he,onChange:function(e){e.target.validity.valid&&xe(e.target.value)},pattern:"[0-9]*",error:z.memRequest||"",overlayObject:(0,f.jsx)(N.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"memRequest")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(p.Z,{id:"serviceAccountName",label:"Service Account",placeholder:"Service Account Name",name:"serviceAccountName",value:je,onChange:function(e){pe(e.target.value)},error:z.serviceAccountName||""},"serviceAccountName")}),(0,f.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,f.jsx)(p.Z,{id:"storageClassName",label:"Storage Class",placeholder:"Storage Class Name",name:"storageClassName",value:fe,onChange:function(e){be(e.target.value)},error:z.storageClassName||""},"storageClassName")}),(0,f.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,f.jsx)("span",{className:a.inputLabel,children:"Labels"}),(0,f.jsx)(j.Z,{newValues:F,setNewValues:E,paramName:"Labels",error:Ae,setError:ye})]}),(0,f.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,f.jsx)("span",{className:a.inputLabel,children:"Annotations"}),(0,f.jsx)(j.Z,{newValues:D,setNewValues:L,paramName:"Annotations",error:qe,setError:ke})]}),(0,f.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,f.jsx)("span",{className:a.inputLabel,children:"Node Selector"}),(0,f.jsx)(j.Z,{newValues:_,setNewValues:K,paramName:"Node Selector",error:Me,setError:Ge})]})]}),(0,f.jsx)(c.ZP,{xs:12,className:a.buttonContainer,children:(0,f.jsx)(v.Z,{type:"submit",variant:"contained",color:"primary",disabled:!function(){if(0!==Object.keys(z).length||0!==Object.keys(Ae).length||0!==Object.keys(qe).length||0!==Object.keys(Me).length){return(0,g.zb)({errorMessage:"Invalid entry",detailedError:""}),!1}return!0}(),children:"Save"})})]})})})})),S=t(56375),I=t(37516),A=t(47879),y=t(45248),P=t(2148),R=t(40603),q=t(72401),k={setErrorSnackMessage:g.Ih},z=(0,l.$j)(null,k),w=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)((0,s.Z)({},d.oZ),{},{paperContainer:{padding:"15px 15px 15px 50px"}},d.OR),d.qg),(0,d.Bz)(e.spacing(4))))}))(z((function(e){var a=e.classes,t=e.match,s=e.tenant,l=e.loadingTenant,r=(0,i.useState)(!1),o=(0,n.Z)(r,2),d=o[0],h=o[1],x=(0,i.useState)(!1),v=(0,n.Z)(x,2),j=v[0],p=v[1],C=(0,i.useState)(),N=(0,n.Z)(C,2),k=N[0],z=N[1],w=(0,i.useState)(!1),M=(0,n.Z)(w,2),G=M[0],F=M[1],E=(0,i.useState)(!0),B=(0,n.Z)(E,2),U=B[0],D=B[1],L=t.params.tenantName,O=t.params.tenantNamespace;(0,i.useEffect)((function(){U&&Z.Z.invoke("GET","/api/v1/namespaces/".concat(O,"/tenants/").concat(L,"/monitoring")).then((function(e){h(e.prometheusEnabled),z(e),D(!1)})).catch((function(e){(0,g.Ih)(e),D(!1)}))}),[U]);return(0,f.jsxs)(i.Fragment,{children:[j&&null!==s&&d&&(0,f.jsx)(b,{classes:a,open:j,onClose:function(){p(!1),D(!0)},tenant:s,image:(null===k||void 0===k?void 0:k.image)||"",sidecarImage:(null===k||void 0===k?void 0:k.sidecarImage)||"",initImage:(null===k||void 0===k?void 0:k.initImage)||"",diskCapacityGB:null!==k&&void 0!==k&&k.diskCapacityGB?parseInt(null===k||void 0===k?void 0:k.diskCapacityGB):5,labels:(null===k||void 0===k?void 0:k.labels)||[],annotations:(null===k||void 0===k?void 0:k.annotations)||[],nodeSelector:(null===k||void 0===k?void 0:k.nodeSelector)||[],serviceAccountName:(null===k||void 0===k?void 0:k.serviceAccountName)||"",tenantName:L,tenantNamespace:O,storageClassName:(null===k||void 0===k?void 0:k.storageClassName)||"",cpuRequest:(null===k||void 0===k?void 0:k.monitoringCPURequest)||"",memRequest:(null===k||void 0===k?void 0:k.monitoringMemRequest)||""}),G&&(0,f.jsx)(P.Z,{isOpen:G,title:d?"Disable Prometheus monitoring?":"Enable Prometheus monitoring?",confirmText:d?"Disable":"Enable",cancelText:"Cancel",onClose:function(){return F(!1)},onConfirm:function(){var e={prometheusEnabled:d,toggle:!0};Z.Z.invoke("PUT","/api/v1/namespaces/".concat(O,"/tenants/").concat(L,"/monitoring"),e).then((function(){h(!d),D(!0),F(!1),D(!0)})).catch((function(e){(0,g.Ih)(e)}))},confirmationContent:(0,f.jsx)(u.Z,{children:d?"Disabling monitoring will erase any custom values you have used to configure Prometheus monitoring":"Prometheus monitoring will be enabled with default values"})}),(0,f.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,f.jsx)(c.ZP,{item:!0,xs:!0,children:(0,f.jsx)("h1",{className:a.sectionTitle,children:"Monitoring"})}),(0,f.jsx)(c.ZP,{item:!0,xs:4,children:(0,f.jsx)(I.Z,{indicatorLabels:["Enabled","Disabled"],checked:d,value:"monitoring_status",id:"monitoring-status",name:"monitoring-status",onChange:function(e){F(!0)},description:""})})]}),d&&void 0!==k&&(0,f.jsx)(m.Z,{className:a.paperContainer,children:(0,f.jsxs)(c.ZP,{container:!0,children:[(0,f.jsx)(c.ZP,{item:!0,xs:12,children:(0,f.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,f.jsx)(c.ZP,{xs:8,children:(0,f.jsx)("h3",{children:"Configuration"})}),(0,f.jsx)(c.ZP,{xs:4,justifyContent:"end",textAlign:"right",children:(0,f.jsx)(R.Z,{tooltip:"Edit Monitoring configuration",text:"Edit",onClick:function(){p(!0)},icon:(0,f.jsx)(S.dY8,{}),color:"primary",variant:"contained"})})]})}),(0,f.jsxs)(c.ZP,{item:!0,xs:12,children:[(0,f.jsx)("hr",{className:a.hrClass}),(0,f.jsx)("table",{width:"100%",children:(0,f.jsx)("tbody",{children:l?(0,f.jsx)("tr",{children:(0,f.jsx)("td",{className:a.centerAlign,colSpan:4,children:(0,f.jsx)(q.Z,{})})}):(0,f.jsxs)(i.Fragment,{children:[null!=k.image&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Image:"}),(0,f.jsx)("td",{children:k.image})]}),null!=k.sidecarImage&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Sidecar Image:"}),(0,f.jsx)("td",{children:null===k||void 0===k?void 0:k.sidecarImage})]}),null!=k.initImage&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Init Image:"}),(0,f.jsx)("td",{children:null===k||void 0===k?void 0:k.initImage})]}),null!=k.diskCapacityGB&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Disk Capacity (GB):"}),(0,f.jsx)("td",{children:null===k||void 0===k?void 0:k.diskCapacityGB})]}),null!=k.serviceAccountName&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Service Account Name:"}),(0,f.jsx)("td",{children:null===k||void 0===k?void 0:k.serviceAccountName})]}),null!=k.storageClassName&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Storage Class Name:"}),(0,f.jsx)("td",{children:null===k||void 0===k?void 0:k.storageClassName})]}),null!=k.labels&&k.labels.length>0&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("tr",{children:(0,f.jsx)("td",{children:(0,f.jsx)("h4",{children:"Labels"})})}),(0,f.jsx)("tr",{children:(0,f.jsx)("td",{className:a.titleCol,children:(0,f.jsx)(A.Z,{records:k.labels,recordName:"Labels"})})})]}),null!=k.annotations&&k.annotations.length>0&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("tr",{children:(0,f.jsx)("td",{children:(0,f.jsx)("h4",{children:"Annotations"})})}),(0,f.jsx)("tr",{children:(0,f.jsx)("td",{className:a.titleCol,children:(0,f.jsx)(A.Z,{records:k.annotations,recordName:"Annotations"})})})]}),null!=k.monitoringCPURequest&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"CPU Request:"}),(0,f.jsx)("td",{children:null===k||void 0===k?void 0:k.monitoringCPURequest})]}),null!=k.monitoringMemRequest&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:a.titleCol,children:"Memory Request:"}),(0,f.jsx)("td",{children:(0,y.ae)(null===k||void 0===k?void 0:k.monitoringMemRequest,!0)})]}),null!=k.nodeSelector&&k.nodeSelector.length>0&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("h4",{children:"Node Selector:"}),(0,f.jsx)("td",{className:a.titleCol,children:(0,f.jsx)(A.Z,{records:k.nodeSelector,recordName:"Node Selector"})})]})]})})})]})]})})]})})))}}]);
//# sourceMappingURL=9449.5f247b54.chunk.js.map
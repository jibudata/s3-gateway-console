"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[3996],{3996:(t,e,s)=>{s.r(e),s.d(e,{default:()=>W});var i=s(69060),a=s(66152),n=s(51560),l=s(21124),o=s(66156),c=s(95705),r=s(20720),p=s(89940),u=s(67659),x=s(58564),h=s.n(x),d=s(82496);const m=u.cp.div((t=>{let{theme:e}=t;return{marginTop:15,table:{width:"100%",borderCollapse:"collapse","& .feature-cell":{fontWeight:600,fontSize:14,paddingLeft:15},"& .status-cell":{textAlign:"center"},"& .header-cell":{textAlign:"center"},"& tr":{height:38,"& td":{borderBottom:"1px solid ".concat(h()(e,"borderColor","#E2E2E2"))},"& th":{borderBottom:"2px solid ".concat(h()(e,"borderColor","#E2E2E2"))}},"& .indicator":{display:"flex",alignItems:"center",justifyContent:"center","& .min-icon":{height:15,width:15},"&.active":{"& .min-icon":{fill:h()(e,"signalColors.good","#4CCB92")}},"&.deactivated":{"& .min-icon":{fill:h()(e,"signalColors.danger","#C51B3F")}}}}}})),f=t=>{let{matrixData:e=[],entityName:s="",entityType:i=""}=t;const[n=[],...l]=e,o=n.map(((t,e)=>(0,d.jsx)("th",{className:"header-cell",children:t},"".concat(0,e)))),c=l.map(((t,e)=>(0,d.jsx)("tr",{children:t.map(((t,s)=>{let i=null;return 0===s?i=t:""===t&&(i=""),!0===t?i=(0,d.jsx)(a.kvh,{className:"indicator active",children:(0,d.jsx)(a.c2_,{})}):!1===t&&(i=(0,d.jsx)(a.kvh,{className:"indicator deactivated",children:(0,d.jsx)(a.c2_,{})})),(0,d.jsx)("td",{className:0===s?"feature-cell":"status-cell",children:i},"".concat(e+1).concat(s))}))},"r-".concat(e+1))));return(0,d.jsxs)(m,{children:[(0,d.jsxs)(a.kvh,{sx:{marginTop:15,marginBottom:15},children:["Replication status for ",i,": ",(0,d.jsx)("strong",{children:s}),"."]}),(0,d.jsxs)("table",{children:[(0,d.jsx)("thead",{children:(0,d.jsx)("tr",{children:o})}),(0,d.jsx)("tbody",{children:c})]})]})};function g(t,e){return e?!t:""}function y(t,e,s){return Object.keys(t).find((t=>!(e[t]||{})[s]))}const j=t=>{let{entityType:e,entityValue:s}=t;return(0,d.jsxs)(a.kvh,{sx:{marginTop:"45px",display:"flex",alignItems:"center",justifyContent:"center"},children:[e,":"," ",(0,d.jsx)(a.kvh,{sx:{marginLeft:"5px",marginRight:"5px",fontWeight:600},children:s})," ","not found."]})},k=t=>{let{bucketStats:e={},sites:s={},lookupValue:i=""}=t;const a=["Tags","Policy","Quota","Retention","Encryption","Replication"],n=e[i]||{};if(!i)return null;const l=Object.keys(s),o=[];if(y(s,n,"HasBucket"))return(0,d.jsx)(j,{entityType:"Bucket",entityValue:i});{const t=[];for(let e=0;e<l.length;e++)0===e&&t.push(""),t.push(s[l[e]].name);o.push(t);for(let e=0;e<a.length;e++){const t=[],i=a[e];let c="";for(let a=0;a<l.length;a++){const o=n[s[l[a]].deploymentID];switch(0===a&&t.push(i),e){case 0:c=g(o.TagMismatch,o.HasTagsSet),t.push(c);break;case 1:c=g(o.PolicyMismatch,o.HasPolicySet),t.push(c);break;case 2:c=g(o.QuotaCfgMismatch,o.HasQuotaCfgSet),t.push(c);break;case 3:c=g(o.OLockConfigMismatch,o.HasOLockConfigSet),t.push(c);break;case 4:c=g(o.SSEConfigMismatch,o.HasSSECfgSet),t.push(c);break;case 5:c=g(o.ReplicationCfgMismatch,o.HasReplicationCfg),t.push(c)}}o.push(t)}}return(0,d.jsx)(f,{matrixData:o,entityName:i,entityType:"Bucket"})},b=t=>{let{policyStats:e={},sites:s={},lookupValue:i=""}=t;const a=["Policy"],n=e[i]||{};if(!i)return null;const l=Object.keys(s),o=[];if(y(s,n,"HasPolicy"))return(0,d.jsx)(j,{entityType:"Policy",entityValue:i});{const t=[];for(let e=0;e<l.length;e++)0===e&&t.push(""),t.push(s[l[e]].name);o.push(t);for(let e=0;e<a.length;e++){const t=[],i=a[e];let c="";for(let a=0;a<l.length;a++){const o=n[s[l[a]].deploymentID];if(0===a&&t.push(i),0===e)c=g(o.PolicyMismatch,o.HasPolicy),t.push(c)}o.push(t)}}return(0,d.jsx)(f,{matrixData:o,entityName:i,entityType:"Policy"})},v=t=>{let{groupStats:e={},sites:s={},lookupValue:i=""}=t;const a=["Info","Policy mapping"],n=e[i]||{};if(!i)return null;const l=Object.keys(s),o=[];if(y(s,n,"HasGroup"))return(0,d.jsx)(j,{entityType:"Group",entityValue:i});{const t=[];for(let e=0;e<l.length;e++)0===e&&t.push(""),t.push(s[l[e]].name);o.push(t);for(let e=0;e<a.length;e++){const t=[],i=a[e];let c="";for(let a=0;a<l.length;a++){const o=n[s[l[a]].deploymentID];switch(0===a&&t.push(i),e){case 0:c=g(o.GroupDescMismatch,o.HasGroup),t.push(c);break;case 1:c=g(o.PolicyMismatch,o.HasPolicyMapping),t.push(c)}}o.push(t)}}return(0,d.jsx)(f,{matrixData:o,entityName:i,entityType:"Group"})},S=t=>{let{userStats:e={},sites:s={},lookupValue:i=""}=t;const a=["Info","Policy mapping"],n=e[i]||{};if(!i)return null;const l=Object.keys(s),o=[];if(y(s,n,"HasUser"))return(0,d.jsx)(j,{entityType:"User",entityValue:i});{const t=[];for(let e=0;e<l.length;e++)0===e&&t.push(""),t.push(s[l[e]].name);o.push(t);for(let e=0;e<a.length;e++){const t=[],i=a[e];let c="";for(let a=0;a<l.length;a++){const o=n[s[l[a]].deploymentID];switch(0===a&&t.push(i),e){case 0:c=g(o.UserInfoMismatch,o.HasUser),t.push(c);break;case 1:c=g(o.PolicyMismatch,o.HasPolicyMapping),t.push(c)}}o.push(t)}}return(0,d.jsx)(f,{matrixData:o,entityName:i,entityType:"User"})};var C=s(84612);const T=()=>{const[t,e]=(0,i.useState)("bucket"),[s,n]=(0,i.useState)(""),[l,o]=(0,i.useState)({}),[c,r]=(0,i.useState)(!1),[u,x]=(0,p.c)((t=>{o(t),r(!0)}),(t=>{o({}),r(!0)})),{bucketStats:h={},sites:m={},userStats:f={},policyStats:g={},groupStats:y={}}=l||{};return(0,d.jsxs)(a.kvh,{children:[(0,d.jsxs)(a.kvh,{sx:{display:"grid",alignItems:"center",gridTemplateColumns:".7fr .9fr 1.2fr .3fr",["@media (max-width: ".concat(a.WQo.sm,"px)")]:{gridTemplateColumns:"1fr"},["@media (max-width: ".concat(a.WQo.md,"px)")]:{gridTemplateColumns:"1.2fr .7fr .7fr .3fr"},gap:"15px"},children:[(0,d.jsx)(a.kvh,{sx:{width:"240px",flexGrow:"0"},children:"View Replication Status for a:"}),(0,d.jsx)(a.kvh,{sx:{marginLeft:-25,["@media (max-width: ".concat(a.WQo.sm,"px)")]:{marginLeft:0}},children:(0,d.jsx)(a.M1e,{id:"replicationEntityLookup",name:"replicationEntityLookup",onChange:t=>{e(t),r(!1)},label:"",value:t,options:[{label:"Bucket",value:"bucket"},{label:"User",value:"user"},{label:"Group",value:"group"},{label:"Policy",value:"policy"}],disabled:!1})}),(0,d.jsx)(a.kvh,{sx:{flex:2},children:(0,d.jsx)(a.q22,{id:"replicationLookupEntityValue",name:"replicationLookupEntityValue",onChange:t=>{n(t.target.value),r(!1)},placeholder:"test-".concat(t),label:"",value:s})}),(0,d.jsx)(a.kvh,{sx:{maxWidth:"80px"},children:(0,d.jsx)(C.c,{tooltip:"View across sites",children:(0,d.jsx)(a.qaq,{id:"view-across-sites",type:"button",onClick:()=>{!function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(r(!1),t&&e){let s="api/v1/admin/site-replication/status?buckets=false&entityType=".concat(t,"&entityValue=").concat(e,"&groups=false&policies=false&users=false");x("GET",s)}}(t,s)},label:"View",icon:(0,d.jsx)(a.jnx,{}),collapseOnSmall:!1,disabled:!s||!t})})})]}),u?(0,d.jsx)(a.yeN,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:45},children:(0,d.jsx)(a.c1M,{style:{width:25,height:25}})}):null,c?(0,d.jsxs)(a.kvh,{children:[!u&&"bucket"===t&&s?(0,d.jsx)(k,{bucketStats:h,sites:m,lookupValue:s}):null,!u&&"user"===t&&s?(0,d.jsx)(S,{userStats:f,sites:m,lookupValue:s}):null,!u&&"group"===t&&s?(0,d.jsx)(v,{groupStats:y,sites:m,lookupValue:s}):null,!u&&"policy"===t&&s?(0,d.jsx)(b,{policyStats:g,sites:m,lookupValue:s}):null]}):null]})};var w=s(3428),P=s(48504),V=s(61180),I=s(78256);const N=t=>{var e;let{maxValue:s=0,entityStatObj:i={},entityTextPlural:n="",icon:l=null}=t;const o=null===(e=Object.keys(i||{}))||void 0===e?void 0:e.length;return(0,d.jsx)(a.kvh,{withBorders:!0,sx:{padding:"25px",["@media (min-width: ".concat(a.WQo.sm,"px)")]:{maxWidth:"100%"}},children:(0,d.jsx)(r.c,{icon:l,onlineCount:s,offlineCount:o,okStatusText:"Synced",notOkStatusText:"Failed",label:n})})},W=()=>{const t=(0,n.i6)(),[e,s]=(0,i.useState)({}),[r,p]=(0,i.useState)(!1),{maxBuckets:u=0,bucketStats:x={},maxGroups:h=0,groupStats:m={},maxUsers:f=0,userStats:g={},maxPolicies:y=0,policyStats:j={}}=e||{},k=()=>{p(!0),V.m.admin.getSiteReplicationStatus({buckets:!0,groups:!0,policies:!0,users:!0}).then((t=>{s(t.data)})).catch((t=>{s({}),b((0,c.aW)((0,I.K)(t.error)))})).finally((()=>p(!1)))};(0,i.useEffect)((()=>{k()}),[]);const b=(0,o.Ab)();return(0,i.useEffect)((()=>{b((0,c.i8)("replication_status"))}),[]),(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(w.c,{label:(0,d.jsx)(a.y_F,{label:"Site Replication",onClick:()=>t(l.Ks.SITE_REPLICATION)}),actions:(0,d.jsx)(P.c,{})}),(0,d.jsxs)(a._al,{children:[(0,d.jsx)(a.eCc,{actions:(0,d.jsx)(i.Fragment,{children:(0,d.jsx)(C.c,{tooltip:"Refresh",children:(0,d.jsx)(a.qaq,{id:"refresh",onClick:()=>{k()},label:"Refresh",icon:(0,d.jsx)(a.W5k,{}),variant:"regular",collapseOnSmall:!1})})}),separator:!0,children:"Replication status from all Sites"}),r?(0,d.jsx)(a.yeN,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:45},children:(0,d.jsx)(a.c1M,{style:{width:25,height:25}})}):(0,d.jsxs)(a.kvh,{sx:{display:"grid",marginTop:"25px",gridTemplateColumns:"1fr 1fr 1fr 1fr",["@media (max-width: ".concat(a.WQo.md,"px)")]:{gridTemplateColumns:"1fr 1fr"},["@media (max-width: ".concat(a.WQo.sm,"px)")]:{gridTemplateColumns:"1fr"},gap:"30px"},children:[(0,d.jsx)(N,{entityStatObj:x,entityTextPlural:"Buckets",maxValue:u,icon:(0,d.jsx)(a.Gme,{})}),(0,d.jsx)(N,{entityStatObj:g,entityTextPlural:"Users",maxValue:f,icon:(0,d.jsx)(a._Ms,{})}),(0,d.jsx)(N,{entityStatObj:m,entityTextPlural:"Groups",maxValue:h,icon:(0,d.jsx)(a.sXX,{})}),(0,d.jsx)(N,{entityStatObj:j,entityTextPlural:"Policies",maxValue:y,icon:(0,d.jsx)(a.u_c,{})})]}),(0,d.jsx)(a.kvh,{withBorders:!0,sx:{minHeight:450,["@media (max-width: ".concat(a.WQo.sm,"px)")]:{minHeight:250},marginTop:"25px",padding:"25px"},children:(0,d.jsx)(T,{})})]})]})}},20720:(t,e,s)=>{s.d(e,{c:()=>r});s(69060);var i=s(67659),a=s(58564),n=s.n(a),l=s(66152),o=s(82496);const c=i.cp.div((t=>{let{theme:e}=t;return{fontFamily:"Inter,sans-serif",maxWidth:"321px",display:"flex",marginLeft:"auto",marginRight:"auto",cursor:"default",color:n()(e,"signalColors.main","#07193E"),"& .mainBox":{flex:1,display:"flex",padding:"0 8px 0 8px",["@media (max-width: ".concat(l.WQo.sm,"px)")]:{padding:"0 10px 0 10px"},"& .indicatorIcon":{width:"20px",height:"20px",marginTop:"8px",maxWidth:"26px","& .min-icon":{width:"16px",height:"16px"}},"& .indicatorContainer":{flex:1,display:"flex",flexFlow:"column","& .indicatorLabel":{fontSize:"16px",fontWeight:600},"& .counterIndicator":{display:"flex",alignItems:"center",gap:"5px",justifyContent:"space-between",paddingBottom:0,fontSize:"55px",["@media (max-width: ".concat(l.WQo.sm,"px)")]:{paddingBottom:10,fontSize:"35px"},["@media (max-width: ".concat(l.WQo.lg,"px)")]:{fontSize:"45px"},["@media (max-width: ".concat(l.WQo.xl,"px)")]:{fontSize:"50px"},flexFlow:"row",fontWeight:600,"& .stat-text":{color:n()(e,"mutedText","#87888D"),fontSize:"12px",marginTop:"8px"},"& .stat-value":{textAlign:"center",height:"50px"},"& .min-icon":{marginRight:"8px",marginTop:"8px",height:"10px",width:"10px"}},"& .onlineCounter":{display:"flex",alignItems:"center",marginTop:"5px","& .min-icon":{fill:n()(e,"signalColors.good","#4CCB92")}},"& .offlineCount":{display:"flex",alignItems:"center",marginTop:"8px","& .min-icon":{fill:n()(e,"signalColors.danger","#C51B3F")}}}}}})),r=t=>{let{onlineCount:e=0,offlineCount:s=0,icon:i=null,label:a="",okStatusText:n="Online",notOkStatusText:r="Offline"}=t;return(0,o.jsx)(c,{children:(0,o.jsxs)(l.kvh,{className:"mainBox",children:[(0,o.jsxs)(l.kvh,{className:"indicatorContainer",children:[(0,o.jsx)(l.kvh,{className:"indicatorLabel",children:a}),(0,o.jsxs)(l.kvh,{className:"counterIndicator",children:[(0,o.jsxs)(l.kvh,{children:[(0,o.jsx)(l.kvh,{className:"stat-value",children:e}),(0,o.jsxs)(l.kvh,{className:"onlineCounter",children:[(0,o.jsx)(l.c2_,{}),(0,o.jsx)("div",{className:"stat-text",children:n})]})]}),(0,o.jsxs)(l.kvh,{children:[(0,o.jsx)(l.kvh,{className:"stat-value",children:s}),(0,o.jsxs)(l.kvh,{className:"offlineCount",children:[(0,o.jsx)(l.c2_,{})," ",(0,o.jsx)("div",{className:"stat-text",children:r})]})]})]})]}),(0,o.jsx)(l.kvh,{className:"indicatorIcon",children:i})]})})}}}]);
//# sourceMappingURL=3996.7bb99dbe.chunk.js.map
(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[7612],{87612:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var s=n(69060),l=n(47600),o=n(66152),i=n(19536),r=n(66156),a=n(55707),d=n(62736),c=n(95705),h=n(86116),x=n(50900),g=n(39427),p=n(58564),u=n.n(p),j=n(82496);const y="HH:mm:ss ZZZZ MM/dd/yyyy",m=e=>{const{log:t}=e,[n,l]=(0,s.useState)(!1),i=e=>u()(t,e,"");let r="",a=i("ConsoleMsg"),d=i("error.message");""!==a?r=a:""!==d&&(r=d);let c=(r||"").replace(/\u2501|\u250f|\u2513|\u2503|\u2517|\u251b/g,"");c=c.replace(/([^\x20-\x7F])/g,"");let h=(0,j.jsx)(s.Fragment,{});""!==a?h=(e=>{let t=e.ConsoleMsg;return t=t.replace(/\x1B/g," "),t=t.replace(/((\[[0-9;]+m))/g,""),(0,j.jsx)("div",{style:{display:"table",tableLayout:"fixed",width:"100%",paddingLeft:10,paddingRight:10},children:(0,j.jsx)("div",{style:{display:"table-cell",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"auto"},children:(0,j.jsx)("pre",{children:t})})})})(t):""!==d&&(h=(e=>{const t={color:"#C83B51",fontWeight:400,fontFamily:"monospace",fontSize:"12px"},n={fontFamily:"monospace",fontSize:"12px"},l=t=>u()(e,t,""),o=g.CS.fromFormat(e.time.toString(),"HH:mm:ss z MM/dd/yyyy",{zone:"UTC"});return(0,j.jsxs)(s.Fragment,{children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{style:n,children:"API:\xa0"}),(0,j.jsx)("span",{style:t,children:l("api.name")})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{style:n,children:"Time:\xa0"}),(0,j.jsx)("span",{style:t,children:o.toFormat(y)})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{style:n,children:"DeploymentID:\xa0"}),(0,j.jsx)("span",{style:t,children:l("deploymentid")})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{style:n,children:"RequestID:\xa0"}),(0,j.jsx)("span",{style:t,children:l("requestID")})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{style:n,children:"RemoteHost:\xa0"}),(0,j.jsx)("span",{style:t,children:l("remotehost")})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{style:n,children:"UserAgent:\xa0"}),(0,j.jsx)("span",{style:t,children:l("userAgent")})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{style:n,children:"Error:\xa0"}),(0,j.jsx)("span",{style:t,children:l("error.message")})]}),(0,j.jsx)("br",{}),(0,j.jsx)("div",{children:(0,j.jsx)("b",{style:n,children:"Backtrace:\xa0"})}),(e.error.source||[]).map(((e,s)=>(0,j.jsxs)("div",{children:[(0,j.jsxs)("b",{style:n,children:[s,":\xa0"]}),(0,j.jsx)("span",{style:t,children:e})]})))]})})(t)),c=(c||"").replace(/((\[[0-9;]+m))/g,"");const x=g.CS.fromFormat(t.time.toString(),"HH:mm:ss z MM/dd/yyyy",{zone:"UTC"}),p=x.toJSDate();let m=(0,j.jsx)(s.Fragment,{children:x.toFormat(y)});return 1===p.getFullYear()&&(m=(0,j.jsx)(s.Fragment,{children:"n/a"})),(0,j.jsxs)(s.Fragment,{children:[(0,j.jsxs)(o.CGA,{sx:{cursor:"pointer",borderLeft:"0",borderRight:"0"},children:[(0,j.jsx)(o.y6P,{onClick:()=>l(!n),sx:{width:280,color:"#989898",fontSize:12},children:(0,j.jsxs)(o.kvh,{sx:{display:"flex",gap:1,alignItems:"center","& .min-icon":{width:12,marginRight:1},fontWeight:"bold",lineHeight:1},children:[(0,j.jsx)(o.iaB,{}),(0,j.jsx)("div",{children:m})]})}),(0,j.jsx)(o.y6P,{onClick:()=>l(!n),sx:{width:200,color:"#989898",fontSize:12},children:(0,j.jsx)(o.kvh,{sx:{"& .min-icon":{width:12,marginRight:1},fontWeight:"bold",lineHeight:1},children:t.errKind})}),(0,j.jsx)(o.y6P,{onClick:()=>l(!n),children:(0,j.jsx)(o.kvh,{sx:{display:"table",tableLayout:"fixed",width:"100%",paddingLeft:10,paddingRight:10},children:(0,j.jsx)(o.kvh,{sx:{display:"table-cell",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:c})})}),(0,j.jsx)(o.y6P,{onClick:()=>l(!n),sx:{width:40},children:(0,j.jsx)(o.kvh,{sx:{"& .min-icon":{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"2px"},"&:hover .min-icon":{fill:"#eaeaea"}},children:n?(0,j.jsx)(o.WU2,{}):(0,j.jsx)(o.y2x,{})})})]}),n?(0,j.jsxs)(o.CGA,{children:[(0,j.jsx)(o.y6P,{sx:{paddingBottom:0,paddingTop:0,width:200,textTransform:"uppercase",verticalAlign:"top",textAlign:"right",color:"#8399AB",fontWeight:"bold"},children:(0,j.jsx)(o.kvh,{sx:{marginTop:10},children:"Log Details"})}),(0,j.jsx)(o.y6P,{sx:{paddingBottom:0,paddingTop:0},colSpan:2,children:(0,j.jsx)(o.kvh,{sx:{margin:1,padding:4,fontSize:14},withBorders:!0,useBackground:!0,children:h})}),(0,j.jsx)(o.y6P,{sx:{paddingBottom:0,paddingTop:0,width:40}})]}):null]},x.toString())};var f=n(3428),b=n(48504),v=null;const w=()=>{const e=(0,r.Ab)(),t=(0,i.w1)((e=>e.logs.logMessages)),n=(0,i.w1)((e=>e.logs.logsStarted)),[g,p]=(0,s.useState)(""),[u,y]=(0,s.useState)([""]),[w,C]=(0,s.useState)("all"),[S,k]=(0,s.useState)("Select user agent"),[A,L]=(0,s.useState)(["All User Agents"]),[T,M]=(0,s.useState)("all"),[O,_]=(0,s.useState)(!1),B=g.toLowerCase();let F=t.filter((e=>(e.userAgent===S||"All User Agents"===S||"Select user agent"===S)&&(""===g||(e.ConsoleMsg.toLowerCase().indexOf(B)>=0||(!!(e.error&&e.error.source&&e.error.source.filter((e=>e.toLowerCase().indexOf(B)>=0)).length>0)||(!!(e.error&&e.error.message.toLowerCase().indexOf(B)>=0)||!!(e.api&&e.api.name.toLowerCase().indexOf(B)>=0)))))));return(0,s.useEffect)((()=>{_(!0),x.c.invoke("GET","/api/v1/nodes").then((e=>{y(e),_(!1)})).catch((e=>{_(!1)}))}),[]),(0,s.useEffect)((()=>{e((0,c.i8)("error_logs"))}),[]),(0,j.jsxs)(s.Fragment,{children:[(0,j.jsx)(f.c,{label:"Logs",actions:(0,j.jsx)(b.c,{})}),(0,j.jsx)(o._al,{children:(0,j.jsxs)(o.yeN,{container:!0,sx:{gap:15},children:[(0,j.jsx)(o.yeN,{item:!0,xs:3,children:O?(0,j.jsx)("h3",{children:" Loading nodes"}):(0,j.jsx)(o.M1e,{id:"node-selector",name:"node","data-test-id":"node-selector",value:w,onChange:e=>{C(e)},disabled:O||n,options:[{label:"All Nodes",value:"all"},...u.map((e=>({label:e,value:e})))]})}),(0,j.jsx)(o.yeN,{item:!0,xs:3,children:(0,j.jsx)(o.M1e,{id:"logType",name:"logType","data-test-id":"log-type",value:T,onChange:e=>{M(e)},disabled:O||n,options:[{value:"all",label:"All Log Types"},{value:"minio",label:"MinIO"},{value:"application",label:"Application"}]})}),(0,j.jsx)(o.yeN,{item:!0,xs:3,children:A.length>1&&(0,j.jsx)(o.M1e,{id:"userAgent",name:"userAgent","data-test-id":"user-agent",value:S,onChange:e=>{k(e)},disabled:A.length<1||n,options:A.map((e=>({label:e,value:e})))})}),(0,j.jsxs)(o.yeN,{item:!0,xs:2,sx:{display:"flex",justifyContent:"flex-end"},children:[!n&&(0,j.jsx)(o.qaq,{id:"start-logs",type:"submit",variant:"callAction",disabled:!1,onClick:()=>{e((0,d.rt)());const t=new URL(window.location.toString()),n=t.port,s=(0,a.K_)(t.protocol),o=new URL(document.baseURI).pathname;v=new l.w3cwebsocket("".concat(s,"://").concat(t.hostname,":").concat(n).concat(o,"ws/console/?logType=").concat(T,"&node=").concat("Select node"===w?"":w));let i=null;if(null!==v)return v.onopen=()=>{console.log("WebSocket Client Connected"),e((0,d.uA)(!0)),v.send("ok"),i=setInterval((()=>{v.send("ok")}),1e4)},v.onmessage=t=>{let n=JSON.parse(t.data.toString()),s=!0;""===n.level&&""===n.errKind&&"00:00:00 UTC 01/01/0001"===n.time&&""===n.ConsoleMsg&&""===n.node&&(s=!1),n.key=Math.random(),A.indexOf(n.userAgent)<0&&void 0!==n.userAgent&&(A.push(n.userAgent),L(A)),s&&e((0,d.SE)(n))},v.onclose=()=>{clearInterval(i),console.log("connection closed by server"),e((0,d.uA)(!1))},()=>{v.close(1e3),clearInterval(i),console.log("closing websockets"),e((0,d.uA)(!1))}},label:"Start Logs"}),n&&(0,j.jsx)(o.qaq,{id:"stop-logs",type:"button",variant:"callAction",onClick:()=>{null!==v&&void 0!==v&&(v.close(1e3),e((0,d.uA)(!1)))},label:"Stop Logs"})]}),(0,j.jsx)(o.yeN,{item:!0,xs:12,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem","& button":{flexGrow:0,marginLeft:8,marginBottom:0}},children:(0,j.jsx)(h.c,{placeholder:"Filter",onChange:e=>{p(e)},value:g})}),(0,j.jsx)(o.yeN,{item:!0,xs:12,children:(0,j.jsx)(o.kvh,{id:"logs-container","data-test-id":"logs-list-container",sx:{minHeight:400,height:"calc(100vh - 200px)",overflow:"auto",fontSize:13,borderRadius:4},children:(0,j.jsxs)(o.kvh,{withBorders:!0,customBorderPadding:"0px",useBackground:!0,children:[(0,j.jsx)(o.oJK,{"aria-label":"collapsible table",children:(0,j.jsx)(o.qqV,{children:F.map((e=>(0,j.jsx)(m,{log:e})))})}),0===F.length&&(0,j.jsx)(o.kvh,{sx:{padding:20,textAlign:"center"},children:"No logs to display"})]})})})]})})]})}},7504:e=>{var t=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},47600:(e,t,n)=>{var s;if("object"===typeof globalThis)s=globalThis;else try{s=n(7504)}catch(r){}finally{if(s||"undefined"===typeof window||(s=window),!s)throw new Error("Could not determine global this")}var l=s.WebSocket||s.MozWebSocket,o=n(3068);function i(e,t){return t?new l(e,t):new l(e)}l&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(i,e,{get:function(){return l[e]}})})),e.exports={w3cwebsocket:l?i:null,version:o}},3068:(e,t,n)=>{e.exports=n(40648).version},40648:e=>{"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=7612.e8288419.chunk.js.map